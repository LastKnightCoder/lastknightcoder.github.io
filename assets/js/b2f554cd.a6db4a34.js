"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[1477],{10:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"mobile-text-middle","metadata":{"permalink":"/blog/mobile-text-middle","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2022-10-17-\u79fb\u52a8\u7aef\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u65b9\u6848.mdx","source":"@site/blog/2022-10-17-\u79fb\u52a8\u7aef\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u65b9\u6848.mdx","title":"\u79fb\u52a8\u7aef\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u65b9\u6848","description":"\u6709\u8fc7\u79fb\u52a8\u7aef\u5f00\u53d1\u7ecf\u9a8c\u7684\u4eba\uff0c\u60f3\u5fc5\u90fd\u5bf9\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u5934\u75db\u4e0d\u5df2\uff0c\u56e0\u4e3a\u4f7f\u7528\u5e38\u89c4\u624b\u6bb5\u5b9e\u73b0\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u5728\u90e8\u5206 Android \u624b\u673a\u4e0a\u4f1a\u51fa\u73b0\u6587\u5b57\u504f\u4e0a\u7684\u60c5\u51b5\uff0c\u5f80\u5f80\u9700\u8981\u914d\u5408 line-height \u6216\u8005 padding \u8fdb\u884c\u5fae\u8c03\uff0c\u82e6\u4e0d\u582a\u8a00\u3002\u4e0b\u9762\u662f\u6211\u5c1d\u8bd5\u7684\u51e0\u79cd\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u65b9\u6848\uff1a","date":"2022-10-17T00:00:00.000Z","formattedDate":"2022\u5e7410\u670817\u65e5","tags":[{"label":"SVG","permalink":"/blog/tags/svg"},{"label":"Canvas","permalink":"/blog/tags/canvas"},{"label":"\u6587\u5b57\u5782\u76f4\u5c45\u4e2d","permalink":"/blog/tags/\u6587\u5b57\u5782\u76f4\u5c45\u4e2d"}],"readingTime":14.085,"hasTruncateMarker":true,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"mobile-text-middle","tags":["SVG","Canvas","\u6587\u5b57\u5782\u76f4\u5c45\u4e2d"],"authors":"xiongtao"},"nextItem":{"title":"MutationObserver","permalink":"/blog/MutationObserver"}},"content":"import Tabs from \'@theme/Tabs\';\\nimport TabItem from \'@theme/TabItem\';\\n\\n\u6709\u8fc7\u79fb\u52a8\u7aef\u5f00\u53d1\u7ecf\u9a8c\u7684\u4eba\uff0c\u60f3\u5fc5\u90fd\u5bf9\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u5934\u75db\u4e0d\u5df2\uff0c\u56e0\u4e3a\u4f7f\u7528\u5e38\u89c4\u624b\u6bb5\u5b9e\u73b0\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u5728\u90e8\u5206 Android \u624b\u673a\u4e0a\u4f1a\u51fa\u73b0\u6587\u5b57\u504f\u4e0a\u7684\u60c5\u51b5\uff0c\u5f80\u5f80\u9700\u8981\u914d\u5408 `line-height` \u6216\u8005 `padding` \u8fdb\u884c\u5fae\u8c03\uff0c\u82e6\u4e0d\u582a\u8a00\u3002\u4e0b\u9762\u662f\u6211\u5c1d\u8bd5\u7684\u51e0\u79cd\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u65b9\u6848\uff1a\\n\\n`line-height` \u5b9e\u73b0\u5782\u76f4\u5c45\u4e2d:\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\'>\\n\\n```html\\n<div id=\\"line-height\\">\u67e5\u770b\u66f4\u591a</div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\' default>\\n\\n```css\\n#line-height {\\n  width: 200px;\\n  text-align: center;\\n  \\n  height: 56px;\\n  line-height: 56px;\\n  \\n  font-size: 26px;\\n  color: black;  \\n  \\n  border: 1px solid;\\n  border-radius: 28px;\\n}\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n\x3c!--truncate--\x3e\\n\\n`display: flex` \u5b9e\u73b0\u5782\u76f4\u5c45\u4e2d\uff1a\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\'>\\n\\n```html\\n<div id=\\"flex\\">\u67e5\u770b\u66f4\u591a</div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\' default>\\n\\n```css\\n#flex {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  width: 200px;\\n  height: 56px;\\n  font-size: 26px;\\n  color: black;\\n  border: 1px solid;\\n  border-radius: 28px;\\n}\\n```\\n\\n</TabItem>\\n</Tabs>\\n\\n`padding` \u5b9e\u73b0\u5782\u76f4\u5c45\u4e2d\uff1a\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\'>\\n\\n```html\\n<div id=\\"padding\\">\u67e5\u770b\u66f4\u591a</div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\' default>\\n\\n```css\\n#padding {\\n  width: 200px;\\n  text-align: center;\\n  box-sizing: border-box;\\n  height: 56px;\\n  font-size: 26px;\\n  line-height: 1;\\n  padding: 15px 0;\\n  color: black;\\n  border: 1px solid;\\n  border-radius: 28px;\\n}\\n```\\n\\n</TabItem>\\n</Tabs>\\n\\nCanvas \u5b9e\u73b0\u5782\u76f4\u5c45\u4e2d\uff1a \\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\'>\\n\\n```html\\n<div id=\\"canvas-container\\">\\n  <canvas id=\\"canvas\\" width=\\"200\\" height=\\"56\\"></canvas>\\n</div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\'>\\n\\n```css\\n#canvas-container {\\n  width: 200px;\\n  height: 56px;\\n  color: black;\\n  border: 1px solid;\\n  border-radius: 28px;\\n}\\n#canvas {\\n  width: 200px;\\n  height: 56px;\\n}\\n```\\n\\n</TabItem>\\n<TabItem value=\'js\' label=\'JavaScript\' default>\\n\\n```js\\nconst canvas = document.querySelector(\'#canvas\');\\nconst ctx = canvas.getContext(\'2d\');\\n\\n// \u89e3\u51b3\u9ad8\u6e05\u5c4f\u6a21\u7cca\u7684\u95ee\u9898\\nconst computedStyle = window.getComputedStyle(canvas);\\nconst dpr = window.devicePixelRatio;\\ncanvas.width = parseFloat(computedStyle.width) * dpr;\\ncanvas.height = parseFloat(computedStyle.height) * dpr;\\nctx.scale(dpr, dpr);\\n\\nconst text = \'\u67e5\u770b\u66f4\u591a\';\\nconst fontSize = 26;\\nctx.font = `${fontSize}px normal`;\\nconst textWidth = ctx.measureText(text).width;\\nctx.textBaseline = \'bottom\'\\n// \u8fd9\u91cc\u7684 1.15 \u662f\u56e0\u4e3a\u5e95\u7ebf\u5176\u5b9e\u662f\u8d85\u51fa\u4e86\u884c\u6846\u76d2\u5b50\u7684\uff0c\u8d85\u51fa\u5b57\u4f53\u5927\u5c0f\u7684 5%-10%\uff0c\u89c1\u9644\u5f55\\nctx.fillText(text, (canvas.width / dpr - textWidth) / 2, (canvas.height / dpr + 1.15 * fontSize) / 2);\\n```\\n\\n</TabItem>\\n</Tabs>\\n\\nSVG \u5b9e\u73b0\u5782\u76f4\u5c45\u4e2d\uff1a\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"svg-container\\">\\n  <svg width=\\"200\\" height=\\"56\\" viewBox=\\"0 0 200 56\\">\\n    <text\\n      text-anchor=\\"middle\\"\\n      fill=\\"currentColor\\"\\n      x=\\"100\\"\\n      dominant-baseline=\\"central\\"\\n      y=\\"28\\"\\n      font-size=\\"26\\"\\n    >\\n      \u67e5\u770b\u66f4\u591a\\n    </text>\\n  </svg>\\n</div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\'>\\n\\n```css\\n#svg-container {\\n  width: 200px;\\n  height: 56px;\\n  color: black;\\n  border: 1px solid;\\n  border-radius: 28px;\\n}\\n```\\n\\n</TabItem>\\n</Tabs>\\n\\n\u901a\u8fc7\u5728\u4e0d\u540c\u673a\u578b\u4e0a\u7684\u5bf9\u6bd4\uff0c\u53d1\u73b0 Canvas \u548c SVG \u7684\u65b9\u6848\u5728\u5404\u4e2a\u673a\u578b\u4e0b\u9762\u5747\u4fdd\u6301\u4e00\u81f4\u7684\u5c45\u4e2d\u6548\u679c\uff0c\u56e0\u6b64\u51b3\u5b9a\u5c06\u5176\u62bd\u79bb\u4e3a\u4e00\u4e2a React \u7ec4\u4ef6\uff0c\u4e0b\u9762\u5c31\u8be6\u7ec6\u8bb2\u89e3\u8be5\u7ec4\u4ef6\u7684\u5f00\u53d1\u601d\u8def\u3002\\n\\n\u672c\u6587\u4ee5 SVG \u4e3a\u4f8b\uff0cCanvas \u5f00\u53d1\u601d\u8def\u662f\u4e00\u6837\u7684\uff0c\u5728\u6587\u7ae0\u7684\u6700\u540e\u7ed9\u51fa Canvas \u7684\u5b9e\u73b0\uff0c\u4f9b\u4ee5\u53c2\u8003\u3002\\n\\n## \u4f7f\u7528\u65b9\u6cd5\\n\\n\u4e3a\u5b9e\u73b0\u5782\u76f4\u5c45\u4e2d\u529f\u80fd\uff0c\u7ec4\u4ef6\u9700\u8981\u56db\u4e2a\u53c2\u6570\\n\\n- `height`\uff1a\u5bb9\u5668\u9ad8\u5ea6\uff0c\u5355\u4f4d\u4e3a `px`\\n- `fontSize`\uff1a\u5b57\u4f53\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3a `px`\\n- `text`\uff1a\u6587\u5b57\u5185\u5bb9\\n- `color`\uff1a\u6587\u5b57\u989c\u8272\\n\\n\u8fd9\u56db\u4e2a\u53c2\u6570\u662f\u5fc5\u987b\u4f20\u9012\u7684\uff0c\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a\\n\\n```jsx\\n// \u4f7f\u7528\u65b9\u5f0f\u4e00\\n<TextMiddle fontSize={28} height={60} color={\'deepskyblue\'} text={\'\u67e5\u770b\u66f4\u591a\'} />\\n```\\n\\n\u9664\u4e86\u4e0a\u9762\u56db\u4e2a\u5c5e\u6027\uff0c\u8fd8\u652f\u6301\u4f20\u9012 `className` \u4e0e `style`\u3002\\n\\n## SVG \u5782\u76f4\u5c45\u4e2d\u539f\u7406\\n\\n\u5728 SVG \u4e2d\u901a\u8fc7 `text` \u6807\u7b7e\u6765\u663e\u793a\u6587\u5b57\uff0c\u53ef\u4ee5\u901a\u8fc7 `x` \u548c `y` \u5c5e\u6027\u6765\u8bbe\u7f6e\u6587\u5b57\u7684\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u6211\u4eec\u5173\u6ce8\u5230 `y`\uff0c\u5b83\u8bbe\u7f6e\u7684\u662f\u6587\u5b57\u57fa\u7ebf\u5728 SVG \u753b\u5e03\u4e2d\u7684\u4f4d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7  `dominant-baseline` \u6765\u6307\u5b9a\u57fa\u7ebf\u5728\u6587\u5b57\u7684\u54ea\u4e2a\u4f4d\u7f6e\uff0c\u6211\u4eec\u5c06\u5176\u8bbe\u7f6e\u4e3a `central`\uff0c\u8868\u793a\u57fa\u7ebf\u5728\u6587\u5b57\u7684\u4e2d\u95f4\uff0c\u7136\u540e\u5c06 `y` \u8bbe\u7f6e\u4e3a\u9ad8\u5ea6\u7684\u4e00\u534a\uff0c\u5373\u53ef\u5b9e\u73b0\u6587\u5b57\u7684\u5782\u76f4\u5c45\u4e2d\u3002\\n\\n```html\\n<svg width=\\"200\\" height=\\"60\\" viewBox=\\"0 0 200 60\\">\\n  <text\\n    font-size=\\"26\\"\\n    fill=\\"currentColor\\"\\n    dominant-baseline=\\"central\\" y=\\"30\\">\\n    \u67e5\u770b\u66f4\u591a\\n  </text>\\n</svg>\\n```\\n\\n\\n\\n:::note\\n\\n\u4e0a\u9762\u4f7f\u7528\u7684\u5355\u4f4d\u5747\u4e3a `px`\u3002\\n\\n::: \\n\\n\u6839\u636e\u4e0a\u9762\u7684\u539f\u7406\uff0c\u53ef\u4ee5\u5199\u51fa\u7b2c\u4e00\u7248\u7684 `TextMiddle` \u5b9e\u73b0\\n\\n```jsx\\nimport React, { useEffect, useRef } from \\"react\\";\\n\\nconst TextMiddle = props => {\\n  const { height, fontSize, color, text, className = \'\', style = {} } = props;\\n  const container = useRef();\\n\\n  const actualStyle = {\\n    ...style,\\n    height: `${height / 100}rem`,\\n    fontSize: `${fontSize / 100}rem`,\\n    color\\n  };\\n\\n  useEffect(() => {\\n    const computedStyle = window.getComputedStyle(container.current);\\n    const actualHeight = parseFloat(computedStyle.height);\\n    const actualFontSize = parseFloat(computedStyle.fontSize);\\n    const actualWidth = parseFloat(computedStyle.width);\\n\\n    const svg = `\\n      <svg width=\\"${actualWidth}\\" height=\\"${actualHeight}\\" viewBox=\\"0 0 ${actualWidth} ${actualHeight}\\">\\n        <text\\n          font-size=\\"${actualFontSize}\\"\\n          fill=\\"currentColor\\"\\n          dominant-baseline=\\"central\\" y=\\"${actualHeight / 2}\\"\\n        >\\n          ${text}\\n        </text>\\n      </svg>\\n    `;\\n    container.current.innerHTML = svg;\\n  }, [text]);\\n\\n  return (\\n    <div ref={container} className={className} style={actualStyle}>\\n      {text}\\n    </div>\\n  )\\n}\\n\\nexport default TextMiddle;\\n```\\n\\n## \u6587\u5b57\u8d85\u51fa\\n\\n\u4e8b\u60c5\u5230\u8fd9\u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u6211\u4eec\u4f7f\u7528 `SVG` \u8fd9\u79cd\u65b9\u6848\u662f\u6709\u7f3a\u70b9\u7684\uff0c\u90a3\u5c31\u662f\u7f3a\u5931\u4e86\u6d41\u52a8\u6027\uff0c\u6587\u5b57\u53ea\u80fd\u4e00\u884c\u5c55\u793a\uff0c\u4e0d\u4f1a\u6362\u884c\uff0c\u591a\u4f59\u7684\u6587\u5b57\u4f1a\u88ab\u9690\u85cf\u4e0d\u53ef\u89c1\u3002\\n\\n\u8003\u8651\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u4e00\u822c\u90fd\u662f\u5355\u884c\u6587\u672c\u5b9e\u73b0\u5782\u76f4\u5c45\u4e2d\uff0c\u6240\u4ee5\u5c31\u4e0d\u5bf9\u6362\u884c\u8fdb\u884c\u5904\u7406\uff0c\u4f46\u662f\u6587\u5b57\u8d85\u51fa\u8fd8\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\uff0c\u6240\u4ee5\u6709\u5fc5\u8981\u5bf9\u6587\u5b57\u8d85\u51fa\u8fdb\u884c\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u91cc\u5bf9\u8d85\u51fa\u7684\u6587\u5b57\u4f7f\u7528 `...` \u4ee3\u66ff\u3002\\n\\n\u600e\u4e48\u5224\u65ad\u6587\u5b57\u662f\u5426\u8d85\u51fa\u4e86\u5462\uff1f\u6211\u4eec\u9700\u8981\u77e5\u9053\u6587\u5b57\u7684\u957f\u5ea6\uff0c\u5982\u679c\u6587\u5b57\u7684\u957f\u5ea6\u5927\u4e8e\u5bb9\u5668\u7684\u957f\u5ea6\uff0c\u5c31\u8bf4\u660e\u8d85\u51fa\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u9700\u8981\u8fdb\u884c\u6253\u70b9\u3002\u53ef\u4ee5\u901a\u8fc7 `Canvas` \u7684 `measureText` \u6765\u83b7\u5f97\u6587\u672c\u7684\u5bbd\u5ea6\\n\\n```js\\nconst canvas = document.createElement(\'canvas\');\\nconst ctx = canvas.getContext(\'2d\');\\nconst getTextLength = (text, fontSize) => {\\n  ctx.font= `${fontSize}px normal`;\\n  const metrics = ctx.measureText(text);\\n  return parseInt(\'\' + metrics.width);\\n}\\n```\\n\\n\u8fd9\u91cc\u5bf9\u6587\u5b57\u7684\u957f\u5ea6\u8fdb\u884c\u4e86\u53d6\u6574\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u5c0f\u6570\u90e8\u5206\u5b58\u5728\u8bef\u5dee\uff0c\u56e0\u6b64\u6211\u4eec\u4e5f\u9700\u8981\u5bf9\u5bb9\u5668\u7684\u957f\u5ea6\u8fdb\u884c\u53d6\u6574\uff0c\u7531\u4e8e\u53d6\u6574\u4e4b\u540e\uff0c\u53ef\u80fd\u5b58\u5728 `1px` \u7684\u8bef\u5dee\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u8bbe\u7f6e\u5bb9\u5668\u7684\u5bbd\u5ea6\u4e3a\u53d6\u6574\u540e `+1`\\n\\n```js\\nconst actualWidth = parseInt(computedStyle.width) + 1;\\nconst textLength = getTextLength(text, actualFontSize);\\nif (textLength > actualWidth) {\\n\\t// \u6587\u5b57\u8d85\u51fa\u5904\u7406\\n}\\n```\\n\\n\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u8d85\u51fa\u7684\u6587\u5b57\u5206\u754c\u70b9\uff0c\u7136\u540e\u8fdb\u884c\u622a\u65ad\\n\\n```js\\nconst actualWidth = parseInt(computedStyle.width) + 1;\\nconst textLength = getTextLength(text, actualFontSize);\\nlet actualText = text;\\n// \u8ba1\u7b97\u622a\u65ad\u70b9\u4ee5\u53ca\u5b9e\u9645\u6587\u672c\\nif (textLength > actualWidth) {\\n  actualText = text.slice(0, 1) + \'...\';\\n  for (let i = 1; i < text.length; i++) {\\n    const adjustText = text.slice(0, i) + \'...\';\\n    const adjustWidth = getTextLength(adjustText, actualFontSize);\\n    if (adjustWidth > actualWidth) {\\n      break;\\n    }\\n    actualText = adjustText;\\n  }\\n}\\nconst svg = `\\n  <svg width=\\"${actualWidth}\\" height=\\"${actualHeight}\\" viewBox=\\"0 0 ${actualWidth} ${actualHeight}\\">\\n    <text\\n      font-size=\\"${actualFontSize}\\"\\n      fill=\\"currentColor\\"\\n      dominant-baseline=\\"central\\" y=\\"${actualHeight / 2}\\"\\n    >\\n      ${actualText}\\n    </text>\\n  </svg>\\n`;\\ncontainer.current.innerHTML = svg;\\n```\\n\\n## \u6027\u80fd\u4f18\u5316\\n\\n\u5f53\u9875\u9762\u4e0a\u6709\u592a\u591a\u7684 SVG \u8981\u6e32\u67d3\u65f6\uff0c\u4f1a\u6709\u8f83\u5927\u7684\u767d\u5c4f\u65f6\u95f4\uff0c\u7ecf\u6d4b\u8bd5\uff0c\u540c\u65f6\u6709 1000 \u4e2a SVG \u6e32\u67d3\uff0c\u5c06\u4f1a\u6709\u63a5\u8fd1 1s \u7684\u767d\u5c4f\u65f6\u95f4\uff0c\u8fd9\u4e2a\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 `IntersectionObserver` \u6765\u8fdb\u884c\u4e00\u4e2a\u6027\u80fd\u4f18\u5316\uff0c\u53ea\u6709\u5f53\u8be5\u7ec4\u4ef6\u5373\u5c06\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u65f6\uff0c\u6211\u4eec\u624d\u6e32\u67d3\u4e3a SVG\u3002\\n\\n```js\\nconst svg = `\\n  <svg width=\\"${actualWidth}\\" height=\\"${actualHeight}\\" viewBox=\\"0 0 ${actualWidth} ${actualHeight}\\">\\n    <text\\n      font-size=\\"${actualFontSize}\\"\\n      fill=\\"currentColor\\"\\n      dominant-baseline=\\"central\\" y=\\"${actualHeight / 2}\\"\\n    >\\n      ${actualText}\\n    </text>\\n  </svg>\\n`;\\nconst observer = new IntersectionObserver(entries => {\\n  entries.forEach(entry => {\\n    // \u8fdb\u5165\u89c6\u53e3\u65f6\u6216\u5df2\u7ecf\u5728\u89c6\u53e3\u4e2d\\n    if (entry.isIntersecting) {\\n      container.current.innerHTML = svg;\\n      // \u53d6\u6d88\u76d1\u542c\\n      observer.unobserve(container.current);\\n    }\\n  })\\n}, {\\n  // \u89c6\u53e3\u8303\u56f4\u5411\u4e0b\u6269\u5927 500px\uff0c\u63d0\u524d\u52a0\u8f7d\\n  rootMargin: \'0px 0px 500px 0px\'\\n});\\nobserver.observe(container.current);\\n```\\n\\n\u53e6\u4e00\u4e2a\u5c31\u662f\u5bf9\u4e8e\u82f9\u679c\u624b\u673a\uff0c\u6211\u4eec\u6ca1\u6709\u5fc5\u8981\u4f7f\u7528 SVG \u7684\u65b9\u6848\uff0c\u56e0\u4e3a\u82f9\u679c\u624b\u673a\u7684\u517c\u5bb9\u6027\u5f88\u597d\uff0c\u5bf9\u4e8e\u82f9\u679c\u624b\u673a\u5c31\u4f7f\u7528\u8bbe\u7f6e\u884c\u9ad8\u7b49\u4e8e\u9ad8\u5ea6\u7684\u65b9\u6848\\n\\n```js\\nconst isIos = /ipad|iphone|macintosh/gim.test(window.navigator.userAgent);\\nconst actualStyle = {\\n  overflow: \'hidden\',\\n  whiteSpace: \'nowrap\',\\n  textOverflow: \'ellipsis\',\\n  ...style,\\n  height: `${height / 100}rem`,\\n  lineHeight: `${height / 100}rem`,\\n  fontSize: `${fontSize / 100}rem`,\\n  color\\n};\\n\\nuseEffect(() => {\\n\\tif (isIos) {\\n\\t  return;\\n\\t}\\n\\t// ... \u5176\u5b83\u903b\u8f91\\n}, []);\\n```\\n\\n:::warning\\n\u4e0d\u8981\u4e3a `TextMiddle` \u6dfb\u52a0 `display: flex;`\uff0c\u5426\u5219 `text-overflow` \u4f1a\u5931\u6548\uff0c\u9664\u975e\u4f60\u786e\u5b9a\u4f60\u7684\u6587\u672c\u4e00\u5b9a\u4e0d\u4f1a\u8d85\u51fa\u5bb9\u5668\u7684\u5bbd\u5ea6\u3002\\n:::\\n\\n## \u6700\u7ec8\u4ee3\u7801\\n\\n### SVG\\n\\n```jsx\\nimport React, { useEffect, useRef } from \\"react\\";\\n\\nconst canvas = document.createElement(\'canvas\');\\nconst ctx = canvas.getContext(\'2d\');\\nconst getTextLength = (text, fontSize) => {\\n  ctx.font= `${fontSize}px normal`;\\n  const metrics = ctx.measureText(text);\\n  return parseInt(\'\' + metrics.width);\\n}\\n\\nconst TextMiddle = props => {\\n  const { height, fontSize, color, text, className = \'\', style = {} } = props;\\n  const container = useRef();\\n  const isIos = /ipad|iphone|macintosh/gim.test(window.navigator.userAgent);\\n  const actualStyle = {\\n    overflow: \'hidden\',\\n    whiteSpace: \'nowrap\',\\n    textOverflow: \'ellipsis\',\\n    ...style,\\n    height: `${height / 100}rem`,\\n    lineHeight: `${height / 100}rem`,\\n    fontSize: `${fontSize / 100}rem`,\\n    color\\n  };\\n\\n  useEffect(() => {\\n    if (isIos) {\\n      return;\\n    }\\n    const computedStyle = window.getComputedStyle(container.current);\\n    const actualHeight = parseFloat(computedStyle.height);\\n    const actualFontSize = parseFloat(computedStyle.fontSize);\\n    const actualWidth = parseInt(computedStyle.width) + 1;\\n    const textLength = getTextLength(text, actualFontSize);\\n    let actualText = text;\\n    if (textLength > actualWidth) {\\n      actualText = text.slice(0, 1) + \'...\';\\n      for (let i = 1; i < text.length; i++) {\\n        const adjustText = text.slice(0, i) + \'...\';\\n        const adjustWidth = getTextLength(adjustText, actualFontSize);\\n        if (adjustWidth > actualWidth) {\\n          break;\\n        }\\n        actualText = adjustText;\\n      }\\n    }\\n\\n    const svg = `\\n      <svg width=\\"${actualWidth}\\" height=\\"${actualHeight}\\" viewBox=\\"0 0 ${actualWidth} ${actualHeight}\\">\\n        <text\\n          font-size=\\"${actualFontSize}\\"\\n          fill=\\"currentColor\\"\\n          dominant-baseline=\\"central\\" y=\\"${actualHeight / 2}\\"\\n        >\\n          ${actualText}\\n        </text>\\n      </svg>\\n    `;\\n    const observer = new IntersectionObserver(entries => {\\n      entries.forEach(entry => {\\n        // \u8fdb\u5165\u89c6\u53e3\u65f6\u6216\u5df2\u7ecf\u5728\u89c6\u53e3\u4e2d\\n        if (entry.isIntersecting) {\\n          container.current.innerHTML = svg;\\n          observer.unobserve(container.current);\\n        }\\n      })\\n    }, {\\n      // \u89c6\u53e3\u8303\u56f4\u5411\u4e0b\u6269\u5927 500px\uff0c\u63d0\u524d\u52a0\u8f7d\\n      rootMargin: \'0px 0px 500px 0px\'\\n    });\\n    observer.observe(container.current);\\n  }, [text]);\\n\\n  return (\\n    <div ref={container} className={className} style={actualStyle}>\\n      {text}\\n    </div>\\n  )\\n}\\n\\nexport default TextMiddle;\\n```\\n\\n### Canvas\\n\\n```jsx\\nimport React, { useEffect, useRef } from \\"react\\";\\n\\nconst isIos = /ipad|iphone|macintosh/gim.test(window.navigator.userAgent);\\n\\nconst canvas = document.createElement(\'canvas\');\\nconst ctx = canvas.getContext(\'2d\');\\nconst getTextLength = (text, fontSize) => {\\n  ctx.font= `${fontSize}px normal`;\\n  const metrics = ctx.measureText(text);\\n  return parseInt(\'\' + metrics.width);\\n}\\n\\nconst TextMiddle = props => {\\n  const { text, color, height, fontSize, className = \'\', style = {} } = props;\\n  const container = useRef();\\n\\n  const actualStyle = {\\n    overflow: \'hidden\',\\n    whiteSpace: \'nowrap\',\\n    textOverflow: \'ellipsis\',\\n    ...style,\\n    height: `${height / 100}rem`,\\n    lineHeight: `${height / 100}rem`,\\n    fontSize: `${fontSize / 100}rem`,\\n    color\\n  };\\n\\n  useEffect(() => {\\n    if (isIos) {\\n      return;\\n    }\\n\\n    const computedStyle = window.getComputedStyle(container.current);\\n    const actualHeight = parseFloat(computedStyle.height);\\n    const actualFontSize = parseFloat(computedStyle.fontSize);\\n    const actualWidth = parseInt(computedStyle.width) + 1;\\n    \\n    // \u9ad8\u5206\u5c4f\u6a21\u7cca\u5904\u7406\\n    const canvas = document.createElement(\'canvas\');\\n    const ctx = canvas.getContext(\'2d\');\\n    canvas.style.width = actualWidth + \'px\';\\n    canvas.style.height = actualHeight + \'px\';\\n    const dpr = window.devicePixelRatio;\\n    canvas.width = actualWidth * dpr;\\n    canvas.height = actualHeight * dpr;\\n    ctx.scale(dpr, dpr);\\n\\n    // \u6587\u5b57\u8d85\u51fa\u5904\u7406\\n    const textLength = getTextLength(text, actualFontSize);\\n    let actualText = text;\\n    if (textLength > actualWidth) {\\n      actualText = text.slice(0, 1) + \'...\';\\n      for (let i = 1; i < text.length; i++) {\\n        const adjustText = text.slice(0, i) + \'...\';\\n        const adjustWidth = getTextLength(adjustText, actualFontSize);\\n        if (adjustWidth > actualWidth) {\\n          break;\\n        }\\n        actualText = adjustText;\\n      }\\n    }\\n\\n    ctx.font = `${actualFontSize}px normal`;\\n    ctx.fillStyle = color;\\n    ctx.textBaseline = \'bottom\';\\n    // \u5e95\u7ebf\u5176\u5b9e\u662f\u8d85\u51fa\u884c\u6846\u76d2\u5b50\u7684\uff0c\u53c2\u8003\u5b57\u6bcd y g \u7684\u4e0b\u8fb9\u7f18\uff0c\u8d85\u51fa\u7684\u90e8\u5206\u662f\u5b57\u4f53\u5927\u5c0f\u7684 10%\\n    ctx.fillText(actualText, 0, (canvas.height / dpr + 1.15 * actualFontSize) / 2);\\n\\n    const observer = new IntersectionObserver(entries => {\\n      entries.forEach(entry => {\\n        if (entry.isIntersecting) {\\n          container.current.removeChild(container.current.firstChild);\\n          container.current.append(canvas);\\n          observer.unobserve(container.current);\\n        }\\n      });\\n    }, {\\n      rootMargin: \'0px 0px 500px 0px\'\\n    });\\n    observer.observe(container.current);\\n  }, [text, color]);\\n\\n  return (\\n    <div ref={container} className={className} style={actualStyle}>\\n      {text}\\n    </div>\\n  )\\n}\\n\\nexport default TextMiddle;\\n```\\n\\n\\n## \u9644\u5f55\\n\\n\u8fd9\u4e2a\u6765\u8865\u5145 `Canvas` \u7ed8\u5236\u6587\u5b57\u7684\u4e00\u4e2a\u7ec6\u8282\uff0c\u5728\u4ee3\u7801\u91cc\u9762\u6211\u4eec\u7ed8\u5236\u6587\u5b57\u7528\u4e86\u4e0b\u9762\u7684\u4ee3\u7801\\n\\n```js\\nctx.textBaseline = \'bottom\';\\nctx.fillText(actualText, 0, (canvas.height / dpr + 1.2 * actualFontSize) / 2);\\n```\\n\\n\u5173\u4e8e\u6587\u5b57\u7684\u4f4d\u7f6e\u8fd9\u91cc\u7ed9\u4e86 `canvas.height / dpr + 1.2 * actualFontSize) / 2`\uff0c\u6309\u9053\u7406\u5e94\u8be5\u7ed9 `canvas.height / dpr + actualFontSize) / 2`\uff0c\u6240\u4ee5\u6211\u4eec\u4e3a\u4ec0\u4e48\u8981\u4e58 `1.2`\u3002\\n\\n\u6211\u4eec\u5148\u770b\u4e0b\u8fd9\u4e2a\u516c\u5f0f\u662f\u600e\u4e48\u8ba1\u7b97\u7684\uff0c\u5047\u8bbe\u5bb9\u5668\u7684\u9ad8\u5ea6\u662f `h`\uff0c\u5b57\u4f53\u7684\u5927\u5c0f\u662f `s`\uff0c\u8981\u4f7f\u5f97\u5b57\u4f53\u5782\u76f4\u5c45\u4e2d\uff0c\u90a3\u4e48\u5b57\u4f53\u5e95\u90e8\u79bb\u9876\u90e8\u7684\u8ddd\u79bb\u5c31\u662f `(h - s) / 2 + s = (h + s) / 2`\u3002\u73b0\u5728\u6211\u4eec\u7684\u8ba1\u7b97\u516c\u5f0f\u662f `(h + 1.2 * s) / 2`\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\uff1f\\n\\n\u8fd9\u662f\u56e0\u4e3a\u5e95\u7ebf\u7684\u8ddd\u79bb\u5e76\u4e0d\u662f\u6587\u5b57\u6240\u5728\u76d2\u5b50\u7684\u5e95\u90e8\uff0c\u770b\u4e00\u4e2a\u4f8b\u5b50\\n\\n```html\\n<div id=\\"container\\">\u67e5\u770b\u66f4\u591ay</div>\\n```\\n\\n```css\\n#container {\\n  font-size: 100px;\\n  outline: 1px solid red;\\n  line-height: 1;\\n}\\n```\\n\\n<img src=\\"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/image.7f1js39a5200.webp\\" style={{ zoom: \'50%\' }} />\\n\\n\u53ef\u4ee5\u770b\u5230\u5e95\u7ebf\uff08\u4e5f\u5c31\u662f\u5b57\u6bcd `y` \u7684\u5e95\u90e8\uff09\u8d85\u51fa\u4e86\u884c\u6846\u76d2\u5b50\uff0c\u6240\u4ee5\u5c06\u5e95\u7ebf\u8bbe\u7f6e\u5230 `(h + s) / 2`\uff0c\u4f1a\u4f7f\u5f97\u6587\u5b57\u504f\u4e0a\u3002\u8981\u4f7f\u5f97\u6587\u5b57\u6b63\u5e38\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u8d85\u51fa\u4e86\u591a\u5c11\uff0c\u8fd9\u4e2a\u5927\u5c0f\u4e0e\u5b57\u4f53\u5927\u5c0f\u6210\u4e00\u4e2a\u6bd4\u4f8b\u5173\u7cfb\uff0c\u4e0d\u59a8\u8bbe\u4e3a `y`\uff0c\u5219\u8d85\u51fa\u7684\u5927\u5c0f\u4e3a `ys`\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ea\u8981\u5728\u5411\u4e0b\u79fb\u52a8 `ys` \u5c31\u53ef\u4ee5\u4e86 `(h + s) / 2 + ys = (h + (1 + 2y)s) / 2`\u3002\\n\\n\u5bf9\u4e8e\u4e0d\u540c\u7684\u5b57\u4f53\uff0c`y` \u4e0d\u4e00\u6837\uff0c\u8303\u56f4\u5728 `5%~10%` \u4e4b\u95f4\uff0c\u8fd9\u91cc\u6211\u53d6\u4e86 `7.5%`\uff0c\u6240\u4ee5\u503c\u5c31\u662f `(h + 1.15s) / 2`\u3002\\n\\n\u6240\u4ee5\u5bf9\u4e8e\u4e0d\u540c\u7684\u5b57\u4f53\u5b9e\u73b0\u7684\u662f\u4e00\u4e2a\u4f2a\u5c45\u4e2d\uff0c\u6700\u5927\u7684\u8bef\u5dee\u5728 `2.5%`\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u5b57\u4f53\u5927\u5c0f\u5728 `40px` \u4ee5\u5185\u7684\u6587\u672c\uff0c\u8bef\u5dee\u5c0f\u4e8e `1px`\uff08\u5bf9\u4e8e\u79fb\u52a8\u7aef\u7684\u6587\u672c\u6765\u8bf4\uff0c\u6587\u5b57\u5927\u5c0f\u4e00\u822c\u5c11\u6709\u8d85\u8fc7 `15px` \u7684\uff09\u3002\u5b9e\u73b0\u4e86\u89c6\u89c9\u4e0a\u7684\u201c\u5c45\u4e2d\u201d\uff0c\u6700\u91cd\u8981\u7684\u662f\uff0c\u5728\u5404\u4e2a\u673a\u578b\u4e0a\u5747\u80fd\u4fdd\u6301\u4e00\u81f4\u6027\u3002"},{"id":"MutationObserver","metadata":{"permalink":"/blog/MutationObserver","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2022-10-11-MutationObserver.mdx","source":"@site/blog/2022-10-11-MutationObserver.mdx","title":"MutationObserver","description":"\u5728\u590d\u6742\u7684\u7f51\u9875\u5e94\u7528\u4e2d\uff0cDOM \u7ed3\u6784\u4f1a\u9891\u7e41\u7684\u53d1\u751f\u53d8\u5316\uff0c\u6709\u7684\u65f6\u5019\u6211\u4eec\u9700\u8981\u6839\u636e\u53d8\u5316\u6765\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u4ee5\u5f80\u901a\u8fc7 Mutation Events \u6765\u76d1\u542c DOM \u7684\u53d8\u5316\uff0c\u76ee\u524d\u5b83\u5df2\u7ecf\u5e9f\u5f03\u4e86\uff0c\u88ab MutationObserver \u6240\u53d6\u4ee3\u3002MutationObserver \u7684\u517c\u5bb9\u6027\u5f88\u597d\uff0c\u53ef\u4ee5\u653e\u5fc3\u5927\u80c6\u7684\u4f7f\u7528\u3002","date":"2022-10-11T00:00:00.000Z","formattedDate":"2022\u5e7410\u670811\u65e5","tags":[{"label":"MutationObserver","permalink":"/blog/tags/mutation-observer"},{"label":"DOM","permalink":"/blog/tags/dom"}],"readingTime":16.795,"hasTruncateMarker":true,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"MutationObserver","tags":["MutationObserver","DOM"],"authors":"xiongtao","date":"2022-10-11T00:00:00.000Z"},"prevItem":{"title":"\u79fb\u52a8\u7aef\u6587\u5b57\u5782\u76f4\u5c45\u4e2d\u65b9\u6848","permalink":"/blog/mobile-text-middle"},"nextItem":{"title":"IntersectionObserver","permalink":"/blog/IntersectionObserver"}},"content":"import Tabs from \'@theme/Tabs\';\\nimport TabItem from \'@theme/TabItem\';\\n\\n\u5728\u590d\u6742\u7684\u7f51\u9875\u5e94\u7528\u4e2d\uff0cDOM \u7ed3\u6784\u4f1a\u9891\u7e41\u7684\u53d1\u751f\u53d8\u5316\uff0c\u6709\u7684\u65f6\u5019\u6211\u4eec\u9700\u8981\u6839\u636e\u53d8\u5316\u6765\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u4ee5\u5f80\u901a\u8fc7 `Mutation Events` \u6765\u76d1\u542c DOM \u7684\u53d8\u5316\uff0c\u76ee\u524d\u5b83\u5df2\u7ecf\u5e9f\u5f03\u4e86\uff0c\u88ab `MutationObserver` \u6240\u53d6\u4ee3\u3002`MutationObserver` \u7684\u517c\u5bb9\u6027\u5f88\u597d\uff0c\u53ef\u4ee5\u653e\u5fc3\u5927\u80c6\u7684\u4f7f\u7528\u3002\\n\\n<img src=\\"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/image.70ve24867iw.webp\\" style={{ zoom: \'50%\'}} />\\n\\n## \u57fa\u672c\u7528\u6cd5\\n\\n`MutationObserver` \u7684\u57fa\u672c\u7528\u6cd5\u5982\u4e0b\\n\\n```js\\nconst observer = new MutationObserver(mutations => {\\n\\n});\\nobserver.observe(element, options);\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n\u6211\u4eec\u901a\u8fc7 `new MutationObserver()` \u521b\u5efa\u4e00\u4e2a `MutationObserver` \u5bf9\u8c61\uff0c\u6784\u9020\u51fd\u6570\u63a5\u6536\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\uff0c\u5f53\u88ab\u76d1\u542c\u7684\u5143\u7d20 DOM \u53d1\u751f\u53d8\u5316\u65f6\uff0c\u8be5\u56de\u8c03\u51fd\u6570\u5c06\u4f1a\u6267\u884c\u3002\\n\\n\u56de\u8c03\u51fd\u6570\u63a5\u6536\u4e00\u4e2a\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u5176\u4e2d\u5143\u7d20\u7c7b\u578b\u4e3a `MutationRecord`\uff0c`MutationRecord` \u5305\u542b\u5982\u4e0b\u5c5e\u6027\uff1a\\n\\n```js\\n{\\n\\ttype: \'attributes\',\\n\\ttarget: div#container,\\n\\taddedNodes: [],\\n\\tremoveNodes: [],\\n\\tpreviousSibling: null,\\n\\tnextSibling: null,\\n\\tattributeName: \'\',\\n\\tattributeNamespace: null,\\n\\toldValue: \'\'\\n}\\n```\\n\\n\u5728\u540e\u7eed\u5185\u5bb9\u4e2d\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4f5c\u7528\u3002\\n\\n\u901a\u8fc7 `observe(element, options)` \u5bf9\u5143\u7d20 `element` \u8fdb\u884c\u76d1\u542c\uff0c\u9664\u4e86\u9700\u8981\u4f20\u5165\u8981\u76d1\u542c\u7684\u5143\u7d20\u4ee5\u5916\uff0c\u8fd8\u9700\u8981\u4f20\u9012\u4e00\u4e2a `options` \u5bf9\u8c61\uff0c\u5b83\u5305\u62ec\u5982\u4e0b\u5b57\u6bb5\uff1a\\n\\n```js\\n{\\n\\tchildList: true,\\n\\tattributes: true,\\n\\tattributeFilter: [\'class\', \'style\'],\\n\\tattributeOldValue: true,\\n\\tcharacterData: true,\\n\\tcharacterDataOldValue: true,\\n\\tsubtree: true\\n}\\n```\\n\\n\u8fd9\u91cc\u4e3a\u4e86\u5b8c\u6574\u6027\u5c06\u53ef\u8bbe\u7f6e\u7684\u6240\u6709\u53c2\u6570\u5217\u4e86\u51fa\u6765\uff0c\u5b9e\u9645\u5728 `options` \u53c2\u6570\u5e76\u4e0d\u9700\u8981\u6307\u5b9a\u6bcf\u4e00\u4e2a\u5c5e\u6027\u3002\\n\\n\u53ef\u4ee5\u89c2\u5bdf\u5230\u9664\u4e86 `attributeFilter` \u5c5e\u6027\u5916\uff0c\u5176\u5b83\u5c5e\u6027\u90fd\u662f\u5e03\u5c14\u503c\uff0c\u4e5f\u5c31\u8bf4\u8fd9\u4e9b\u5c5e\u6027\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5f00\u5173\uff0c\u8bbe\u7f6e\u67d0\u4e2a\u5c5e\u6027\u4e3a `true` \u5c31\u76f8\u5f53\u4e8e\u5f00\u542f\u67d0\u4e2a\u7279\u6027\uff0c\u540e\u9762\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\u6bcf\u4e2a\u5c5e\u6027\u7684\u4f5c\u7528\u3002\\n\\n:::note note\\n\u867d\u7136\u4e0d\u9700\u8981\u6307\u5b9a\u6bcf\u4e00\u4e2a\u5c5e\u6027\uff0c\u4f46\u662f `childList`, `attributes`, `characterData` \u8fd9\u4e09\u4e2a\u5c5e\u6027\u5fc5\u987b\u6709\u4e00\u4e2a\u8bbe\u7f6e\u4e3a `true`\u3002\\n:::\\n\\n\u5982\u679c\u4e0d\u518d\u9700\u8981\u76d1\u542c DOM \u7684\u53d8\u5316\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7 `observer.disconnect()` \u65b9\u6cd5\u505c\u6b62\u76d1\u542c\u3002\\n\\n\u6765\u770b\u4e00\u4e2a\ud83c\udf30\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"container\\">\\n  <p>\u4e16\u754c\u8fd9\u4e48\u5927\uff0c\u6211\u60f3\u53bb\u770b\u770b</p>\\n</div>\\n<button id=\\"btn\\">\u5220\u9664\u5143\u7d20</button>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst observer = new MutationObserver(mutations => {\\n  console.log(mutations);\\n});\\nobserver.observe(document.getElementById(\'container\'), {\\n  childList: true\\n});\\n\\nconst btn = document.getElementById(\'btn\');\\nbtn.addEventListener(\'click\', () => {\\n  document.getElementById(\'container\').removeChild(\\n    document.querySelector(\'#container p\')\\n  );\\n});\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n\u9875\u9762\u4e2d\u6709\u4e00\u4e2a `id` \u4e3a `container` \u7684\u5143\u7d20\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a `p` \u6807\u7b7e\uff0c `p` \u6807\u7b7e\u4e2d\u5176\u4e2d\u5305\u542b\u4e00\u4e9b\u6587\u5b57\u3002\u9875\u9762\u4e2d\u8fd8\u6709\u4e00\u4e2a\u6309\u94ae\uff0c\u5f53\u70b9\u51fb\u6309\u94ae\u65f6\uff0c\u4f1a\u5c06 `p` \u6807\u7b7e\u4ece `container` \u4e2d\u79fb\u9664\u3002\\n\\n\u73b0\u5728\u6211\u4eec\u521b\u5efa\u4e00\u4e2a `MutationObserver`\uff0c\u5e76\u76d1\u542c\u4e86 `container` \u5143\u7d20\uff0c\u8bbe\u7f6e `options` \u4e2d\u7684 `childList` \u4e3a `true`\uff0c\u8868\u793a\u5f53 `container` \u7684\u5b50\u8282\u70b9\u53d1\u751f\u53d8\u5316\u65f6\uff08\u65b0\u589e\u6216\u5220\u9664\uff09\uff0c\u5c06\u4f1a\u88ab\u76d1\u542c\u5230\uff0c\u4ece\u800c\u89e6\u53d1\u56de\u8c03\u51fd\u6570\u7684\u6267\u884c\u3002\u5728\u56de\u8c03\u51fd\u6570\u4e2d\uff0c\u6211\u4eec\u53ea\u662f\u7b80\u5355\u7684\u6253\u5370\u4e86\u56de\u8c03\u51fd\u6570\u7684\u53c2\u6570\u3002\\n\\n\u53ef\u4ee5\u89c2\u5bdf\u5230\uff0c\u5f53\u6211\u4eec\u5220\u9664 `p` \u6807\u7b7e\u65f6\uff0c\u63a7\u5236\u53f0\u6253\u5370\u4e86\u5185\u5bb9\uff0c\u8868\u793a `container` \u7684\u53d8\u5316\u88ab\u76d1\u542c\u5230\u4e86\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-base.mp4\\"></video>\\n\\n:::info info\\n\u901a\u8fc7 `MutationObserver` \u53ef\u4ee5\u76d1\u89c6\u5230\u4e09\u79cd DOM \u53d8\u5316\uff1a\\n\\n1. \u5b50\u5143\u7d20\u53d1\u751f\u53d8\u5316\uff08\u65b0\u589e\u6216\u5220\u9664\uff09\\n2. \u5c5e\u6027\u53d1\u751f\u53d8\u5316\\n3. \u5305\u542b\u7684\u6587\u672c\u53d1\u751f\u53d8\u5316\\n\\n\u53ef\u901a\u8fc7 `MutationRecord` \u5bf9\u8c61\u7684 `type` \u5c5e\u6027\u6765\u533a\u5206\u662f\u4f55\u79cd\u53d8\u5316\uff0c\u5b83\u6709\u4e09\u4e2a\u503c\u5206\u522b\u4e0e\u4e0a\u8ff0\u53d8\u5316\u5bf9\u5e94\uff1a\\n\\n1. `childList`\\n2. `attributes`\\n3. `characterData`\\n:::\\n\\n## \u901a\u8fc7 `childList` \u6765\u76d1\u542c\u5b50\u5143\u7d20\u7684\u53d8\u5316\\n\\n### childList\\n\\n\u5f53 `options` \u4e2d\u7684 `childList` \u8bbe\u7f6e\u4e3a `true` \u65f6\uff0c\u8868\u793a\u76d1\u542c\u5b50\u5143\u7d20\u7684\u53d8\u5316\uff0c\u5373\u5b50\u5143\u7d20\u7684\u65b0\u589e\u4e0e\u5220\u9664\u3002\\n\\n\u540c\u6837\u5728\u9875\u9762\u4e0a\u5b58\u5728\u4e00\u4e2a `container` \u5143\u7d20\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e00\u4e2a `p` \u6807\u7b7e\uff1b\u9875\u9762\u4e0a\u540c\u65f6\u5b58\u5728\u4e00\u4e2a\u6309\u94ae\uff0c\u5f53\u70b9\u51fb\u6309\u94ae\u65f6\u4f1a\u5220\u9664 `p` \u6807\u7b7e\u6216\u8005\u521b\u5efa `p` \u6807\u7b7e\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"container\\">\\n  <p>\u4e16\u754c\u8fd9\u4e48\u5927\uff0c\u6211\u60f3\u53bb\u770b\u770b</p>\\n</div>\\n<button id=\\"btn\\">\u5220\u9664/\u65b0\u589e</button>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  console.log(mutations);\\n});\\nobserver.observe(container, {\\n  childList: true\\n});\\n\\nconst btn = document.querySelector(\'#btn\');\\nbtn.addEventListener(\'click\', () => {\\n  const p = container.querySelector(\'p\');\\n  if (p) {\\n    container.removeChild(p);\\n  } else {\\n    container.innerHTML = \'<p>\u4e16\u754c\u8fd9\u4e48\u5927\uff0c\u6211\u60f3\u53bb\u770b\u770b</p>\';\\n  }\\n});\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-childList1.mp4\\"></video>\\n\\n\u4ece\u89c6\u9891\u53ef\u4ee5\u89c2\u5bdf\u5230\uff0c\u5f53 `p` \u6807\u7b7e\u7684\u5220\u9664\u4e0e\u65b0\u589e\u65f6\uff0c\u5747\u4f1a\u89e6\u53d1\u56de\u8c03\u51fd\u6570\u7684\u6267\u884c\u3002\\n\\n\u901a\u8fc7 `MutationRecord` \u5bf9\u8c61\u7684 `addedNodes` \u4e0e `removedNodes` \u5c5e\u6027\u53ef\u4ee5\u8bbf\u95ee\u5230\u6dfb\u52a0\u7684\u8282\u70b9\u4ee5\u53ca\u5220\u9664\u7684\u8282\u70b9\u3002\u901a\u8fc7 `nextSibling` \u4e0e `prevSibling` \u53ef\u4ee5\u83b7\u5f97\u88ab\u5220\u9664\u6216\u65b0\u589e\u8282\u70b9\u7684\u524d\u540e\u5144\u5f1f\u8282\u70b9\uff08\u5982\u679c\u4e0d\u5b58\u5728\u5219\u4e3a `null`\uff09\u3002\\n\\n```js\\nconst observer = new MutationObserver(mutations => {\\n  mutations.forEach(mutation => {\\n    console.log(mutation.addedNodes);\\n    console.log(mutation.removedNodes);\\n  })\\n});\\nobserver.observe(container, {\\n  childList: true\\n});\\n```\\n<video src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-childList3.mp4\\" controls></video>\\n\\n### subtree\\n\\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8bbe\u7f6e `childList` \u4e3a `true`\uff0c\u53ea\u80fd\u76d1\u542c**\u76f4\u63a5\u5b50\u5143\u7d20**\u7684\u65b0\u589e\u4e0e\u5220\u9664\uff0c\u5bf9\u4e8e\u66f4\u6df1\u5c42\u6b21\u7684\u5b50\u5143\u7d20\u7684\u53d8\u5316\u65e0\u6cd5\u76d1\u542c\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"container\\">\\n  <div id=\\"inner-container\\">\\n    <p>\u4e16\u754c\u8fd9\u4e48\u5927\uff0c\u6211\u60f3\u53bb\u770b\u770b</p>\\n  </div>\\n</div>\\n<button id=\\"btn\\">\u5220\u9664/\u65b0\u589e</button>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  console.log(mutations);\\n});\\nobserver.observe(container, {\\n  childList: true\\n});\\n    \\nconst btn = document.querySelector(\'#btn\');\\nbtn.addEventListener(\'click\', () => {\\n  const innerContainer = document.querySelector(\'#inner-container\');\\n  const p = innerContainer.querySelector(\'p\');\\n  if (p) {\\n    innerContainer.removeChild(p);\\n  } else {\\n    innerContainer.innerHTML = \'<p>\u4e16\u754c\u8fd9\u4e48\u5927\uff0c\u6211\u60f3\u53bb\u770b\u770b</p>\';\\n  }\\n});\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n\u76f8\u6bd4\u4e8e\u4e0a\u4f8b\uff0c\u5728 `p` \u6807\u7b7e\u4e0e `container` \u4e4b\u95f4\u6dfb\u52a0\u4e86\u4e00\u4e2a `inner-container` \u5143\u7d20\uff0c\u6211\u4eec\u8fd8\u662f\u76d1\u542c `container` \u5143\u7d20\uff0c\u70b9\u51fb\u6309\u94ae\u65f6\u5bf9 `p` \u6807\u7b7e\u8fdb\u884c\u79fb\u9664\u6216\u8005\u6dfb\u52a0\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-childList2.mp4\\"></video>\\n\\n\u56e0\u4e3a\u53ea\u80fd\u76d1\u542c\u76f4\u63a5\u5b50\u5143\u7d20\uff0c\u800c `p` \u6807\u7b7e\u5e76\u4e0d\u662f `container` \u7684 \u76f4\u63a5\u5b50\u5143\u7d20\uff0c\u6240\u4ee5 `p` \u6807\u7b7e\u7684\u5220\u9664\u4e0e\u65b0\u589e\u65e0\u6cd5\u88ab\u76d1\u542c\u5230\uff0c\u6240\u4ee5\u56de\u8c03\u51fd\u6570\u4e0d\u4f1a\u88ab\u6267\u884c\uff0c\u63a7\u5236\u53f0\u4e0d\u4f1a\u6709\u4efb\u4f55\u7684\u8f93\u51fa\u3002\\n\\n\u90a3\u6709\u6ca1\u6709\u529e\u6cd5\u8fdb\u884c\u6df1\u5c42\u6b21\u7684\u76d1\u542c\u5462\uff1f\u7b54\u6848\u662f\u6709\uff0c\u9700\u8981\u914d\u5408 `subtree` \u5c5e\u6027\u3002\u9664\u4e86\u9700\u8981\u6307\u5b9a `childList` \u4e3a `true` \u4ee5\u5916\u8fd8\u9700\u8981\u6307\u5b9a `subtree` \u4e3a `true`\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"container\\">\\n  <div id=\\"inner-container\\">\\n    <p>\u4e16\u754c\u8fd9\u4e48\u5927\uff0c\u6211\u60f3\u53bb\u770b\u770b</p>\\n  </div>\\n</div>\\n<button id=\\"btn\\">\u5220\u9664/\u65b0\u589e</button>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  console.log(mutations);\\n});\\nobserver.observe(container, {\\n  childList: true,\\n  subtree: true\\n});\\n    \\nconst btn = document.querySelector(\'#btn\');\\nbtn.addEventListener(\'click\', () => {\\n  const innerContainer = document.querySelector(\'#inner-container\');\\n  const p = innerContainer.querySelector(\'p\');\\n  if (p) {\\n    innerContainer.removeChild(p);\\n  } else {\\n    innerContainer.innerHTML = \'<p>\u4e16\u754c\u8fd9\u4e48\u5927\uff0c\u6211\u60f3\u53bb\u770b\u770b</p>\';\\n  }\\n});\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-childList4.mp4\\"></video>\\n\\n## \u901a\u8fc7 `attributes` \u6765\u76d1\u542c\u5c5e\u6027\u7684\u53d8\u5316\\n\\n### attributes\\n\\n\u5f53\u8bbe\u7f6e `attributes` \u5c5e\u6027\u4e3a `true` \u65f6\uff0c\u5c31\u53ef\u4ee5\u76d1\u542c\u5230\u5c5e\u6027\u7684\u53d8\u5316\uff0c\u5305\u62ec\u81ea\u5b9a\u4e49\u5c5e\u6027\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"container\\" class=\\"red\\">\\n  <p>\u4e16\u754c\u8fd9\u4e48\u5927\uff0c\u6211\u60f3\u53bb\u770b\u770b</p>\\n</div>\\n<button id=\\"btn\\">\u6539\u53d8\u989c\u8272</button>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'css\' label=\'CSS\'>\\n\\n```css\\n.red {\\n  color: red;\\n}\\n.green {\\n  color: green;\\n}\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  console.log(mutations);\\n});\\nobserver.observe(container, {\\n  attributes: true\\n});\\n\\nconst btn = document.querySelector(\'#btn\');\\nbtn.addEventListener(\'click\', () => {\\n  container.classList.toggle(\'red\');\\n  container.classList.toggle(\'green\');\\n});\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n\u5728\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0c\u6bcf\u6b21\u70b9\u51fb\u6309\u94ae\u65f6\uff0c\u90fd\u4f1a\u5bf9 `container` \u7684\u7c7b\u540d\u8fdb\u884c\u6539\u53d8\uff0c\u4ea4\u66ff\u7684\u6dfb\u52a0\u548c\u5220\u9664 `red` \u548c `green` \u7c7b\uff0c\u4ece\u800c\u4f7f\u5f97\u6587\u5b57\u7684\u6837\u5f0f\u53d1\u751f\u53d8\u5316\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-attributes1.mp4\\"></video>\\n\\n\u4ece\u89c6\u9891\u4e2d\u7684\u6253\u5370\u7ed3\u679c\u770b\uff0c\u6bcf\u6b21\u6211\u4eec\u4fee\u6539 `class` \u65f6\uff0c\u56de\u8c03\u51fd\u6570\u90fd\u88ab\u6267\u884c\u4e86\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u6b21\u7684\u6570\u7ec4\u4e2d\u5305\u542b\u4e24\u4e2a\u5143\u7d20\uff0c\u4e00\u4e2a\u662f\u5220\u9664\u7c7b\u7684\u53d8\u52a8\uff0c\u4e00\u4e2a\u662f\u65b0\u589e\u7c7b\u7684\u53d8\u52a8\u3002\\n\\n<img src=\\"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/image.1uex3gw8w2rk.webp\\" style={{ zoom: \'50%\'}} />\\n\\n\u53ef\u89c1\u770b\u5230\uff0c\u5c5e\u6027\u53d8\u52a8\u5bf9\u5e94\u7684 `MutationRecord` \u5bf9\u8c61\u7684 `type` \u4e3a `attributes`\uff0c\u901a\u8fc7 `attributeName` \u53ef\u4ee5\u77e5\u9053\u4ec0\u4e48\u5c5e\u6027\u53d1\u751f\u4e86\u53d8\u5316\u3002\\n\\n### attributeOldValue\\n\\n\u901a\u8fc7\u8bbe\u7f6e `attributeOldValue` \u4e3a `true`\uff0c\u53ef\u4ee5\u77e5\u9053\u53d8\u52a8\u4e4b\u524d\u7684\u5c5e\u6027\u503c\u3002\u770b\u4e00\u4e2a\ud83c\udf30\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"container\\" data-text=\\"Hello World\\"></div>\\n<button id=\\"btn\\">\u6539\u53d8\u81ea\u5b9a\u4e49\u5c5e\u6027</button>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'css\' label=\'CSS\'>\\n\\n```css\\n#container::before {\\n  content: attr(data-text);\\n}\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  mutations.forEach(mutation => {\\n    console.log(mutation.oldValue);\\n  });\\n});\\nobserver.observe(container, {\\n  attributes: true,\\n  attributeOldValue: true\\n});\\n\\nconst texts = [\'Hello World\', \'\u4f60\u597d\u4e16\u754c\'];\\nlet count = 0;\\nconst btn = document.querySelector(\'#btn\');\\nbtn.addEventListener(\'click\', () => {\\n  container.dataset.text = texts[++count % 2];\\n});\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u4e3a `container` \u5143\u7d20\u8bbe\u7f6e\u4e86\u81ea\u5b9a\u4e49\u5c5e\u6027 `data-text`\uff0c\u5e76\u8bbe\u7f6e\u5176\u4f2a\u5143\u7d20 `::before` \u7684 `content` \u4e3a `data-text`\uff0c\u968f\u540e\u6211\u4eec\u70b9\u51fb\u6309\u94ae\uff0c\u6539\u53d8 `data-text` \u7684\u503c\uff0c`content` \u968f\u4e4b\u6539\u53d8\uff0c\u9875\u9762\u53d1\u751f\u53d8\u5316\u3002\u6211\u4eec\u4f7f\u7528 `MutationObserver` \u68c0\u6d4b\u5230\u8fd9\u4e00\u53d8\u5316\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7 `MutationRecord` \u5bf9\u8c61\u7684 `oldValue` \u5c5e\u6027\u6765\u8bbf\u95ee\u5230\u53d8\u5316\u4e4b\u524d\u7684\u5c5e\u6027\u503c\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-attrOldValue.mp4?x=2\\"></video>\\n\\n### attributeFilter\\n\\n\u901a\u8fc7\u6307\u5b9a `attributeFilter` \u5c5e\u6027\uff0c\u53ef\u4ee5\u53ea\u5173\u76d1\u542c\u7279\u5b9a\u5c5e\u6027\u7684\u53d8\u5316\uff0c\u5b83\u7684\u503c\u4e3a\u4e00\u4e2a\u6570\u7ec4\uff0c\u53ea\u76d1\u542c\u6570\u7ec4\u4e2d\u5305\u542b\u7684\u5c5e\u6027\u7684\u53d8\u5316\\n\\n<Tabs>\\n\\n<TabItem value=\'html\'label=\'HTML\'>\\n\\n```html\\n<div class=\\"red\\" id=\\"container\\" data-text=\\"Hello World\\"></div>\\n<button id=\\"btn\\">\u6539\u503c\u4e0e\u6539\u8272</button>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'css\'label=\'CSS\'>\\n\\n```css\\n#container::before {\\n  content: attr(data-text);\\n}\\n.red {\\n  color: red;\\n}\\n.green {\\n  color: green;\\n}\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\'label=\'JavaScript\'>\\n\\n```javascript\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  mutations.forEach(mutation => {\\n    // \u6253\u5370\u51fa\u53d8\u52a8\u7684\u5c5e\u6027\\n    console.log(mutation.attributeName);\\n  })\\n});\\nobserver.observe(container, {\\n  attributes: true,\\n  // \u53ea\u76d1\u542c data-text \u7684\u53d8\u5316\\n  attributeFilter: [\'data-text\']\\n});\\n\\nlet count = 0;\\nconst texts = [\'Hello World\', \'\u4f60\u597d\u4e16\u754c\'];\\nconst btn = document.querySelector(\'#btn\');\\nbtn.addEventListener(\'click\', () => {\\n  container.classList.toggle(\'red\');\\n  container.classList.toggle(\'green\');\\n  container.dataset.text = texts[++count % 2];\\n});\\n```\\n\\n</TabItem>\\n\\n</Tabs>\\n\\n\u5728\u4e0a\u9762\u6211\u4eec\u540c\u65f6\u6539\u53d8 `class` \u5c5e\u6027\u4e0e `data-text` \u5c5e\u6027\uff0c\u4f46\u662f\u5728 `options` \u4e2d\u6211\u4eec\u8bbe\u7f6e\u4e86 `attributeFilter: [\'data-text\']`\uff0c\u5373\u53ea\u76d1\u542c `data-text` \u5c5e\u6027\u3002\u6211\u4eec\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u6253\u5370\u51fa\u76d1\u542c\u7684\u5c5e\u6027\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-attrFilter.mp4\\"></video>\\n\\n\u4ece\u89c6\u9891\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u53ea\u6253\u5370\u4e86 `data-text`\uff0c\u5e76\u6ca1\u6709\u6253\u5370 `class`\u3002\\n\\n### subtree\\n\\n`attributes` \u5c5e\u6027\u4e5f\u53ef\u4ee5\u914d\u5408 `subtree` \u4f7f\u7528\uff0c\u9664\u4e86\u53ef\u4ee5\u76d1\u542c\u6307\u5b9a\u5143\u7d20\u4e0a\u5c5e\u6027\u7684\u53d8\u5316\uff0c\u8fd8\u53ef\u4ee5\u76d1\u542c\u5230\u8be5\u5143\u7d20\u5305\u542b\u7684\u5b50\u5143\u7d20\u4e0a\u7684\u5c5e\u6027\u7684\u53d8\u5316\u3002\\n\\n<Tabs>\\n\\n<TabItem value=\'html\'label=\'HTML\'>\\n\\n```html\\n<div id=\\"container\\">\\n  <p class=\\"red\\">Hello World!</p>\\n</div>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'css\'label=\'CSS\'>\\n\\n```css\\n.red {\\n  color: red;\\n}\\n.green {\\n  color: green;\\n}\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\'label=\'JavaScript\'>\\n\\n```javascript\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  mutations.forEach(mutation => {\\n    console.log(mutation);\\n  });\\n});\\nobserver.observe(container, {\\n  attributes: true,\\n  subtree: true\\n});\\n\\nsetTimeout(()=> {\\n  const p = container.querySelector(\'p\');\\n  p.className = \'green\';\\n}, 3000);\\n```\\n\\n</TabItem>\\n\\n</Tabs>\\n\\n\u5728 `container` \u91cc\u9762\u6709\u4e00\u4e2a `p` \u6807\u7b7e\uff0c`p` \u6807\u7b7e\u5305\u542b\u4e00\u4e2a `class` \u5c5e\u6027\u3002\u6211\u4eec\u4f7f\u7528 \\n`MutationObserver` \u76f4\u63a5\u76d1\u542c `container`\uff0c\u7136\u540e\u5f00\u542f\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u5728\u5b9a\u65f6\u5668\u4e2d\u4fee\u6539 `p` \u6807\u7b7e\u7684 `class` \u5c5e\u6027\uff0c\u7531\u4e8e\u5728 `options` \u4e2d\u8bbe\u7f6e\u4e86 `subtree: true`\uff0c\u6240\u4ee5\u5373\u4f7f\u6211\u4eec\u76d1\u542c\u7684\u662f `container`\uff0c\u4f46\u662f `p` \u6807\u7b7e\u5c5e\u6027\u7684\u53d8\u5316\u8fd8\u662f\u80fd\u88ab\u76d1\u542c\u5230\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-attributes2.mp4\\"></video>\\n\\n## \u901a\u8fc7 `characterData` \u6765\u76d1\u542c\u6587\u672c\u7684\u53d8\u5316\\n\\n### characterData\\n\\n\u901a\u8fc7\u5c06 `characterData` \u8bbe\u7f6e\u4e3a `true` \u6765\u76d1\u542c\u6587\u672c\u8282\u70b9\u7684\u53d8\u5316\u3002\u5176\u76f8\u5e94\u7684 `MutationRecord` \u5bf9\u8c61\u7684 `type` \u5c5e\u6027\u4e3a `characterData`\u3002\\n\\n<Tabs>\\n\\n<TabItem value=\'html\'label=\'HTML\'>\\n\\n```html\\n<div id=\\"container\\" contenteditable=\\"true\\">\u4e16\u754c\u8fd9\u4e48\u5927\uff0c\u6211\u60f3\u53bb\u770b\u770b</div>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\'label=\'JavaScript\'>\\n\\n```javascript\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  mutations.forEach(mutation => {\\n    console.log(mutation);\\n  });\\n});\\nobserver.observe(container.firstChild, {\\n  characterData: true\\n});\\n```\\n\\n</TabItem>\\n\\n</Tabs>\\n\\n\u6211\u4eec\u51c6\u5907\u4e86\u4e00\u4e2a `div`\uff0c\u5e76\u4e14\u8bbe\u7f6e\u4e86\u5176 `contenteditable` \u5c5e\u6027\u4e3a `true`\uff0c\u5373\u5185\u90e8\u6587\u5b57\u53ef\u7f16\u8f91\u3002\u968f\u540e\u6211\u4eec\u76d1\u542c\u4e86 `div` \u4e0b\u7684\u6587\u672c\u8282\u70b9\uff0c\u8bbe\u7f6e\u4e86 `characterData` \u5c5e\u6027\u4e3a `true`\uff0c\u5373\u76d1\u542c\u6587\u5b57\u7684\u53d8\u5316\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-characterData1.mp4\\"></video>\\n\\n:::note note\\n\\n1. \u5f53\u4f7f\u7528 <kbd>Ctrl + B</kbd> \u6216\u8005 <kbd>Ctrl + I</kbd> \u4f7f\u5f97\u6587\u672c\u52a0\u7c97\u6216\u8005\u503e\u659c\u65f6\uff0c\u4f1a\u4f7f\u5f97\u539f\u6587\u672c\u8282\u70b9\u53d8\u4e3a\u591a\u4e2a\u8282\u70b9\uff0c\u8fd9\u65f6\u4f60\u518d\u7f16\u8f91\u6587\u5b57\uff0c\u4f1a\u53d1\u73b0 `MutationObserver` \u4e0d\u8d77\u4f5c\u7528\uff0c\u9664\u975e\u4f60\u7f16\u8f91\u7684\u6587\u5b57\u88ab\u8ba4\u4e3a\u662f\u539f\u59cb\u7684\u6587\u672c\u8282\u70b9\u3002\\n2. \u5f53\u4f60\u5c06\u6587\u672c\u8282\u70b9\u5305\u542b\u7684\u6240\u6709\u6587\u5b57\u90fd\u5220\u9664\u540e\uff0c`MutationObserver` \u4e0d\u518d\u89e6\u53d1\u56de\u8c03\u51fd\u6570\uff0c\u56e0\u4e3a\u4e00\u65e6\u6587\u5b57\u5220\u9664\u540e\uff0c\u539f\u6587\u672c\u8282\u70b9\u5c31\u88ab\u79fb\u9664\u4e86\uff0c\u518d\u6b21\u8f93\u5165\u7684\u6587\u5b57\u5f62\u6210\u4e86\u4e00\u4e2a\u65b0\u7684\u6587\u672c\u8282\u70b9\uff0c\u800c\u8fd9\u4e2a\u6587\u672c\u8282\u70b9\u5e76\u6ca1\u6709\u88ab\u76d1\u542c\u3002\u5982\u679c\u4ee5 `childList: true` \u76d1\u542c\u6587\u672c\u8282\u70b9\u7236\u5bb9\u5668\uff0c\u53ef\u4ee5\u89c2\u5bdf\u5230\u5220\u9664\u6240\u6709\u6587\u672c\u7684\u65f6\u5019\u4f1a\u89e6\u53d1\u4e00\u6b21\u56de\u8c03\u51fd\u6570\uff0c\u56e0\u4e3a\u6b64\u65f6\u6587\u672c\u8282\u70b9\u88ab\u5220\u9664\u4e86\uff0c\u800c\u5220\u5b8c\u4e4b\u540e\u65b0\u589e\u6587\u5b57\u53c8\u4f1a\u89e6\u53d1\u4e00\u6b21\u56de\u8c03\u51fd\u6570\uff0c\u56e0\u4e3a\u6b64\u65f6\u65b0\u589e\u4e86\u4e00\u4e2a\u6587\u672c\u8282\u70b9\u3002\\n3. \u8f93\u5165\u4e2d\u6587\u5b57\u7b26\u65f6 `MutationObserver`\u65e0\u6cd5\u76d1\u542c\u5230\u5bf9\u5e94\u53d8\u5316\u3002\\n\\n:::\\n\\n### subtree\\n\\n\u4ee5\u4e0a\u4e09\u4e2a\u95ee\u9898\u5747\u53ef\u4ee5\u901a\u8fc7\u914d\u5408 `subtree` \u6765\u89e3\u51b3\uff0c\u5f53\u8bbe\u7f6e `subtree` \u4e3a `true` \u65f6\uff0c\u53ef\u4ee5\u76d1\u542c\u5230\u5b50\u8282\u70b9\u4e2d\u6587\u672c\u7684\u53d8\u5316\uff0c\u6240\u4ee5\u4e0d\u7ba1\u662f\u5206\u88c2\u4e3a\u591a\u4e2a\u8282\u70b9\u8fd8\u662f\u539f\u8282\u70b9\u88ab\u5220\u9664\u7136\u540e\u65b0\u589e\uff0c\u6240\u6709\u6587\u672c\u7684\u53d8\u5316\u90fd\u53ef\u4ee5\u88ab\u68c0\u6d4b\u5230\u3002\\n\\n```js\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  mutations.forEach(mutation => {\\n    console.log(mutation);\\n  });\\n});\\nobserver.observe(container, {\\n  characterData: true,\\n  subtree: true\\n});\\n```\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-characterData2.mp4\\"></video>\\n\\n:::note note\\n\u9009\u62e9\u6587\u5b57\u7136\u540e\u8fdb\u884c\u5220\u9664\uff0c\u8fd9\u4e2a\u6587\u672c\u53d8\u5316\u597d\u50cf\u68c0\u67e5\u4e0d\u5230\uff0c\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u8ddf\u9009\u533a\u6709\u5173\u5417\uff1f\\n:::\\n\\n### characterDataOldValue \\n\\n\u8bbe\u7f6e `characterDataOldValue` \u4e3a `true` \u540e\uff0c\u53ef\u4ee5\u901a\u8fc7 `MutationRecord` \u5bf9\u8c61\u7684 `oldValue` \u5c5e\u6027\u83b7\u5f97\u53d8\u52a8\u4e4b\u524d\u7684\u6587\u672c\u3002\\n\\n```js\\nconst container = document.querySelector(\'#container\');\\nconst observer = new MutationObserver(mutations => {\\n  mutations.forEach(mutation => {\\n    console.log(mutation.oldValue);\\n  });\\n});\\nobserver.observe(container, {\\n  characterData: true,\\n  characterDataOldValue: true,\\n  subtree: true,\\n});\\n```\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-chatacterData3.mp4\\"></video>\\n\\n## \u901a\u8fc7 `takeRecords` \u62e6\u622a\u53d8\u5316\\n\\n\u901a\u8fc7 `takeRecords()` \u65b9\u6cd5\uff0c\u53ef\u4ee5\u5728 `mutations` \u88ab\u56de\u8c03\u51fd\u6570\u5904\u7406\u4e4b\u524d\u62e6\u622a\u5230\u3002\\n\\n<Tabs>\\n\\n<TabItem value=\'html\'label=\'HTML\'>\\n\\n```html\\n<ul id=\\"list\\">\\n  <li>\u7bee\u7403</li>\\n  <li>\u8db3\u7403</li>\\n  <li>\u7fbd\u6bdb\u7403</li>\\n</ul>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\'label=\'JavaScript\'>\\n\\n```javascript\\nconst list = document.querySelector(\'#list\');\\nconst observer = new MutationObserver(mutations => {\\n  console.log(\'callback:\', mutations);\\n});\\nobserver.observe(list, {\\n  childList: true\\n});\\n\\nsetTimeout(() => {\\n  list.insertAdjacentHTML(\'beforeend\', \'\\\\\\\\n<li>\u4e52\u4e53\u7403</li>\');\\n  const records = observer.takeRecords();\\n  console.log(\'takeRecords:\', records);\\n}, 3000);\\n```\\n\\n</TabItem>\\n\\n</Tabs>\\n\\n\u4e0a\u9762\u6211\u4eec\u51c6\u5907\u4e86\u4e00\u4e2a\u5217\u8868\uff0c\u4f7f\u7528\u4e00\u4e2a\u5b9a\u65f6\u5668\u5411\u5217\u8868\u4e2d\u6dfb\u52a0\u4e00\u9879\u5185\u5bb9\uff0c\u6dfb\u52a0\u5185\u5bb9\u4e4b\u540e\uff0c\u6211\u4eec\u9a6c\u4e0a\u4f7f\u7528 `takeRecords()` \u8fdb\u884c\u4e86\u62e6\u622a\uff0c\u56e0\u6b64\u4e0d\u4f1a\u89e6\u53d1\u56de\u8c03\u51fd\u6570\u7684\u6267\u884c\u3002\\n\\n<video src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-takeRecords.mp4\\" controls></video>\\n\\n## \u76d1\u542c\u591a\u4e2a\u5143\u7d20\\n\\n\u540c\u4e00\u4e2a `MutationObserver` \u53ef\u4ee5\u540c\u65f6\u76d1\u542c\u591a\u4e2a\u5143\u7d20\uff0c\u53ef\u901a\u8fc7 `disconnect` \u53d6\u6d88\u6240\u6709\u5143\u7d20\u7684\u76d1\u542c\u3002\\n\\n<Tabs>\\n\\n<TabItem value=\'html\'label=\'HTML\'>\\n\\n```html\\n<div id=\\"text1\\" contenteditable=\\"true\\">Hello World!</div>\\n<div id=\\"text2\\" contenteditable=\\"true\\">\u4f60\u597d\uff0c\u4e16\u754c\uff01</div>\\n<button id=\\"btn1\\">\u76d1\u542ctext1</button>\\n<button id=\\"btn2\\">\u76d1\u542ctext2</button>\\n<button id=\\"stopBtn\\">\u53d6\u6d88\u76d1\u542c</button>\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\'js\'label=\'JavaScript\'>\\n\\n```javascript\\nconst observer = new MutationObserver(mutations => {\\n  console.log(mutations);\\n});\\n\\nbtn1.addEventListener(\'click\', () => {\\n  observer.observe(text1, {\\n    characterData: true,\\n    subtree: true\\n  });\\n});\\nbtn2.addEventListener(\'click\', () => {\\n  observer.observe(text2, {\\n    characterData: true,\\n    subtree: true\\n  });\\n});\\nstopBtn.addEventListener(\'click\', () => {\\n  observer.disconnect();\\n});\\n```\\n\\n</TabItem>\\n\\n</Tabs>\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/MutationObserver-disconnect.mp4\\"></video>\\n\\n:::info info\\n\u8c03\u7528 `disconnect()` \u4f1a\u53d6\u6d88\u6240\u6709\u5143\u7d20\u7684\u76d1\u542c\uff0c\u8fd9\u662f\u6211\u89c9\u5f97\u4e0d\u65b9\u4fbf\u7684\u5730\u65b9\uff0c\u4e0d\u50cf `IntersectionObserver` \u53ef\u4ee5\u901a\u8fc7 `unobserve()` \u65b9\u6cd5\u53d6\u6d88\u76d1\u542c\u6307\u5b9a\u7684\u5143\u7d20\u3002\\n:::"},{"id":"IntersectionObserver","metadata":{"permalink":"/blog/IntersectionObserver","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2022-09-28-IntersectionObserver.mdx","source":"@site/blog/2022-09-28-IntersectionObserver.mdx","title":"IntersectionObserver","description":"\u5982\u679c\u6211\u4eec\u9700\u8981\u76d1\u542c\u67d0\u4e2a\u5143\u7d20\u662f\u5426\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\uff0c\u4e00\u822c\u505a\u6cd5\u662f\u76d1\u542c scroll \u4e8b\u4ef6\uff0c\u7136\u540e\u67e5\u8be2\u5143\u7d20\u79bb\u89c6\u53e3\u9876\u90e8\u7684\u8ddd\u79bb\uff0c\u4f46\u662f\u76d1\u542c scroll \u4e8b\u4ef6\u5b58\u5728\u6027\u80fd\u95ee\u9898\u3002","date":"2022-09-28T00:00:00.000Z","formattedDate":"2022\u5e749\u670828\u65e5","tags":[{"label":"IntersectionObserver","permalink":"/blog/tags/intersection-observer"},{"label":"\u5ef6\u8fdf\u52a0\u8f7d","permalink":"/blog/tags/\u5ef6\u8fdf\u52a0\u8f7d"},{"label":"\u65e0\u9650\u6eda\u52a8","permalink":"/blog/tags/\u65e0\u9650\u6eda\u52a8"},{"label":"\u6027\u80fd\u4f18\u5316","permalink":"/blog/tags/\u6027\u80fd\u4f18\u5316"}],"readingTime":9.155,"hasTruncateMarker":true,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"IntersectionObserver","tags":["IntersectionObserver","\u5ef6\u8fdf\u52a0\u8f7d","\u65e0\u9650\u6eda\u52a8","\u6027\u80fd\u4f18\u5316"],"authors":"xiongtao","date":"2022-09-28T00:00:00.000Z"},"prevItem":{"title":"MutationObserver","permalink":"/blog/MutationObserver"},"nextItem":{"title":"Selection\u4e0eRange","permalink":"/blog/selection-and-range"}},"content":"import Tabs from \'@theme/Tabs\';\\nimport TabItem from \'@theme/TabItem\';\\n\\n\u5982\u679c\u6211\u4eec\u9700\u8981\u76d1\u542c\u67d0\u4e2a\u5143\u7d20\u662f\u5426\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\uff0c\u4e00\u822c\u505a\u6cd5\u662f\u76d1\u542c `scroll` \u4e8b\u4ef6\uff0c\u7136\u540e\u67e5\u8be2\u5143\u7d20\u79bb\u89c6\u53e3\u9876\u90e8\u7684\u8ddd\u79bb\uff0c\u4f46\u662f\u76d1\u542c `scroll` \u4e8b\u4ef6\u5b58\u5728\u6027\u80fd\u95ee\u9898\u3002\\n\\n\u6d4f\u89c8\u5668\u539f\u751f\u63d0\u4f9b\u4e86 `IntersectionObserver` \u76d1\u542c\u5668\uff0c\u53ef\u4ee5\u76d1\u542c\u67d0\u4e2a\u5143\u7d20\u662f\u5426\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n## \u4f7f\u7528\u65b9\u6cd5\\n\\n1. \u9996\u5148\u901a\u8fc7 `new IntersectionObserver(callback, options)` \u521b\u5efa\u4e00\u4e2a\u76d1\u89c6\u5668\uff0c\u5176\u4e2d callback \u662f\u5f53\u76d1\u542c\u7684\u5143\u7d20\u51fa\u73b0\u5728\u89c6\u53e3\u65f6\u6267\u884c\u7684\u56de\u8c03\u51fd\u6570\uff0coptions \u662f\u4e00\u4e9b\u9009\u9879\uff0c\u7a0d\u540e\u4ecb\u7ecd\u3002\\n2. \u7136\u540e\u901a\u8fc7\u76d1\u89c6\u5668\u7684 `observe` \u65b9\u6cd5\u76d1\u542c\u611f\u5174\u8da3\u7684\u5143\u7d20\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"box\\"></div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\'>\\n\\n```css\\n#box {\\n  width: 100%;\\n  height: 500px;\\n  background: deeppink;\\n  position: relative;\\n  top: calc(100vh + 100px);\\n}\\n```  \\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst observer = new IntersectionObserver(entries => {\\n    console.log(\'entries: \', entries);\\n});\\n\\nobserver.observe(document.getElementById(\'box\'));\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/IntersectionObserver-base.mp4\\"></video>\\n\\n## options\\n\\n### threshold\\n\\n\u901a\u8fc7 `threshold` \u53ef\u4ee5\u6307\u5b9a\u5143\u7d20\u4e0e\u89c6\u53e3\u76f8\u4ea4\u7684\u6bd4\u4f8b\u6765\u89e6\u53d1\u56de\u8c03\u51fd\u6570\uff0c\u5b83\u7684\u503c\u662f\u4e00\u4e2a\u6570\u5b57\u6216\u4e00\u4e2a\u6570\u7ec4\uff0c\u9ed8\u8ba4\u662f `0`\uff0c\u5373\u5143\u7d20\u4e00\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u5c31\u6267\u884c\\n\\n```js\\nconst observer = new IntersectionObserver(entries => {  \\n  console.log(entries);  \\n}, {  \\n  threshold: [0.5, 1]  \\n});\\n```\\n\\n\u4e0a\u8ff0\u4ee3\u7801\u8868\u793a\u5f53\u5143\u7d20\u4e00\u534a\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u6216\u8005\u5143\u7d20\u5168\u90e8\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u65f6\uff0c\u5747\u4f1a\u6267\u884c\u56de\u8c03\u51fd\u6570\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/IntersectionObserver-threshold.mp4\\"></video>\\n\\n### root\\n\\n\u6211\u4eec\u4e0d\u6b62\u53ef\u4ee5\u76d1\u542c\u5143\u7d20\u5728\u89c6\u53e3\u4e2d\u51fa\u73b0\u4e0e\u6d88\u5931\uff0c\u5728\u4efb\u610f\u53ef\u6eda\u52a8\u7684\u5143\u7d20\u4e2d\u5747\u53ef\u4ee5\u76d1\u542c\uff0c\u6211\u4eec\u901a\u8fc7 `root` \u6765\u6307\u5b9a\u6eda\u52a8\u7684\u5bb9\u5668\uff0c`root` \u7684\u9ed8\u8ba4\u503c\u4e3a `null`\uff0c\u5f53\u503c\u4e3a `null`\uff0c\u4f7f\u7528 `document` \u4f5c\u4e3a\u6eda\u52a8\u5bb9\u5668\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"box-container\\">\\n  <div id=\\"box\\"></div>\\n  <div id=\\"box-after\\"></div>\\n</div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\'>\\n\\n```css\\nbody {\\n    margin: 0;\\n    padding: 0;\\n}\\n\\n#box-container {\\n    height: 300px;\\n    overflow: auto;\\n    width: 300px;\\n    margin: 100px auto;\\n}\\n\\n#box {\\n    width: 100%;\\n    height: 300px;\\n    background: deepskyblue;\\n    position: relative;\\n    top: 300px;\\n}\\n\\n#box-after {\\n    position: relative;\\n    height: 300px;\\n    top: 300px;\\n}\\n```  \\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst observer = new IntersectionObserver(entries => {\\n  console.log(\'entries: \', entries);\\n}, {\\n  threshold: [0.5, 1],\\n  root: document.getElementById(\'box-container\'),\\n});\\n\\nobserver.observe(document.getElementById(\'box\'));\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/IntersectionObserver-root.mp4\\"></video>\\n\\n### rootMargin\\n\\n`rootMargin `\u53ef\u4ee5\u589e\u5927\u6216\u7f29\u5c0f\u89c6\u53e3\u7684\u533a\u57df\uff0c\u4e0e `margin` \u5c5e\u6027\u7684\u53d6\u503c\u76f8\u4f3c\uff0c\u4e0d\u8fc7\u8fd9\u91cc\u7684 `rootMargin` \u8fd8\u53ef\u4ee5\u4e3a\u8d1f\u503c\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"box\\"></div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\'>\\n\\n```css\\n#box {\\n  width: 100%;\\n  height: 500px;\\n  background: deeppink;\\n  position: relative;\\n  top: calc(100vh + 100px);\\n}\\n```  \\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst observer = new IntersectionObserver(entries => {\\n  console.log(entries);\\n}, {\\n  threshold: [0.5, 1],\\n  rootMargin: \'-100px 0px -100px 0px\'\\n});\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n\u4e0a\u9762\u8bbe\u7f6e\u4e86 `rootMargin` \u4e3a `-100px 0px 0px -100px`\uff0c\u4f7f\u5f97\u89c6\u53e3\u4e0e\u5143\u7d20\u4ea4\u53c9\u533a\u57df\u7684\u8ba1\u7b97\u4e0d\u518d\u662f\u84dd\u8272\uff0c\u800c\u53d8\u4e3a\u4e86\u9ec4\u8272\\n\\n<img src=\\"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/BoundingRect-\u7b2c-2-\u9875.6z20zf4eop40.png\\" style={{zoom: \'50%\'}} />\\n\\n\u5982\u679c\u5143\u7d20\u4e0b\u9762\u6ca1\u6709\u5176\u4ed6\u7a7a\u95f4\uff0c\u90a3\u4e48\u5143\u7d20\u4e0d\u53ef\u80fd\u5b8c\u5168\u4f4d\u4e8e\u9ec4\u8272\u533a\u57df\u4e2d\uff0c`threshold `\u8bbe\u7f6e\u4e3a `1` \u6ca1\u6709\u610f\u4e49\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/IntersectionObserver-rootMargin.mp4\\"></video>\\n\\n\u867d\u7136\u6211\u4eec\u8bbe\u7f6e\u4e86 `threshold: [0.5, 1]` \uff0c\u4f46\u662f\u4ece\u89c6\u9891\u53ef\u4ee5\u770b\u5230\u51fa\u73b0\u548c\u6d88\u5931\u5206\u522b\u53ea\u6253\u5370\u4e86\u4e00\u6b21\u3002\\n\\n## entries\\n\\n\u4f20\u5165\u8be5\u56de\u8c03\u51fd\u6570\u7684\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u56e0\u4e3a\u53ef\u4ee5\u540c\u65f6\u76d1\u542c\u591a\u4e2a\u5bf9\u8c61\uff0c\u591a\u4e2a\u5bf9\u8c61\u53ef\u80fd\u540c\u65f6\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\uff0c\u56e0\u6b64\u662f\u4e00\u4e2a\u6570\u7ec4\u3002\u6570\u7ec4\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u5bf9\u8c61\uff0c\u5305\u542b\u4ee5\u4e0b\u5b57\u6bb5\uff1a\\n\\n- `intersectionRatio`\uff1a\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u7684\u5143\u7d20\u4e0e\u6574\u4f53\u7684\u6bd4\u4f8b\\n- `boundingClientRect`\uff1a\u5143\u7d20\u7684\u5927\u5c0f\u53ca\u4f4d\u7f6e\u4fe1\u606f\\n- `intersectionRect`\uff1a\u5143\u7d20\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u8fd9\u90e8\u5206\u7684\u5927\u5c0f\u53ca\u4f4d\u7f6e\u4fe1\u606f\\n- `rootBounds`\uff1aroot \u7684\u5927\u5c0f\u53ca\u4f4d\u7f6e\u4fe1\u606f\\n- `target`\uff1a\u88ab\u76d1\u542c\u7684\u5143\u7d20\\n- `time`\uff1a\u89e6\u53d1\u8be5\u4e8b\u4ef6\u7684\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u6beb\u79d2\uff0c\u9875\u9762\u52a0\u8f7d\u65f6\u4e3a 0\\n- `isIntersecting`\uff1a\u662f\u51fa\u73b0\u8fd8\u662f\u6d88\u5931\\n\\n### intersectionRatio\\n\\n`intersectionRatio` \u8868\u793a\u5143\u7d20\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u7684\u90e8\u5206\u4e0e\u5143\u7d20\u6574\u4f53\u7684\u6bd4\u4f8b\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/image-for-2022@master/BoundingRect-\u7b2c 3 \u9875.png\\" alt=\\"BoundingRect-\u7b2c 3 \u9875\\" style={{zoom: \'50%\'}} />\\n\\n### boundingClientRect\u3001intersectionRect \u4e0e rootBounds\\n\\n`boundingClientRect`\u3001`intersectionRect` \u4e0e `rootBounds` \u7684\u503c\u90fd\u662f `DOMRect` \u5bf9\u8c61\uff0c\u63d0\u4f9b\u4e86\u5143\u7d20\u7684\u5927\u5c0f\u4ee5\u53ca\u76f8\u5bf9\u4e8e\u89c6\u53e3\u7684\u4f4d\u7f6e\u5173\u7cfb\uff0c\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 `Element.getBoundingClientRect()` \u65b9\u6cd5\uff0c\u5404\u5b57\u6bb5\u542b\u4e49\u5982\u4e0b\u6240\u793a\u3002\\n\\n<img src=\\"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/BoundingRect-\u7b2c-1-\u9875.61y0smwvqk00.png\\" style={{ zoom: \'50%\'}} />\\n\\n`boundingClientRect` \u8868\u793a\u7684\u662f\u88ab\u76d1\u542c\u7684\u5143\u7d20\u7684\u5927\u5c0f\u4e0e `root` \u7684\u4f4d\u7f6e\u5173\u7cfb\uff0c`intersectionRect` \u8868\u793a\u5143\u7d20\u4e0e\u89c6\u53e3\u4ea4\u53c9\u533a\u57df\u90e8\u5206\u7684\u5927\u5c0f\u4e0e `root` \u7684\u4f4d\u7f6e\u5173\u7cfb\uff0c`rootBounds` \u8868\u793a\u7684\u662f `root` \u7684\u5927\u5c0f\u4e0e\u89c6\u53e3\u7684\u4f4d\u7f6e\u5173\u7cfb\u3002\\n\\n`rootBounds` \u7684\u5927\u5c0f\u53ca\u4f4d\u7f6e\u5747\u4f1a\u6536\u5230 `rootMargin` \u7684\u5f71\u54cd\u3002\\n\\n### target\\n\\n`target` \u8868\u793a\u7684\u5c31\u662f\u88ab\u76d1\u542c\u7684\u5143\u7d20\u3002\\n\\n### isIntersecting\\n\\n```js\\nconst observer = new IntersectionObserver(entries => {  \\n  for (const entry of entries) {  \\n    console.log(entry.isIntersecting);  \\n  }  \\n}, {  \\n  threshold: [0.5],  \\n});  \\n  \\nobserver.observe(document.getElementById(\'box\'));\\n```\\n\\n\u5f53\u88ab\u76d1\u542c\u7684\u5143\u7d20\u8fdb\u5165\u6216\u6d88\u5931\u4e8e\u89c6\u53e3\u4e2d\u65f6\uff0c\u5747\u4f1a\u89e6\u53d1\u56de\u8c03\u51fd\u6570\u7684\u6267\u884c\uff0c`isIntersecting` \u7684\u503c\u53ef\u4ee5\u8868\u793a\u662f\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u8fd8\u662f\u6d88\u5931\u5728\u89c6\u53e3\u4e2d\uff0c\u5f53\u503c\u4e3a `true` \u65f6\uff0c\u8868\u793a\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\uff0c\u4e3a `false` \u8868\u793a\u6d88\u5931\u5728\u89c6\u53e3\u4e2d\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/IntersectionObserver-isIntersecting.mp4\\"></video>\\n\\n### time\\n\\n\u53ef\u89c1\u6027\u53d1\u751f\u53d8\u5316\u7684\u65f6\u95f4\uff0c\u662f\u4e00\u4e2a\u9ad8\u7cbe\u5ea6\u65f6\u95f4\u6233\uff0c\u5355\u4f4d\u4e3a\u6beb\u79d2\u3002\\n\\n## \u6848\u4f8b\\n\\n### \u56fe\u7247\u61d2\u52a0\u8f7d\\n\\n\u5982\u679c\u4e00\u4e2a\u9875\u9762\u4e2d\u56fe\u7247\u7684\u6570\u91cf\u592a\u591a\uff0c\u4f1a\u5f71\u54cd\u9875\u9762\u7684\u52a0\u8f7d\u901f\u5ea6\uff0c\u5bf9\u7f51\u7ad9\u6027\u80fd\u9020\u6210\u5f71\u54cd\uff0c\u6211\u4eec\u53ef\u4ee5\u5f53\u56fe\u7247\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u65f6\u624d\u5bf9\u56fe\u7247\u8fdb\u884c\u52a0\u8f7d\uff0c\u4f20\u7edf\u7684\u65b9\u6cd5\u9700\u8981\u76d1\u542c `scroll` \u4e8b\u4ef6\uff0c\u7136\u540e\u5224\u65ad\u56fe\u7247\u662f\u5426\u5728\u89c6\u53e3\u4e2d\u3002\u4f46\u662f `scroll` \u89e6\u53d1\u7684\u5341\u5206\u9891\u7e41\uff0c\u5177\u6709\u6027\u80fd\u95ee\u9898\u3002\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7 `IntersectionObserver` \u6765\u5b9e\u73b0\uff0c\u5e76\u4e14\u6709\u8f83\u597d\u7684\u6027\u80fd\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"before\\"></div>\\n<div id=\\"image-list\\">\\n  <img class=\\"lazy-image\\" data-src=\\"images/01.jpg\\" />\\n  <img class=\\"lazy-image\\" data-src=\\"images/02.jpg\\" />\\n  <img class=\\"lazy-image\\" data-src=\\"images/03.jpg\\" />\\n  <img class=\\"lazy-image\\" data-src=\\"images/04.jpg\\" />\\n</div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\'>\\n\\n```css\\n#before {\\n  height: calc(100vh + 10px);\\n}\\n\\n#image-list {\\n  display: flex;\\n  justify-content: space-between;\\n  margin: 100px 50px;\\n}\\n\\n#image-list .lazy-image {\\n  width: 200px;\\n  height: 200px;\\n  object-fit: cover;\\n}\\n```  \\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst observer = new IntersectionObserver(entries => {\\n  entries.forEach(entry => {\\n    // \u5f53\u5411\u4e0b\u6ed1\u52a8\u7684\u65f6\u5019\\n    if (entry.isIntersecting) {\\n      const img = entry.target;\\n      const src = img.dataset.src;\\n      img.src = src;\\n      // \u53d6\u6d88\u76d1\u542c\\n      observer.unobserve(img);\\n    }\\n  });\\n});\\n\\nconst lazyImages = document.getElementsByClassName(\'lazy-image\');\\nfor (let lazyImage of lazyImages) {\\n  observer.observe(lazyImage);\\n}\\n```  \\n\\n</TabItem>\\n</Tabs>\\n\\n\u6211\u4eec\u5c06\u56fe\u7247\u7684\u94fe\u63a5\u8bbe\u7f6e\u5728\u81ea\u5b9a\u4e49\u5c5e\u6027 `data-src` \u4e0a\uff0c\u800c\u4e0d\u662f `src` \u5c5e\u6027\uff0c\u7136\u540e\u6211\u4eec\u76d1\u542c\u8fd9\u4e9b\u56fe\u50cf\uff0c\u5f53\u56fe\u50cf\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u65f6\uff0c\u6211\u4eec\u83b7\u53d6\u56fe\u50cf\u7684 `data-src` \u5c5e\u6027\uff0c\u5e76\u8bbe\u7f6e\u5230 `src` \u5c5e\u6027\u4e0a\uff0c\u5e76\u4e14\u53d6\u6d88\u76d1\u542c\u5bf9\u8c61\u3002\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/IntersectionObserver-%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD.mp4\\"></video>\\n\\n### \u65e0\u9650\u6eda\u52a8\\n\\n\u5047\u8bbe\u6709\u4e00\u4e2a\u5546\u54c1\u5c55\u793a\u9875\uff0c\u56e0\u4e3a\u5546\u54c1\u592a\u591a\uff0c\u6211\u4eec\u4e0d\u4f1a\u4e00\u6b21\u6027\u5168\u90e8\u8bf7\u6c42\uff0c\u800c\u662f\u5f53\u7528\u6237\u5411\u4e0b\u6d4f\u89c8\u67e5\u770b\u5546\u54c1\u65f6\uff0c\u5f53\u5230\u8fbe\u9875\u9762\u5e95\u90e8\u65f6\uff0c\u8bf7\u6c42\u66f4\u591a\u7684\u5546\u54c1\u8fdb\u884c\u5c55\u793a\u3002\u4e00\u822c\u7684\u505a\u6cd5\u662f\u76d1\u542c `scroll` \u4e8b\u4ef6\uff0c\u67e5\u8be2\u6eda\u52a8\u6761\u79bb\u5e95\u90e8\u7684\u8ddd\u79bb\uff0c\u5f53\u5c0f\u4e8e\u4e00\u5b9a\u9608\u503c\u65f6\uff0c\u81ea\u52a8\u7684\u8bf7\u6c42\u6570\u636e\u52a0\u8f7d\u3002\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 `IntersectionObserver` \u83b7\u5f97\u66f4\u597d\u7684\u6027\u80fd\u3002\\n\\n\u6211\u4eec\u5728\u5546\u54c1\u7684\u4e0b\u9762\u653e\u7f6e\u4e00\u4e2a\u5143\u7d20\uff0c\u5f53\u6ed1\u5230\u5e95\u90e8\u65f6\uff0c\u8be5\u5143\u7d20\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\uff0c\u6b64\u65f6\u52a0\u8f7d\u66f4\u591a\u7684\u5546\u54c1\u3002\\n\\n<Tabs>\\n<TabItem value=\'html\' label=\'HTML\' default>\\n\\n```html\\n<div id=\\"goods\\">\\n  <div class=\\"good\\"></div>\\n  <div class=\\"good\\"></div>\\n  <div class=\\"good\\"></div>\\n  <div class=\\"good\\"></div>\\n  <div class=\\"good\\"></div>\\n  <div class=\\"good\\"></div>\\n  <div class=\\"good\\"></div>\\n  <div class=\\"good\\"></div>\\n  <div class=\\"good\\"></div>\\n  <div class=\\"good\\"></div>\\n</div>\\n<div id=\\"footer\\"></div>\\n```\\n\\n</TabItem>\\n<TabItem value=\'css\' label=\'CSS\'>\\n\\n```css\\n#goods {\\n  width: 320px;\\n  display: grid;\\n  grid-template-columns: 1fr 1fr;\\n  gap: 20px;\\n  margin: 20px auto;\\n}\\n\\n.good {\\n  height: 150px;\\n  background: deeppink;\\n}\\n\\n#footer {\\n  background: transparent;\\n  height: 10px;\\n}\\n```  \\n\\n</TabItem>\\n\\n<TabItem value=\'js\' label=\'JavaScript\'>\\n\\n```js\\nconst observer = new IntersectionObserver(entries => {\\n  entries.forEach(entry => {\\n    if (entry.isIntersecting) {\\n      loadMore(10);\\n    }\\n  });\\n}, {\\n  // \u6269\u5c55\u89c6\u53e3\u7684\u5e95\u90e8\u533a\u57df\uff0c\u63d0\u524d\u52a0\u8f7d\\n  rootMargin: \'0px 0px 100px 0px\'\\n});\\n\\nconst loadMore = (n) => {\\n  let appendedGoods = \'\';\\n  for (let i = 0; i < n; i++) {\\n    appendedGoods += \'<div class=\\"good\\"></div>\'\\n  }\\n  const goods = document.getElementById(\'goods\');\\n  goods.innerHTML = goods.innerHTML + appendedGoods;\\n}\\n\\nconst footer = document.getElementById(\'footer\');\\nobserver.observe(footer);\\n```  \\n\\n</TabItem>\\n\\n</Tabs>\\n\\n\\n<video controls src=\\"https://video-obsidian.oss-cn-beijing.aliyuncs.com/IntersectionObserver-%E6%97%A0%E9%99%90%E5%8A%A0%E8%BD%BD.mp4\\"></video>\\n\\n:::info Info\\nIntersectionObserver API \u662f\u5f02\u6b65\u7684\uff0c\u4e0d\u968f\u7740\u76ee\u6807\u5143\u7d20\u7684\u6eda\u52a8\u540c\u6b65\u89e6\u53d1\u3002\\n:::"},{"id":"selection-and-range","metadata":{"permalink":"/blog/selection-and-range","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2022-09-23-Selection\u4e0eRange.mdx","source":"@site/blog/2022-09-23-Selection\u4e0eRange.mdx","title":"Selection\u4e0eRange","description":"\u672c\u6587\u53c2\u8003//segmentfault.com/a/1190000041457245","date":"2022-09-23T00:00:00.000Z","formattedDate":"2022\u5e749\u670823\u65e5","tags":[{"label":"\u9009\u533a","permalink":"/blog/tags/\u9009\u533a"},{"label":"Selection","permalink":"/blog/tags/selection"},{"label":"Range","permalink":"/blog/tags/range"}],"readingTime":7.49,"hasTruncateMarker":true,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"selection-and-range","authors":"xiongtao","date":"2022-09-23T00:00:00.000Z","tags":["\u9009\u533a","Selection","Range"]},"prevItem":{"title":"IntersectionObserver","permalink":"/blog/IntersectionObserver"},"nextItem":{"title":"\u4f7f\u7528CSS\u52a8\u753b\u53d6\u4ee3\u5b9a\u65f6\u5668","permalink":"/blog/css-animation-timer"}},"content":":::info\\n\\n\u672c\u6587\u53c2\u8003: https://segmentfault.com/a/1190000041457245\\n\\n:::\\n\\n\\n## \u5149\u6807\u4e0e\u9009\u533a\\n\\n\u5149\u6807\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u9009\u533a\u3002\\n\\n1. `Selection` \u5bf9\u8c61\u8868\u793a\u7528\u6237\u9009\u62e9\u7684\u6587\u672c\u8303\u56f4\u6216\u63d2\u5165\u7b26\u53f7\u7684\u5f53\u524d\u4f4d\u7f6e\u3002\u5b83\u4ee3\u8868\u9875\u9762\u4e2d\u7684\u6587\u672c\u9009\u533a\uff0c\u53ef\u80fd\u6a2a\u8de8\u591a\u4e2a\u5143\u7d20\u3002\u901a\u5e38\u7531\u7528\u6237\u62d6\u62fd\u9f20\u6807\u7ecf\u8fc7\u6587\u5b57\u800c\u4ea7\u751f\u3002\\n2. `Range`\u5bf9\u8c61\u8868\u793a\u5305\u542b\u8282\u70b9\u548c\u90e8\u5206\u6587\u672c\u8282\u70b9\u7684\u6587\u6863\u7247\u6bb5\u3002\u901a\u8fc7 `selection` \u5bf9\u8c61\u83b7\u5f97\u7684 `range` \u5bf9\u8c61\u624d\u662f\u6211\u4eec\u64cd\u4f5c\u5149\u6807\u7684\u91cd\u70b9\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n```js\\nconst selection = window.getSelection();\\n```\\n\\n\u901a\u5e38\u60c5\u51b5\u4e0b\u6211\u4eec\u4e0d\u4f1a\u76f4\u63a5\u64cd\u4f5c `selection` \u5bf9\u8c61\uff0c\u800c\u662f\u9700\u8981\u64cd\u4f5c\u7528 `seleciton` \u5bf9\u8c61\u6240\u5bf9\u5e94\u7684\u7528\u6237\u9009\u62e9\u7684 `range` \u3002\\n\\n```js\\nconst range = selection.getRangeAt(0);\\n```\\n\\n**\u53ef\u80fd\u5b58\u5728\u591a\u4e2a\u9009\u533a\uff0c\u76ee\u524d\u53ea\u6709 Firefox \u652f\u6301\u591a\u9009\u533a\u3002**\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u90fd\u4e0d\u9700\u8981\u8003\u8651\u591a\u9009\u533a\u7684\u60c5\u51b5\u3002\\n\\n\\nRange \u5bf9\u8c61\u4e0a\u6709\u4e00\u4e2a\u5c5e\u6027\uff0c`collapsed`\uff0c\u8868\u793a\u8d77\u70b9\u548c\u7ec8\u70b9\u662f\u5426\u91cd\u53e0\uff0c\u5f53 `collapsed` \u4e3a `true` \u65f6\uff0c\u9009\u4e2d\u533a\u57df\u88ab\u538b\u7f29\u6210\u4e00\u4e2a\u70b9\uff0c\u5bf9\u4e8e\u666e\u901a\u7684\u5143\u7d20\uff0c\u53ef\u80fd\u4ec0\u4e48\u90fd\u770b\u4e0d\u5230\uff0c\u5982\u679c\u662f\u5728\u53ef\u7f16\u8f91\u5143\u7d20\u4e0a\uff0c\u90a3\u8fd9\u4e2a\u88ab\u538b\u7f29\u7684\u70b9\u5c31\u53d8\u6210\u4e86\u53ef\u4ee5\u95ea\u70c1\u7684\u5149\u6807\u3002 \\n\\n## \u53ef\u7f16\u8f91\u5143\u7d20\\n\\n\u9009\u533a\u548c\u5143\u7d20\u662f\u5426\u53ef\u7f16\u8f91\u5e76\u6ca1\u6709\u76f4\u63a5\u5173\u7cfb\uff0c\u552f\u4e00\u7684\u533a\u522b\u5c31\u662f\uff0c\u5728\u53ef\u7f16\u8f91\u5143\u7d20\u4e0a\u53ef\u4ee5\u770b\u5230\u5149\u6807\u3002\\n\\n```html\\n<input type=\\"text\\">\\n<textarea></textarea>\\n<div contenteditable=\\"true\\"></div>\\n```\\n\\n```css\\ndiv{\\n    -webkit-user-modify: read-write;\\n}\\n```\\n\\n\u8fd9\u4e24\u79cd\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f\u7b80\u5355\u6765\u8bf4\uff0c\u8868\u5355\u5143\u7d20\u66f4\u5bb9\u6613\u63a7\u5236\uff0c\u6d4f\u89c8\u5668\u63d0\u4f9b\u4e86\u66f4\u76f4\u89c2\u7684 API \u6765\u64cd\u63a7\u9009\u533a\u3002\\n\\n## input \u4e0e textarea\\n\\n```js\\ninputElement.setSelectionRange(selectionStart, selectionEnd [, selectionDirection]);\\n```\\n\\n\u9009\u62e9\u5168\u90e8 \\n\\n```js\\ntxt.select();\\ntxt.focus();\\n```\\n\\n\u66ff\u6362\u5185\u5bb9\\n\\n```js\\ninputElement.setRangeText(replacement);\\ninputElement.setRangeText(replacement, start, end [, selectMode]);\\n```\\n\\n- replacement\uff1a\u66ff\u6362\u7684\u6587\u672c\\n- start\uff1a\u8d77\u59cb\u4f4d\u7f6e\\n- end\uff1a\u7ec8\u6b62\u4f4d\u7f6e\\n- selectMode\uff1a\u66ff\u6362\u540e\u7684\u9009\u53d6\u72b6\u6001\\n  - preserve\uff1a\u9ed8\u8ba4\u503c\uff0c\u4fdd\u7559\u9009\u533a\\n\\n\u5047\u8bbe\u624b\u52a8\u9009\u4e2d\u7684\u533a\u57df\u662f `[9,10]`\uff0c\u5982\u679c\u5728 `[1,2]` \u7684\u4f4d\u7f6e\u66ff\u6362\u65b0\u5185\u5bb9\uff0c\u90a3\u4e48\u9009\u533a\u4ecd\u7136\u5728\u4e4b\u524d\u4f4d\u7f6e\u3002\u5982\u679c\u5728 `[8,11]` \u7684\u4f4d\u7f6e\u66ff\u6362\u65b0\u5185\u5bb9\uff0c\u7531\u4e8e\u65b0\u5185\u5bb9\u7684\u4f4d\u7f6e\u8986\u76d6\u4e86\u4e4b\u524d\u7684\u9009\u533a\uff0c\u539f\u9009\u533a\u4e5f\u5c31\u4e0d\u5b58\u5728\u4e86\uff0c\u90a3\u4e48\u66ff\u6362\u5b8c\u4e4b\u540e\uff0c\u9009\u533a\u4f1a\u9009\u4e2d\u521a\u521a\u63d2\u5165\u7684\u65b0\u5185\u5bb9\u3002\\n\\n## \u666e\u901a\u5143\u7d20\u7684\u9009\u533a\u64cd\u4f5c\\n\\n\u9700\u8981\u7528\u5230\u524d\u9762\u63d0\u5230\u7684 `Selection` \u548c `Range` \u76f8\u5173\u65b9\u6cd5\u3002\\n\\n### \u4e3b\u52a8\u9009\u62e9\u67d0\u533a\u57df\\n\\n\u9700\u521b\u5efa\u4e00\u4e2a Range \u5bf9\u8c61\uff0c\u8bbe\u7f6e\u8303\u56f4\uff0c\u7136\u540e\u6dfb\u52a0\u5230 `Selection` \u5bf9\u8c61\u4e2d\\n\\n```javascript\\nrange.setStart(startNode, startOffset);\\nrange.setEnd(endNode, endOffset);\\n```\\n\\n\u56e0\u4e3a\u666e\u901a\u5143\u7d20\u53ef\u80fd\u5305\u542b\u591a\u4e2a\u5143\u7d20\uff0c\u6240\u4ee5\u9009\u533a\u521b\u5efa\u6bd4\u8868\u5355\u590d\u6742\u3002\\n\\n```js\\n// \u79fb\u9664\u6240\u6709\u9009\u533a\\nselection.removeAllRanges()\\n// \u6dfb\u52a0\u9009\u533a\\nselection.addRange(range)\\n```\\n\\n> \u5982\u679c\u8d77\u59cb\u8282\u70b9\u7c7b\u578b\u662f Text \uff0c Comment , or CDATASection \u4e4b\u4e00, \u90a3\u4e48 startOffset \u6307\u7684\u662f\u4ece\u8d77\u59cb\u8282\u70b9\u7b97\u8d77\u5b57\u7b26\u7684\u504f\u79fb\u91cf\u3002 \u5bf9\u4e8e\u5176\u4ed6 Node \u7c7b\u578b\u8282\u70b9\uff0c startOffset \u662f\u6307\u4ece\u8d77\u59cb\u7ed3\u70b9\u5f00\u59cb\u7b97\u8d77\u5b50\u8282\u70b9\u7684\u504f\u79fb\u91cf\u3002\\n\\n### \u9009\u62e9\u8282\u70b9\\n\\n```javascript\\n// \u9009\u4e2d\u8282\u70b9\u5185\u5bb9\uff0c\u5e76\u9009\u4e2d\u6807\u7b7e\\nrange.selectNode();\\n// \u53ea\u9009\u4e2d\u8282\u70b9\u5185\u7684Text\u5185\u5bb9\uff0c\u4e0d\u9009\u4e2d\u6807\u7b7e\\nrange.selectNodeContents();\\n```\\n\\n```info\\n\u6709\u70b9\u50cf innerHTML \u4e0e outerHTML \u7684\u5173\u7cfb\u3002\\n```\\n\\n### \u76f4\u63a5\u6839\u636e\u7236\u5143\u7d20\u9009\u62e9\u6587\u672c\\n\\n\u5982\u4f55\u901a\u8fc7\u76f8\u5bf9\u5916\u5c42\u7684\u504f\u79fb\u91cf\u83b7\u53d6\u5230\u6700\u91cc\u5c42\u5143\u7d20\u7684\u4fe1\u606f\u5462\uff1f\u6574\u4f53\u601d\u8def\u5c31\u662f**\u6df1\u5ea6\u4f18\u5148\u904d\u5386**\u6807\u7b7e\uff0c\u53d6\u5f97\u6240\u6709\u7684 TextNode\uff0c\u5e76\u5f97\u5230\u6bcf\u4e2a TextNode \u6240\u5728\u7684\u533a\u95f4\u3002\u7136\u540e\u627e\u5230\u8d77\u59cb\u70b9\u548c\u7ec8\u6b62\u70b9\u6240\u5728\u7684\u533a\u95f4\uff0c\u8fd4\u56de\u8be5\u533a\u95f4\u7684 TextNode \u4ee5\u53ca\u76f8\u5e94\u7684\u504f\u79fb\u91cf\u3002\\n\\n```js\\nconst getNodeAndOffset = (ele, start = 0, end = 0) => {\\n  const txtList = [];\\n  const dfs = (childNodes) => {\\n    [...childNodes].forEach(node => {\\n      if (node.nodeName === \'#text\') {\\n        txtList.push(node);\\n      } else {\\n        dfs(node.childNodes);\\n      }\\n    })\\n  }\\n  dfs(ele.childNodes);\\n  const clips = txtList.reduce((arr, el, index) => {\\n    const endPosition = el.textContent.length + (index > 0 ? arr[index - 1][2] : 0);\\n    const startPosition = endPosition - el.textContent.length;\\n    arr.push([el, startPosition, endPosition]);\\n    return arr;\\n  }, []);\\n  \\n  const startNode = clips.find(item => start >= item[1] && start < item[2]);\\n  // \u5982\u679c end \u8d85\u8fc7\u4e86\u957f\u5ea6\u8981\u4e0d\u8981\u76f4\u63a5\u8bbe\u7f6e\u4e3a\u672b\u5c3e\\n  const endNode = clips.find(item => end >= item[1] && end < item[2]);\\n  // startNode \u548c endNode \u6ca1\u6709\u627e\u5230\u600e\u4e48\u529e\\n  return [startNode[0], start - startNode[1], endNode[0], end - endNode[1]];\\n}\\n```\\n\\n### \u8fd8\u539f\u9009\u533a\\n\\n```html\\n<div id=\\"txt\\" contenteditable=\\"true\\">\\n  \u5929\u4e0d\u751f\u592b\u5b50\uff0c\u4e07\u53e4\u5982\u957f\u591c\uff01\\n</div>\\n<button id=\\"restore\\">\u8fd8\u539f\u9009\u533a</button>\\n```\\n\\n\u65b9\u6848\u4e00\uff0c\u4fdd\u5b58 Range \u5bf9\u8c61\uff0c\u7136\u540e\u6062\u590d\uff0c\u4f46\u662f\u5f53\u5185\u5bb9\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u539f\u5148\u7684\u9009\u533a\u5c31\u5931\u6548\u4e86\\n\\n```js\\nlet lastRange = null;\\ntxt.addEventListener(\'mouseup\', () => {\\n  const selection = document.getSelection();\\n  lastRange = selection.getRangeAt(0);\\n})\\nconst restore = document.getElementById(\'restore\');\\nrestore.addEventListener(\'click\', () => {\\n  const selection = document.getSelection();\\n  selection.removeAllRanges();\\n  selection.addRange(lastRange);\\n});\\n```\\n\\n\u65b9\u6848\u4e8c\uff0c\u83b7\u5f97\u7edd\u5bf9\u504f\u79fb\u91cf\uff0c\u5373\u4f7f\u5185\u5bb9\u53d1\u751f\u6539\u53d8\uff0c\u4e5f\u4e0d\u5f71\u54cd\u3002\u83b7\u5f97\u7edd\u5bf9\u504f\u79fb\u91cf\u7684\u601d\u8def\u8fd8\u662f\u5148\u83b7\u5f97\u6240\u6709\u6587\u672c\u5143\u7d20\u7684\u533a\u95f4\uff0c\u7136\u540e\u627e\u5230\u88ab\u9009\u4e2d\u7684\u8d77\u59cb\u8282\u70b9\u548c\u7ed3\u675f\u8282\u70b9\uff0c\u83b7\u5f97\u5176\u8d77\u59cb\u504f\u79fb\u548c\u7ed3\u675f\u504f\u79fb\uff0c\u5206\u522b\u52a0\u4e0a\u8282\u70b9\u6240\u5728\u533a\u95f4\u7684\u8d77\u59cb\u503c\u5373\u53ef\u3002\\n\\n```js\\nconst getRangeOffset = ele => {\\n  const txtList = [];\\n  const dfs = (childNodes) => {\\n    [...childNodes].forEach(node => {\\n      if (node.nodeName === \'#text\') {\\n        txtList.push(node);\\n      } else {\\n        dfs(node.childNodes);\\n      }\\n    })\\n  }\\n  dfs(ele.childNodes);\\n  const clips = txtList.reduce((arr, el, index) => {\\n    const endPosition = el.textContent.length + (index > 0 ? arr[index - 1][2] : 0);\\n    const startPosition = endPosition - el.textContent.length;\\n    arr.push([el, startPosition, endPosition]);\\n    return arr;\\n  }, []);\\n  const selection = document.getSelection();\\n  const range = selection.getRangeAt(0);\\n  const startNode = clips.find(item => range.startContainer === item[0]);\\n  const endNode = clips.find(item => range.endContainer === item[0]);\\n  return [startNode[1] + range.startOffset, endNode[1] + range.endOffset];\\n}\\n```\\n\\n```js\\nlet lastRange = {};\\ntxt.addEventListener(\'mouseup\', () => {\\n  const [startOffset, endOffset] = getRangeOffset(txt);\\n  lastRange = {\\n    start: startOffset,\\n    end: endOffset\\n  }\\n})\\nconst restore = document.getElementById(\'restore\');\\nrestore.addEventListener(\'click\', () => {\\n  const selection = document.getSelection();\\n  const range = document.createRange();\\n  const [startNode, startPosition, endNode, endPosition] = getNodeAndOffset(txt, lastRange.start, lastRange.end);\\n  range.setStart(startNode, startPosition);\\n  range.setEnd(endNode, endPosition);\\n  selection.removeAllRanges();\\n  selection.addRange(range);\\n});\\n```\\n\\n### \u63d2\u5165\u5185\u5bb9\\n\\n`range.insertNode()` \u65e2\u53ef\u4ee5\u63d2\u5165\u6587\u672c\u5185\u5bb9\uff0c\u4e5f\u53ef\u4ee5\u63d2\u5165\u6807\u7b7e\u3002\u5b83\u4e0d\u4f1a\u66ff\u6362\u5df2\u9009\u62e9\u7684\u5185\u5bb9\uff0c\u800c\u662f\u5728\u8d77\u70b9\u5904\u63d2\u5165\u4e00\u4e2a\u8282\u70b9\u3002\u5982\u679c\u8981\u66ff\u6362\uff0c\u53ef\u4ee5\u5148\u5220\u9664\u5728\u6dfb\u52a0\uff0c\u901a\u8fc7 `range.deleteContents` \u8fdb\u884c\u5220\u9664\u3002\\n\\n```js\\nconst textNode = document.createTextNode(\'\u65b0\u5185\u5bb9\');\\nrange.deleteContents();\\nrange.insertNode(textNode);\\n```\\n\\n```js\\nconst mark = document.createElement(\'mark\');\\nmark.textContent = \'\u65b0\u5185\u5bb9\';\\nrange.insertNode(mark);\\n```\\n\\n### \u7ed9\u9009\u4e2d\u5185\u5bb9\u5305\u88f9\u6807\u7b7e\\n\\n`range.surroundContents` \u7ed9\u9009\u533a\u5305\u88f9\u4e00\u5c42\u6807\u7b7e\\n\\n```js\\nconst mark = document.createElement(\'mark\');\\nrange.surroundContents(mark);\\n```\\n\\n\u4f46\u662f\u5f53\u9009\u533a\u6a2a\u8de8\u591a\u4e2a\u6807\u7b7e\u65f6\uff0c\u5c31\u4f1a\u53d1\u751f\u9519\u8bef\u3002\u53e6\u4e00\u79cd\u65b9\u6848\uff0c\u901a\u8fc7 `range.extractContents` \u63d0\u53d6\u9009\u533a\u5185\u5bb9\uff0c\u662f\u4e00\u4e2a `DocumentFragment`\uff0c\u7136\u540e\u63d2\u5165\u65b0\u5185\u5bb9\\n\\n```js\\nconst mark = document.createElement(\'mark\');\\nmark.append(range.extractContents());\\nrange.insertNode(mark);\\n```"},{"id":"css-animation-timer","metadata":{"permalink":"/blog/css-animation-timer","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2022-09-15-\u4f7f\u7528CSS\u52a8\u753b\u53d6\u4ee3\u5b9a\u65f6\u5668.mdx","source":"@site/blog/2022-09-15-\u4f7f\u7528CSS\u52a8\u753b\u53d6\u4ee3\u5b9a\u65f6\u5668.mdx","title":"\u4f7f\u7528CSS\u52a8\u753b\u53d6\u4ee3\u5b9a\u65f6\u5668","description":"\u8be5\u7b14\u8bb0\u662f\u6765\u6e90\u4e8e\u516c\u4f17\u53f7\u6587\u7ae0\u8fd8\u5728\u7528\u5b9a\u65f6\u5668\u5417\uff1f\u501f\u52a9 CSS \u6765\u76d1\u542c\u4e8b\u4ef6\u3002","date":"2022-09-15T00:00:00.000Z","formattedDate":"2022\u5e749\u670815\u65e5","tags":[{"label":"CSS","permalink":"/blog/tags/css"},{"label":"\u52a8\u753b","permalink":"/blog/tags/\u52a8\u753b"},{"label":"\u5b9a\u65f6\u5668","permalink":"/blog/tags/\u5b9a\u65f6\u5668"},{"label":"\u795e\u6765\u4e4b\u7b14","permalink":"/blog/tags/\u795e\u6765\u4e4b\u7b14"}],"readingTime":2.305,"hasTruncateMarker":true,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"css-animation-timer","authors":"xiongtao","date":"2022-09-15T00:00:00.000Z","tags":["CSS","\u52a8\u753b","\u5b9a\u65f6\u5668","\u795e\u6765\u4e4b\u7b14"]},"prevItem":{"title":"Selection\u4e0eRange","permalink":"/blog/selection-and-range"},"nextItem":{"title":"\u67ef\u91cc\u5316","permalink":"/blog/\u67ef\u91cc\u5316"}},"content":":::info\\n\\n\u8be5\u7b14\u8bb0\u662f\u6765\u6e90\u4e8e\u516c\u4f17\u53f7\u6587\u7ae0[\u8fd8\u5728\u7528\u5b9a\u65f6\u5668\u5417\uff1f\u501f\u52a9 CSS \u6765\u76d1\u542c\u4e8b\u4ef6](https://mp.weixin.qq.com/s/N25KcGneKPgvBa8zBownlw)\u3002\\n\\n:::\\n\\n## hover\u5ef6\u65f6\u89e6\u53d1\\n\\n### \u4e00\u822c\u65b9\u6cd5\\n\\n\u9f20\u6807\u8fdb\u5165\u65f6\u5f00\u59cb\u5b9a\u65f6\u5668\\n\\n```js\\nvar timer = null\\nel.addEventListener(\'mouseover\', () => {\\n  timer && clearTimeout(timer)\\n  timer = setTimeout(() => {\\n    // \u5177\u4f53\u903b\u8f91\\n  }, 1000)\\n})\\n```\\n\\n\u9f20\u6807\u79bb\u5f00\u65f6\u53d6\u6d88\u5b9a\u65f6\u5668\\n\\n```js\\nel.addEventListener(\'mouseout\', () => {\\n  timer && clearTimeout(timer)\\n})\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n### \u5229\u7528\u52a8\u753b\u7ed3\u675f\u4e8b\u4ef6\\n\\n\u4e3a\u5143\u7d20\u6dfb\u52a0\u5ef6\u65f6\u52a8\u753b\\n\\n```css\\nbutton:hover{\\n  opacity: 0.999; /*\u65e0\u5173\u7d27\u8981\u7684\u6837\u5f0f*/\\n  transition: 0s 1s opacity; /*\u5ef6\u65f6 1s */\\n}\\n```\\n\\n\u76d1\u542c\u52a8\u753b\u7ed3\u675f\u4e8b\u4ef6\\n\\n```js\\nel.addEventListener(\'transitionend\', () => {\\n  // \u5177\u4f53\u903b\u8f91\\n})\\n```\\n\\n\u65e0\u9700\u5b9a\u65f6\u5668\uff0c\u4e5f\u65e0\u9700\u53d6\u6d88\uff0c\u66f4\u65e0\u9700\u8003\u8651 dom \u7ed3\u6784\uff0c\u5b8c\u7f8e\u5b9e\u73b0\u3002\\n\\n## \u957f\u6309\u89e6\u53d1\\n\\n### \u4e00\u822c\u65b9\u6cd5\\n\\n\u501f\u52a9\u5b9a\u65f6\u5668\uff0c\u6309\u4e0b\u65f6\u5f00\u542f\u5b9a\u65f6\u5668\uff0c\u79bb\u5f00\u65f6\u53d6\u6d88\u5b9a\u65f6\u5668\\n\\n```js\\n\\nel.onmousedown = function(){\\n    this.timer && clearTimeout(this.timer);\\n    this.timer = settimeout(function(){\\n        //\u4e1a\u52a1\u4ee3\u7801\\n    },1000)\\n}\\nel.onmouseup = function(){\\n    this.timer && clearTimeout(this.timer);\\n}\\n```\\n\\n### \u5229\u7528\u52a8\u753b\u7ed3\u675f\u4e8b\u4ef6\\n\\n\u4e3a `:active` \u4f2a\u7c7b\u6dfb\u52a0\u5ef6\u65f6\u52a8\u753b\\n\\n```css\\nbutton:hover:active{\\n  opacity: .999; /*\u65e0\u5173\u7d27\u8981\u7684\u6837\u5f0f*/\\n  transition: opacity 1s; /*\u5ef6\u65f6 1s */\\n}\\n```\\n\\n\u7136\u540e\u518d\u76d1\u542c `transitionend` \u4e8b\u4ef6\\n\\n```js\\nel.addEventListener(\'transitionend\', () => {\\n  // \u5177\u4f53\u903b\u8f91\\n})\\n```\\n\\n## \u8f6e\u64ad\u548c\u6682\u505c\\n\\n### \u4e00\u822c\u65b9\u6cd5\\n\\n\u9f20\u6807\u653e\u4e0a\u53bb\u65f6\u6682\u505c\uff0c\u9f20\u6807\u79bb\u5f00\u65f6\u81ea\u52a8\u6eda\u52a8\uff0c\u501f\u52a9\u5b9a\u65f6\u5668 `setInterveal` \u8fdb\u884c\u8f6e\u64ad\uff0c\u9f20\u6807\u653e\u4e0a\u53bb\u65f6\u6e05\u9664\u5b9a\u65f6\u5668\uff0c\u9f20\u6807\u79bb\u5f00\u65f6\u65b0\u5efa\u5b9a\u65f6\u5668\\n\\n```js\\nfunction autoPlay(){\\n  timer && clearInterval(timer)\\n  timer = setInterval(function(){\\n    // \u8f6e\u64ad\u903b\u8f91\\n  }, 1000)\\n}\\nautoPlay()\\nview.onmouseover = function(){\\n    timer && clearInterval(timer)\\n}\\nel.onmouseout = function(){\\n    autoPlay()\\n}\\n```\\n\\n## animationiteration \u4e8b\u4ef6\\n\\n\u8bbe\u7f6e\u52a8\u753b\u4e3a\u65e0\u9650\u6b21\u6570\uff0c\u6bcf\u6b21\u52a8\u753b\u5f00\u59cb\u65f6\u90fd\u4f1a\u89e6\u53d1 animationiteration \u4e8b\u4ef6\uff0c\u9f20\u6807\u653e\u4e0a\u53bb\u65f6\u52a8\u753b\u6682\u505c\\n\\n```css\\n.view {\\n  animation: scroll 1s infinite; /*\u6bcf1s\u52a8\u753b\uff0c\u65e0\u9650\u5faa\u73af*/\\n}\\n.view:hover{\\n  animation-play-state: paused; /*hover\u6682\u505c*/\\n}\\n@keyframes scroll {\\n  to {\\n    transform: translateZ(.1px); /*\u65e0\u5173\u7d27\u8981\u7684\u6837\u5f0f*/\\n  }\\n}\\n```\\n\\n```js\\n\\nview.addEventListener(\\"animationiteration\\", () => {\\n  // \u8f6e\u64ad\u903b\u8f91\\n})\\n```"},{"id":"\u67ef\u91cc\u5316","metadata":{"permalink":"/blog/\u67ef\u91cc\u5316","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2021-06-08-\u67ef\u91cc\u5316.mdx","source":"@site/blog/2021-06-08-\u67ef\u91cc\u5316.mdx","title":"\u67ef\u91cc\u5316","description":"\u67ef\u91cc\u5316\u4ecb\u7ecd","date":"2021-06-08T00:00:00.000Z","formattedDate":"2021\u5e746\u67088\u65e5","tags":[{"label":"\u67ef\u91cc\u5316","permalink":"/blog/tags/\u67ef\u91cc\u5316"},{"label":"\u51fd\u6570\u5f0f\u7f16\u7a0b","permalink":"/blog/tags/\u51fd\u6570\u5f0f\u7f16\u7a0b"}],"readingTime":3.5,"hasTruncateMarker":true,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"\u67ef\u91cc\u5316","authors":"xiongtao","date":"2021-06-08T00:00:00.000Z","tags":["\u67ef\u91cc\u5316","\u51fd\u6570\u5f0f\u7f16\u7a0b"]},"prevItem":{"title":"\u4f7f\u7528CSS\u52a8\u753b\u53d6\u4ee3\u5b9a\u65f6\u5668","permalink":"/blog/css-animation-timer"},"nextItem":{"title":"\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee","permalink":"/blog/\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee"}},"content":"## \u67ef\u91cc\u5316\u4ecb\u7ecd\\n\\n\u51fd\u6570\u67ef\u91cc\u5316\u6307\u7684\u662f\u51fd\u6570\u5904\u7406\u4e00\u90e8\u5206\u7684\u53c2\u6570\uff0c\u7136\u540e\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\u6765\u5904\u7406\u5269\u4f59\u7684\u53c2\u6570\uff0c\u5982\u6bd4\u5982\u6709\u4e00\u4e2a\u52a0\u6cd5\u51fd\u6570\u5982\u4e0b\\n\\n```javascript\\nfunction add(x, y) {\\n    return x + y;\\n}\\nadd(1, 2); // 3\\n```\\n\\n\u73b0\u5728\u5982\u679c\u8fd9\u4e2a\u51fd\u6570\u88ab\u67ef\u91cc\u5316\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5982\u4e0b\u4f7f\u7528\\n\\n```javascript\\nconst increment = add(1); // \u63a5\u6536\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\u5904\u7406\u7b2c\u4e8c\u4e2a\u53c2\u6570\\nincrement(2); // 3\\nincrement(4); // 5\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n## \u67ef\u91cc\u5316\u5b9e\u73b0\\n\\n\u73b0\u5728\u600e\u4e48\u5b9e\u73b0\u8fd9\u79cd\u6548\u679c\uff0c\u5982\u679c\u53ea\u662f\u9488\u5bf9\u4e0a\u9762\u7684\u52a0\u6cd5\u51fd\u6570\uff0c\u90a3\u4e48\u53ef\u4ee5\u5982\u4e0b\u5b9e\u73b0\\n\\n```javascript\\nfunction add(x, y) {\\n    return function(y) {\\n        return x + y;\\n    }\\n}\\n```\\n\\n\u4f46\u662f\u8fd9\u79cd\u65b9\u6cd5\u660e\u663e\u53ea\u5bf9\u52a0\u6cd5\u51fd\u6570\u6709\u6548\uff0c\u6211\u4eec\u73b0\u5728\u662f\u60f3\u8bbe\u8ba1\u4e00\u4e2a\u51fd\u6570\uff0c\u5b83\u63a5\u6536\u4e00\u4e2a\u51fd\u6570\u4e3a\u53c2\u6570\uff0c\u4f5c\u7528\u5c31\u662f\u628a\u8fd9\u4e2a\u51fd\u6570\u67ef\u91cc\u5316\uff0c\u5e76\u5c06\u8fd9\u4e2a\u67ef\u91cc\u5316\u7684\u51fd\u6570\u8fd4\u56de\uff0c\u6bd4\u5982\\n\\n```javascript\\ncurryAdd = curry(add); // \u63a5\u6536add\u51fd\u6570\uff0c\u5c06\u51fd\u6570add\u67ef\u91cc\u5316\\nconst increment = curryAdd(1);\\nincrement(2); // 3\\nincrement(4); // 5\\n```\\n\\n\u9996\u5148\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7248\u672c\u7684\\n\\n```javascript\\nfunction curry(fn, ...args1) {\\n    return function(...args2) {\\n        fn(...args1, ...args2)\\n    }\\n}\\n```\\n\\n\u4f46\u662f\u8fd9\u4e2a\u51fd\u6570\u660e\u663e\u6709\u4e00\u4e2a\u7f3a\u9677\uff0c\u90a3\u5c31\u662f\u53ea\u80fd\u4f20\u5165\u4e24\u6b21\u53c2\u6570\uff0c\u600e\u4e48\u89e3\u51b3\uff0c\u80af\u5b9a\u4f7f\u7528\u9012\u5f52\u4e86\\n\\n```javascript\\nfunction curry(fn, ...args1) {\\n    if (fn.length == args1.length) {\\n        return fn(...args1);\\n    } else {\\n        return function(...args2) {\\n            return curry(fn, ...args1, ...args2)\\n        }\\n    }\\n}\\n```\\n\\n\u4e0a\u9762\u7684\u51fd\u6570\u9996\u5148\u5224\u65ad\u63a5\u6536\u7684\u53c2\u6570\u7684\u4e2a\u6570\u4e0e\u51fd\u6570\u8981\u6c42\u53c2\u6570\u7684\u4e2a\u6570\u662f\u5426\u76f8\u540c\uff0c\u5982\u679c\u76f8\u540c\u5219\u76f4\u63a5\u6267\u884c\u51fd\u6570\uff0c\u5426\u5219\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\u6765\u5904\u7406\u5269\u4e0b\u7684\u53c2\u6570\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u51fd\u6570\u7684\u67ef\u91cc\u5316\u3002\\n\\n## \u67ef\u91cc\u5316\u5e94\u7528\u4e3e\u4f8b\\n\\n\u73b0\u5728\u6765\u770b\u4e00\u4e0b\u67ef\u91cc\u8bdd\u7528\u4ec0\u4e48\u7528\u5904\uff0c\u5047\u8bbe\u6709\u4e00\u4e2a `ajax` \u8bf7\u6c42\u7684\u51fd\u6570\u5982\u4e0b\\n\\n```javascript\\nfunction ajax(type, url, data) {\\n    let xhr = new XMLHttpRequest();\\n    xhr.onReadystateChange = function() {\\n        // ...\\n    }\\n    xhr.open(type, url);\\n    xhr.send(data);\\n}\\n```\\n\\n\u73b0\u5728\u6211\u4eec\u5c06\u8fd9\u4e2a\u51fd\u6570\u67ef\u91cc\u5316\\n\\n```javascript\\nlet curriedAjax = curry(ajax);\\nlet post = curriedAjax(\'post\');\\n```\\n\\n\u6211\u4eec\u5411 `curriedAjax` \u4f20\u5165\u4e00\u4e2a\u53c2\u6570 `post`\uff0c\u5f97\u5230\u4e00\u4e2a\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u7684\u4f5c\u7528\u662f\u7528\u6765\u53d1 `post` \u8bf7\u6c42\u7684\uff0c\u6211\u4eec\u6bcf\u6b21\u53d1 `post` \u8bf7\u6c42\u65f6\uff0c\u53ea\u9700\u8981\u4f7f\u7528 `post` \u65b9\u6cd5\u5373\u53ef\uff0c\u8fd9\u6837\u51fd\u6570\u7684\u590d\u7528\u6027\u6709\u4e86\u6781\u5927\u7684\u589e\u5f3a\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u4f20\u5165\u53c2\u6570\\n\\n```javascript\\nlet postGoogle = post(\'https://www.google.com\');\\n```\\n\\n\u6211\u4eec\u53c8\u5f97\u5230\u4e86\u4e00\u4e2a\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u7684\u4f5c\u7528\u662f\u5411 `https://www.google.com` \u53d1\u9001 `post` \u8bf7\u6c42\uff0c\u51fd\u6570\u7684\u590d\u7528\u6027\u53c8\u8fdb\u4e00\u6b65\u7684\u63d0\u5347\u3002\\n\\n```info\\n\u4f7f\u7528\u8fc7 jQuery \u7684\u90fd\u77e5\u9053\uff0c\u53ef\u4ee5\u4f7f\u7528 `$.ajax()` \u8fd9\u6837\u7684\u901a\u7528\u65b9\u6cd5\uff0c\u4f46\u662f\u4e5f\u6709 `$.get()` \u548c `$.post()` \u8fd9\u6837\u7684\u8bed\u6cd5\u7cd6\uff0c\u4f46\u662f `jQuery` \u5e95\u90e8\u662f\u4e0d\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\u5c31\u4e0d\u5f97\u800c\u77e5\u4e86\u3002\\n```\\n\\n## \u53c2\u8003\u94fe\u63a5\\n\\n- [\u5927\u4f6c\uff0cJavaScript \u67ef\u91cc\u5316\uff0c\u4e86\u89e3\u4e00\u4e0b](https://juejin.im/post/5af13664f265da0ba266efcf)\\n- [JavaScript\u4e13\u9898\u4e4b\u51fd\u6570\u67ef\u91cc\u5316](https://github.com/mqyqingfeng/Blog/issues/42)"},{"id":"\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee","metadata":{"permalink":"/blog/\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2021-05-21-\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee.mdx","source":"@site/blog/2021-05-21-\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee.mdx","title":"\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee","description":"\u672c\u7bc7\u6587\u7ae0\u603b\u7ed3\u63a7\u5236\u5bf9\u8c61\u8bbf\u95ee\u7684\u76f8\u5173 API\u3002","date":"2021-05-21T00:00:00.000Z","formattedDate":"2021\u5e745\u670821\u65e5","tags":[{"label":"Object","permalink":"/blog/tags/object"},{"label":"defineProperty","permalink":"/blog/tags/define-property"},{"label":"defineProperties","permalink":"/blog/tags/define-properties"},{"label":"preventExtensions","permalink":"/blog/tags/prevent-extensions"},{"label":"seal","permalink":"/blog/tags/seal"},{"label":"freeze","permalink":"/blog/tags/freeze"},{"label":"Proxy","permalink":"/blog/tags/proxy"}],"readingTime":9.075,"hasTruncateMarker":true,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee","tags":["Object","defineProperty","defineProperties","preventExtensions","seal","freeze","Proxy"],"authors":"xiongtao","date":"2021-05-21T00:00:00.000Z"},"prevItem":{"title":"\u67ef\u91cc\u5316","permalink":"/blog/\u67ef\u91cc\u5316"},"nextItem":{"title":"\u624b\u5199Promise","permalink":"/blog/\u624b\u5199Promise"}},"content":"\u672c\u7bc7\u6587\u7ae0\u603b\u7ed3\u63a7\u5236\u5bf9\u8c61\u8bbf\u95ee\u7684\u76f8\u5173 API\u3002\\n\\n## Object.defineProperty\\n\\n`Object.defineProperty` \u53ef\u4ee5\u5bf9\u5bf9\u8c61\u7684\u5c5e\u6027\u8fdb\u884c\u914d\u7f6e\uff0c\u5b83\u63a5\u6536\u5982\u4e0b\u53c2\u6570\uff1a\\n\\n- `obj`\uff1a\u5bf9\u8c61\\n- `prop`\uff1a\u5c5e\u6027\\n- `descriptor`\uff1a\u5c5e\u6027\u63cf\u8ff0\u7b26\\n\\n\u5176\u4e2d `descriptor` \u5305\u62ec\u5982\u4e0b\u914d\u7f6e\u9009\u9879\\n\\n- `value`\uff1a\u5c5e\u6027\u7684\u503c\\n- `writable`\uff1a\u5c5e\u6027\u662f\u5426\u53ef\u5199\uff0c\u9ed8\u8ba4\u4e3a `false`\\n- `set`\uff1a\u4e3a\u5c5e\u6027\u8bbe\u7f6e\u503c\u65f6\u4f1a\u89e6\u53d1\u6b64\u65b9\u6cd5\uff0c\u8bbe\u7f6e\u7684\u65b0\u503c\u4f1a\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\\n- `get`\uff1a\u8bbf\u95ee\u6b64\u5c5e\u6027\u662f\u4f1a\u89e6\u53d1\u6b64\u65b9\u6cd5\\n- `configurable`\uff1a\u8be5\u5c5e\u6027\u662f\u5426\u53ef\u518d\u6b21\u8fdb\u884c\u914d\u7f6e\uff0c\u9ed8\u8ba4\u4e3a `false`\\n- `enumerable`\uff1a\u662f\u5426\u53ef\u904d\u5386\uff0c\u9ed8\u8ba4\u4e3a `false`\\n\\n\u5176\u4e2d `value` \u4e0e `writable` \u662f\u4e00\u7ec4\uff0c`set` \u548c `get` \u662f\u4e00\u7ec4\uff0c\u4e8c\u8005\u4e0d\u53ef\u540c\u65f6\u4f7f\u7528\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n### \u4f8b\u5b501\\n\\n```javascript\\nconst obj = {}\\n\\nObject.defineProperty(obj, \'name\', {\\n    value: \'Alice\',\\n    writable: false\\n})\\n\\nconsole.log(obj.name) // Alice\\n\\nobj.name = \'Bob\'      // \u4e0d\u53ef\u5199\uff0c\u66f4\u6539\u65e0\u6548\\nconsole.log(obj.name) // Alice\\n```\\n\\n\u5728\u4e0a\u9762\u6211\u4eec\u4e3a `obj` \u7684 `name` \u5c5e\u6027\u914d\u7f6e\u4e86 `value` \u5c5e\u6027\u4e3a `Alice` \u4f5c\u4e3a `obj.name` \u7684\u521d\u59cb\u503c\uff0c\u53c8\u914d\u7f6e\u4e86 `writable` \u4e3a `false`\uff0c\u8868\u660e\u8be5\u5c5e\u6027\u662f\u4e0d\u53ef\u5199\u7684\uff0c\u5bf9\u8be5\u5c5e\u6027\u8fdb\u884c\u8d4b\u503c\u65f6\u65e0\u6548\u7684\u3002\\n\\n### \u4f8b\u5b502\\n\\n```javascript\\nconst obj = {}\\n\\nlet username\\nObject.defineProperty(obj, \'name\', {\\n    set(value) {\\n        if (value === \'Alice\') {\\n            username = value\\n        }\\n    },\\n    get() {\\n        return username\\n    }\\n})\\n\\nobj.name = \'Alice\'     // \u8d4b\u503c\u6709\u6548\\nconsole.log(obj.name)  // Alice\\n\\nobj.name = \'Bob\'       // \u8d4b\u503c\u65e0\u6548 \\nconsole.log(obj.name)  // Alice\\n```\\n\\n\u4e0a\u9762\u6211\u4eec\u4e3a `obj` \u7684 `name` \u5c5e\u6027\u914d\u7f6e\u4e86 `set` \u548c `get` \u65b9\u6cd5\uff0c\u6ca1\u5f53\u6211\u4eec\u4e3a `obj.name` \u8d4b\u4e88\u65b0\u503c\u65f6\u90fd\u4f1a\u8c03\u7528 `set` \u65b9\u6cd5\uff0c\u5e76\u5c06\u65b0\u503c\u4f20\u5165\uff0c\u5728 `set` \u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u5bf9\u65b0\u503c\u8fdb\u884c\u4e86\u5224\u65ad\uff0c\u5982\u679c\u65b0\u503c\u4e3a `Alice` \u5219\u6211\u4eec\u8d4b\u503c\u7ed9 `username`\uff1b\u6bcf\u6b21\u5f53\u6211\u4eec\u8bbf\u95ee `obj.name` \u65f6\uff0c\u5219\u4f1a\u89e6\u53d1 `get` \u65b9\u6cd5\uff0c\u5728 `get` \u65b9\u6cd5\u4e2d\u6211\u4eec\u76f4\u63a5\u8fd4\u56de\u4e86 `username` \u8fd9\u4e2a\u53d8\u91cf\u7684\u503c\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u63a7\u5236\u5bf9\u8c61\u5c5e\u6027\u7684\u8bbf\u95ee\u64cd\u4f5c\u3002\\n\\n### \u4f8b\u5b503\\n\\n```javascript\\nconst obj = {\\n    a: 1,\\n    b: 2\\n}\\nconsole.log(Object.keys(obj)) // [ \'a\', \'b\' ]\\n\\n\\nObject.defineProperty(obj, \'a\', {\\n    enumerable: false         // \u4e0d\u53ef\u679a\u4e3e\\n})\\nconsole.log(Object.keys(obj)) // [ \'b\' ]\\n```\\n\\n\u5728\u4e0a\u9762\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a `obj` \u5bf9\u8c61\uff0c\u5176\u4e2d\u6709 `a, b` \u4e24\u4e2a\u5c5e\u6027\uff0c\u9ed8\u8ba4\u90fd\u662f\u53ef\u679a\u4e3e\u7684\u3002\u901a\u8fc7 `Object.keys` \u65b9\u6cd5\u53ef\u4ee5\u53d6\u5f97\u5bf9\u8c61\u4e2d\u6240\u4ee5\u53ef\u679a\u4e3e\u7684\u5c5e\u6027\uff0c\u8fd9\u65f6\u5b83\u4eec\u90fd\u5728\u8fd4\u56de\u7684\u6570\u7ec4\u4e2d\uff1b\u63a5\u7740\u6211\u4eec\u914d\u7f6e `a` \u4e3a\u4e0d\u53ef\u679a\u4e3e\uff0c\u6b64\u65f6\u518d\u6b21\u8c03\u7528 `Object.keys`\uff0c\u6b64\u65f6 `a` \u5c31\u4e0d\u5728\u8fd4\u56de\u7684\u6570\u7ec4\u4e2d\u4e86\u3002\\n\\n### \u4f8b\u5b504\\n\\n```javascript\\nconst obj = {\\n    a: 1,\\n    b: 2\\n}\\n\\nObject.defineProperty(obj, \'a\', {\\n    enumerable: false,\\n    configurable: false\\n})\\n\\nconsole.log(Object.keys(obj)) // [ \'b\' ]\\n\\n// TypeError: Cannot redefine property: a\\nObject.defineProperty(obj, \'a\', {\\n    enumerable: true\\n})\\n```\\n\\n\u4e0a\u9762\u6211\u4eec\u914d\u7f6e\u4e86 `a` \u4e3a\u4e0d\u53ef\u679a\u4e3e\uff0c\u5e76\u4e14\u914d\u7f6e `configurable` \u4e3a `false`\uff0c\u7136\u540e\u63a5\u7740\u6211\u4eec\u53c8\u60f3\u914d\u7f6e\u5c5e\u6027 `a` \u4e3a\u53ef\u679a\u4e3e\u7684\uff0c\u4f46\u662f\u4f1a\u62a5\u9519 `TypeError: Cannot redefine property: a`\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u914d\u7f6e `configurable` \u4e3a `false`\uff0c\u8868\u793a\u4e0d\u53ef\u518d\u6b21\u914d\u7f6e\uff0c\u5f53\u6211\u4eec\u518d\u6b21\u5bf9\u5c5e\u6027 `a` \u8fdb\u884c\u914d\u7f6e\u4fbf\u4f1a\u62a5\u9519\u3002\\n\\n```javascript\\nconst obj = {\\n    a: 1,\\n    b: 2\\n}\\n\\nObject.defineProperty(obj, \'a\', {\\n    enumerable: false,\\n    configurable: true        // \u53ef\u7ee7\u7eed\u914d\u7f6e\\n})\\nconsole.log(Object.keys(obj)) // [ \'b\' ]\\n\\nObject.defineProperty(obj, \'a\', {\\n    enumerable: true\\n})\\nconsole.log(Object.keys(obj)) // [ \'a\', \'b\' ]\\n```\\n\\n## Object.defineProperties\\n\\n`Object.defineProperty` \u6bcf\u6b21\u53ea\u80fd\u914d\u7f6e\u5bf9\u8c61\u7684\u4e00\u4e2a\u5c5e\u6027\uff0c\u800c `Object.defineProperties` \u53ef\u4ee5\u4e00\u6b21\u6027\u914d\u7f6e\u5bf9\u8c61\u7684\u591a\u4e2a\u5c5e\u6027\uff0c\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a\\n\\n```javascript\\nObject.defineProperties(obj, {\\n    prop1: {\\n        // \u914d\u7f6e\u9009\u9879\u540c Object.defineProperty\\n    },\\n    prop2: {\\n        // ...\\n    }\\n})\\n```\\n\\n\u89c1\u4e0b\u4f8b\uff1a\\n\\n```javascript\\nconst obj = {\\n    name: \'Alice\',\\n    age: 25\\n}\\n\\nObject.defineProperties(obj, {\\n    name: {\\n        writable: false    // \u4e0d\u80fd\u5199 name \u5c5e\u6027\\n    },\\n    age: {\\n        enumerable: false, // \u4e0d\u80fd\u904d\u5386\u5230 age \u8fd9\u4e2a\u5c5e\u6027\\n        get() {\\n            return 18      // \u522b\u95ee\uff0c\u95ee\u5c31\u662f 18\\n        }\\n    }\\n})\\n```\\n\\n## Object.preventExtensions\\n\\n`Object.preventExtions(obj)` \u53ef\u4ee5\u4f7f\u5f97\u5bf9\u8c61 `obj` \u4e0d\u53ef\u6269\u5c55\uff0c\u5373\u4e0d\u80fd\u4e3a\u5bf9\u8c61\u6dfb\u52a0\u65b0\u7684\u5c5e\u6027\\n\\n```javascript\\nconst obj = {\\n    name: \'Alice\',\\n    age: 20\\n}\\n\\nObject.preventExtensions(obj)\\n\\nobj.gender = \'female\'   // \u65e0\u6cd5\u6dfb\u52a0\u65b0\u7684\u5c5e\u6027\\nconsole.log(obj.gender) // undefined\\n```\\n\\n\u4e0a\u9762\u6211\u4eec\u5c06 `obj` \u8bbe\u7f6e\u4e3a\u4e0d\u53ef\u6269\u5c55\u540e\u8bd5\u56fe\u6dfb\u52a0\u65b0\u7684\u5c5e\u6027\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u6210\u529f\u3002\u8bbe\u7f6e\u4e3a\u4e0d\u53ef\u6269\u5c55\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u73b0\u6709\u5bf9\u8c61\u4e0a\u7684\u5c5e\u6027\uff0c\u4ee5\u53ca\u66f4\u6539\u548c\u5220\u9664\\n\\n```javascript\\nconst obj = {\\n    name: \'Alice\',\\n    age: 20\\n}\\n\\nObject.preventExtensions(obj)\\n\\nobj.name = \'Bob\'\\nconsole.log(obj.name)  // Bob\\n\\ndelete obj.name\\nconsole.log(Object.keys(obj)) // [ \'age\' ]\\n```\\n\\n**\u5bf9\u8c61\u4e00\u65e6\u53d8\u4e3a\u4e0d\u53ef\u6269\u5c55\u540e\uff0c\u5c31\u4e00\u76f4\u662f\u4e0d\u53ef\u6269\u5c55\u7684\u3002**\u901a\u8fc7 `Object.isExtensible` \u65b9\u6cd5\u53ef\u4ee5\u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u662f\u53ef\u6269\u5c55\u7684\\n\\n```javascript\\nconst obj = {\\n    name: \'Alice\',\\n    age: 20\\n}\\n\\nconsole.log(Object.isExtensible(obj)) // true\\nObject.preventExtensions(obj)\\nconsole.log(Object.isExtensible(obj)) // false\\n```\\n\\n## Object.seal\\n\\n`seal` \u7684\u610f\u601d\u662f\u5c01\u5370\uff0c`Object.seal` \u6bd4 `Object.preventExtensiable` \u66f4\u8fd1\u4e00\u6b65\uff0c\u88ab `seal` \u4e86\u7684\u5bf9\u8c61\uff0c\u9664\u4e86\u53d8\u4e3a\u4e0d\u53ef\u6269\u5c55\uff0c\u8fd8\u4e0d\u53ef\u914d\u7f6e `configurable: false`\uff0c\u5c5e\u6027\u4e0d\u80fd\u88ab\u5220\u9664\u4e86\u4ee5\u53ca\u5c5e\u6027\u4e0d\u80fd\u88ab `Object.defineProperty` \u8fdb\u884c\u914d\u7f6e\u4e86\\n\\n```javascript\\nconst obj = {\\n    name: \'Alice\',\\n    age: 20\\n}\\n\\nObject.seal(obj)\\n\\nobj.gender = \'female\'\\nconsole.log(obj.female) // undefined, \u4e0d\u53ef\u6269\u5c55\\n\\ndelete obj.name\\nconsole.log(obj.name)   // Alice, \u4e0d\u53ef\u5220\u9664\\n```\\n\\n\u4f46\u662f\u6211\u4eec\u8fd8\u53ef\u4ee5\u5bf9\u8c61\u73b0\u6709\u7684\u5c5e\u6027\u8fdb\u884c\u66f4\u6539\u7684\\n\\n```javascript\\nconst obj = {\\n    name: \'Alice\',\\n    age: 20\\n}\\n\\nObject.seal(obj)\\n\\nobj.name = \'Bob\'\\nconsole.log(obj.name) // Bob\\n```\\n\\n\u901a\u8fc7 `Object.isSealed` \u53ef\u4ee5\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u88ab `seal` \u4e86\\n\\n```javascript\\nconst obj = {}\\n\\nconsole.log(Object.isSealed(obj)) // false\\nObject.seal(obj)\\nconsole.log(Object.isSealed(obj)) // true\\n```\\n\\n## Object.freeze\\n\\n`freeze` \u662f\u51bb\u7ed3\u7684\u610f\u601d\uff0c\u5b83\u76f8\u5bf9\u4e8e `Object.seal` \u66f4\u8fdb\u4e00\u6b65\uff0c\u4e0d\u4ec5\u4e0d\u53ef\u6269\u5c55\uff0c\u4e0d\u53ef\u914d\u7f6e\uff0c\u5bf9\u8c61\u7684\u6570\u636e\u5c5e\u6027 `writable`  \u4f1a\u88ab\u8bbe\u7f6e\u4e3a  `false`\\n\\n```javascript\\nconst obj = {\\n    name: \'Alice\'\\n}\\n\\nObject.freeze(obj)\\n\\nobj.age = 18     // \u4e0d\u53ef\u6269\u5c55\uff0c\u65e0\u6548\\nobj.name = \'Bob\' // \u4e0d\u53ef\u4fee\u6539\uff0c\u65e0\u6548\\ndelete obj.name  // \u4e0d\u53ef\u914d\u7f6e\uff0c\u65e0\u6548\\n\\nconsole.log(obj) // { name: \'Alice\' }\\n```\\n\\n\u4f46\u662f\u5982\u679c\u6709\u5b9a\u4e49 `set` \u65b9\u6cd5\u7684\u8bdd\uff0c\u5bf9\u8c61\u5c5e\u6027\u8fd8\u662f\u53ef\u4ee5\u88ab\u4fee\u6539\u7684\\n\\n```javascript\\nconst obj = {\\n    name: \'Alice\'\\n}\\n\\nlet username = obj.name\\nObject.defineProperty(obj, \'name\', {\\n    set(value) {\\n        username = value\\n    },\\n    get() {\\n        return username\\n    }\\n})\\n\\nObject.freeze(obj)\\n\\nobj.name = \'Bob\'\\nconsole.log(obj.name) // Bob\\n```\\n\\n\u901a\u8fc7 `Object.isFrozen` \u65b9\u6cd5\u53ef\u4ee5\u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u88ab `freeze` \u4e86\\n\\n```javascript\\nconst obj = {}\\n\\nconsole.log(Object.isFrozen(obj)) // false\\nObject.freeze(obj)\\nconsole.log(Object.isFrozen(obj)) // true\\n```\\n\\n## Proxy\\n\\n`Proxy` \u662f `ES6` \u4e2d\u7684\u65b0\u7279\u6027\uff0c\u5b83\u53ef\u4ee5\u4e3a\u5bf9\u8c61\u505a\u4e00\u5c42\u4ee3\u7406\uff0c\u5f53\u7528\u6237\u901a\u8fc7\u4ee3\u7406\u8bbf\u95ee\u5bf9\u8c61\u65f6\uff0c\u4ee3\u7406\u53ef\u4ee5\u62e6\u622a\u4e00\u4e9b\u64cd\u4f5c\uff0c\u4f8b\u5982\u4e3a\u5c5e\u6027\u8d4b\u503c\uff0c\u8bbf\u95ee\u5c5e\u6027\u7684\u503c\uff0c\u4ece\u800c\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee\u3002`Proxy` \u53ef\u4ee5\u62e6\u622a 13 \u79cd\u64cd\u4f5c\uff0c\u8fd9\u91cc\u4e0d\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u53ea\u4f1a\u4ecb\u7ecd `set` \u548c `get` \u62e6\u622a\u3002\\n\\n`Proxy` \u7684\u8bed\u6cd5\u5982\u4e0b\\n\\n```javascript\\nconst proxy = new Proxy(target, {\\n    // \u62e6\u622a\u7684\u65b9\u6cd5\\n})\\n```\\n\\n### \u4f8b\u5b501\\n\\n```javascript\\nconst target = {\\n    name: \'Alice\',\\n    age: 18\\n}\\n\\nlet proxy = new Proxy(target, {\\n    set(trapTarget, key, value, receiver) {\\n        // \u53ea\u80fd\u4e3a age \u5c5e\u6027\u8d4b\u503c\uff0c\u5e76\u4e14\u503c\u5fc5\u987b\u4e0d\u5927\u4e8e 18 \u624d\u80fd\u8d4b\u503c\u6210\u529f\\n        if (key === \'age\' && value <= 18) {\\n            trapTarget[key] = value\\n        }\\n    }\\n})\\n\\n// \u65e0\u6cd5\u4e3a name \u8d4b\u503c\\nproxy.name = \'Bob\'\\nconsole.log(proxy.name)  // Alice\\nconsole.log(target.name) // Alice\\n\\n// \u5927\u4e8e 18 \u8d4b\u503c\u5931\u8d25\\nproxy.age = 19\\nconsole.log(proxy.age)   // 18\\nconsole.log(target.age)  // 18\\n\\n// \u4e0d\u5927\u4e8e 18\uff0c\u8d4b\u503c\u6210\u529f\\nproxy.age = 15\\nconsole.log(proxy.age)   // 15\\nconsole.log(target.age)  // 15\\n```\\n\\n\u4e0a\u9762\u6211\u4eec\u4e3a `target` \u5bf9\u8c61\u505a\u4e86\u5c42\u4ee3\u7406\uff0c\u5f53\u6211\u4eec\u901a\u8fc7\u4ee3\u7406\u8d4b\u503c\u65f6\uff0c\u4f1a\u88ab `set` \u65b9\u6cd5\u62e6\u622a\uff0c`set` \u65b9\u6cd5\u63a5\u6536\u56db\u4e2a\u53c2\u6570\uff1a\\n\\n- `trapTarget`\uff1a\u88ab\u4ee3\u7406\u7684\u5bf9\u8c61\\n- `key`\uff1a\u88ab\u8d4b\u503c\u7684\u5c5e\u6027\\n- `value`\uff1a\u88ab\u8d4b\u7684\u503c\\n- `receiver`\uff1a\u64cd\u4f5c\u53d1\u751f\u7684\u5bf9\u8c61\uff0c\u5373\u4ee3\u7406\u5bf9\u8c61\\n\\n\u4e0a\u9762\u6211\u4eec\u53ea\u5141\u8bb8\u5bf9 `age` \u5c5e\u6027\u8d4b\u503c\uff0c\u5e76\u4e14\u8d4b\u7684\u503c\u4e0d\u80fd\u5927\u4e8e `18`\u3002\\n\\n### \u4f8b\u5b502\\n\\n```javascript\\nconst target = {\\n    name: \'Alice\',\\n    age: 20\\n}\\n\\nlet proxy = new Proxy(target, {\\n    get(trapTarget, key, receiver) {\\n        if (key === \'age\') {\\n            return 18\\n        }\\n        return trapTarget[key]\\n    }\\n})\\n\\nconsole.log(proxy.age)  // 18\\nconsole.log(target.age) // 20\\n```\\n\\n\u6211\u4eec\u5bf9 `target` \u7684 `get` \u65b9\u6cd5\u8fdb\u884c\u4e86\u4ee3\u7406\uff0c\u5f53\u6211\u4eec\u901a\u8fc7\u4ee3\u7406\u5bf9\u8c61\u8bbf\u95ee\u5c5e\u6027\u503c\u65f6\uff0c\u5982\u679c\u8bbf\u95ee\u7684\u662f `age` \u5c5e\u6027\uff0c\u5219\u8fd4\u56de `18`\uff0c\u5176\u4ed6\u5c5e\u6027\u4e0d\u505a\u5904\u7406\u76f4\u63a5\u8fd4\u56de\u539f\u503c\u3002\\n\\n``` note\\n\u5982\u679c\u76f4\u63a5\u901a\u8fc7 `target` \u8bbf\u95ee\u5c5e\u6027\u7684\u8bdd\uff0c\u64cd\u4f5c\u662f\u4e0d\u4f1a\u88ab\u62e6\u622a\u7684\uff0c\u4ee3\u7406\u6ca1\u6709\u4f5c\u7528\u3002\\n```"},{"id":"\u624b\u5199Promise","metadata":{"permalink":"/blog/\u624b\u5199Promise","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2021-05-12-\u624b\u5199Promise.mdx","source":"@site/blog/2021-05-12-\u624b\u5199Promise.mdx","title":"\u624b\u5199Promise","description":"Promise \u7684\u4f7f\u7528","date":"2021-05-12T00:00:00.000Z","formattedDate":"2021\u5e745\u670812\u65e5","tags":[{"label":"Promise","permalink":"/blog/tags/promise"},{"label":"\u624b\u5199","permalink":"/blog/tags/\u624b\u5199"}],"readingTime":24.235,"hasTruncateMarker":true,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"authors":"xiongtao","slug":"\u624b\u5199Promise","tags":["Promise","\u624b\u5199"]},"prevItem":{"title":"\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee","permalink":"/blog/\u63a7\u5236\u5bf9\u8c61\u7684\u8bbf\u95ee"},"nextItem":{"title":"\u6b63\u5219\u8868\u8fbe\u5f0f","permalink":"/blog/\u6b63\u5219\u8868\u8fbe\u5f0f"}},"content":"## Promise \u7684\u4f7f\u7528\\n\\n### \u56de\u8c03\u5730\u72f1\\n\\n\u9996\u5148\u6211\u4eec\u4e86\u89e3\u4e00\u4e0b `Promise` \u51fa\u73b0\u7684\u80cc\u666f\uff0c\u5047\u8bbe\u6709\u4e0b\u9762\u7684\u7a0b\u5e8f\\n\\n```javascript\\nlet name = getUserNameById(id);\\nlet score = getScoreByName(name);\\nlet scholarship = getScholarshipByScore(score);\\nconsole.log(scholarship);\\n```\\n\\n\u8fd9\u4e2a\u7a0b\u5e8f\u9996\u5148\u6839\u636e `id` \u53bb\u83b7\u53d6\u540d\u5b57\uff0c\u63a5\u7740\u6839\u636e\u62ff\u5230\u7684\u540d\u5b57\u53d6\u83b7\u5f97\u5206\u6570\uff0c\u6700\u540e\u6839\u636e\u5206\u6570\u53bb\u83b7\u53d6\u5956\u5b66\u91d1\uff0c\u6700\u540e\u6253\u5370\u51fa\u5956\u5b66\u91d1\u3002\u4f46\u662f\u8fd9\u4e2a\u7a0b\u5e8f\u771f\u7684\u80fd\u8fbe\u5230\u9884\u671f\u7684\u6548\u679c\u5417? \u7b54\u6848\u662f\u4e0d\u80fd\uff0c\u56e0\u4e3a `JavaScript` \u662f\u5f02\u6b65\u7684\uff0c\u5bf9\u4e8e\u4e00\u822c\u7684\u8017\u65f6\u64cd\u4f5c\u5e76\u4e0d\u4f1a\u7acb\u5373\u6267\u884c\uff0c\u800c\u662f\u5c06\u51fd\u6570\u4fdd\u5b58\u5728\u4e00\u4e2a\u961f\u5217\u4e2d\uff0c\u76f4\u5230\u4ee3\u7801\u6267\u884c\u5b8c\u6bd5\uff0c\u624d\u4f1a\u62ff\u51fa\u961f\u5217\u4e2d\u7684\u51fd\u6570\u6267\u884c\u3002\u6240\u4ee5\u4e0a\u9762\u7684\u51fd\u6570\u90fd\u4e0d\u4f1a\u88ab\u7acb\u5373\u6267\u884c\uff0c\u6240\u4ee5\u5f53\u7136\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u6240\u4ee5\u4e0a\u9762\u7684 `name, score, scholarship` \u90fd\u662f `undefined`\u3002\\n\\n\u4e3a\u4e86\u89e3\u51b3\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u4e00\u822c\u4f1a\u4f7f\u7528\u56de\u8c03\u51fd\u6570\u7684\u5f62\u5f0f\uff0c\u7b49\u6211\u4eec\u6839\u636e `id` \u62ff\u5230 `name` \u4e4b\u540e\uff0c\u5c06 `name` \u4f20\u5165\u56de\u8c03\u51fd\u6570\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\\"\u540c\u6b65\\"\u7684\u6548\u679c\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u4e0a\u9762\u7684\u4ee3\u7801\u4fee\u6539\u5982\u4e0b\\n\\n```javascript\\ngetUserNameById(id, function (name) {\\n  getScoreByName(name, function (score) {\\n    getScholarshipByScore(score, function (scholarship) {\\n      console.log(scholarship);\\n    });\\n  });\\n});\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n\u4f46\u662f\u4e0a\u9762\u7684\u7a0b\u5e8f\u770b\u8d77\u6765\u8fd8\u662f\u602a\u5413\u4eba\u7684\uff0c\u51fd\u6570\u5957\u7740\u51fd\u6570\uff0c\u50cf\u8fd9\u6837\u7684\u60c5\u51b5\u6211\u4eec\u79f0\u4e4b\u4e3a\u56de\u8c03\u5730\u72f1\u3002\u56de\u8c03\u5730\u72f1\u4e0d\u80fd\u4f7f\u7528 `try... catch` \u6355\u83b7\u5f02\u5e38\uff0c\u4e0d\u80fd\u4f7f\u7528 `return`\uff0c\u5e76\u4e14\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u5dee\uff0c\u8fd8\u5bb9\u6613\u51fa\u9519\u3002\u53ef\u80fd\u73b0\u5728\u4f60\u8fd8\u4f53\u4f1a\u4e0d\u5230\uff0c\u4e0a\u9762\u6211\u4eec\u53ea\u662f\u5d4c\u5957\u4e86\u4e09\u5c42\uff0c\u5b9e\u9645\u7684\u60c5\u51b5\u53ef\u80fd\u6709\u66f4\u591a\u7684\u5c42\uff0c\u4f7f\u5f97\u4ee3\u7801\u5f88\u96be\u9605\u8bfb\u3002\\n\\n### Promise \u7684\u7b80\u5355\u4f7f\u7528\\n\\n\u6b63\u662f\u4e3a\u4e86\u89e3\u51b3\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u5728 `ES6` \u4e2d\u63d0\u51fa\u4e86 `Promise` \u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u6765\u770b\u5982\u4f55\u4f7f\u7528 `Promise`\uff0c\u770b\u4e0b\u9762\u7684\u7a0b\u5e8f\\n\\n```javascript\\nlet p = new Promise((resolve) => {\\n  // fn1\\n  setTimeout(() => {\\n    console.log(\\"1s\\");\\n    resolve(1);\\n  }, 1000);\\n});\\n\\np.then((value) => {\\n  // fn2\\n  console.log(value);\\n});\\n```\\n\\n`Promise` \u6784\u9020\u51fd\u6570\u63a5\u53d7\u4e00\u4e2a\u56de\u8c03\u51fd\u6570 `fn1`\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u6709\u4e00\u4e2a `then` \u65b9\u6cd5\uff0c`then` \u65b9\u6cd5\u4e5f\u63a5\u53d7\u4e00\u4e2a\u56de\u8c03\u51fd\u6570 `fn2`\uff0c\u53ea\u6709\u5f53 `fn1` \u4e2d\u63a5\u6536 `resolve` \u51fd\u6570\u6267\u884c(\u5f53 `resolve` \u6267\u884c\u4ee5\u540e\uff0c\u6211\u4eec\u5c31\u8bf4\u8be5 `Promise` \u5bf9\u8c61\u8fdb\u5165\u4e86 `fulfilled` \u72b6\u6001)\uff0c`fn2` \u624d\u4f1a\u88ab\u6267\u884c\u3002\\n\\n\u4ee5\u4e0a\u9762\u7684\u4ee3\u7801\u4e3a\u4f8b\uff0c\u9996\u5148\u6211\u4eec\u5f80 `Promise` \u4e2d\u4f20\u9012\u4e86\u4e00\u4e2a\u56de\u8c03\u51fd\u6570 `fn1`\uff0c\u8be5\u51fd\u6570\u4f1a\u7acb\u5373\u6267\u884c\\n\\n```javascript\\n// \u5411\u6784\u9020\u51fd\u6570\u4e2d\u4f20\u5165\u7684\u56de\u8c03\u51fd\u6570 fn1\\n(resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"1s\\");\\n    resolve(1);\\n  }, 1000);\\n};\\n```\\n\\n\u5f53\u8be5 `fn1` \u7684 `resolve` \u51fd\u6570\u6267\u884c\u4e4b\u540e\uff0c`fn2` \u624d\u4f1a\u88ab\u6267\u884c\uff0c\u6240\u4ee5 `1s` \u4e4b\u540e `fn2` \u624d\u4f1a\u6267\u884c\\n\\n```javascript\\n// then \u63a5\u6536\u7684\u56de\u8c03\u51fd\u6570 fn2\\n(value) => {\\n  console.log(value);\\n};\\n```\\n\\n`fn2` \u63a5\u6536\u7684\u53c2\u6570 `value` \u662f\u901a\u8fc7 `resolve` \u4f20\u5165\u7684\uff0c\u5728\u4e0a\u9762\u6211\u4eec\u901a\u8fc7 `resolve(1)` \u4f20\u5165\u4e86\u53c2\u6570 `1`\uff0c\u6240\u4ee5 `fn2` \u63a5\u53d7\u5230\u7684\u53c2\u6570\u4e3a `1`\u3002\u4e0a\u9762\u6267\u884c\u7684\u7ed3\u679c\u4e3a\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/2020062714122022-04-21-20-12-28.gif\\" style={{ zoom: \'50%\'}}/>\\n\\n\u53ef\u89c1 `fn2` \u662f\u5728 `resolve` \u51fd\u6570\u4e4b\u540e\u6267\u884c\u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u4ee3\u7801\u6267\u884c\u7684\u987a\u5e8f\uff0c\u5e76\u4e14\u4e0d\u7528\u5199\u5d4c\u5957\u7684\u56de\u8c03\u51fd\u6570\uff0c\u800c\u662f\u4f7f\u7528 `then` \u65b9\u6cd5\u8fdb\u884c\\"\u5e73\u884c\\"\u7684\u8c03\u7528\u3002\\n\\n### \u94fe\u5f0f\u8c03\u7528\\n\\n\u6240\u8c13\u7684\u94fe\u5f0f\u8c03\u7528\u662f\u6307\u5728\u8c03\u7528 `then` \u65b9\u6cd5\u4e4b\u540e\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8c03\u7528 `then` \u65b9\u6cd5\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet p = new Promise((resolve) => {\\n  // fn1\\n  resolve(1);\\n});\\n\\np.then((value) => {\\n  // fn2\\n  console.log(value);\\n  return 2;\\n}).then((value) => {\\n  // fn3\\n  console.log(value);\\n});\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b\\n\\n```javascript\\n1;\\n2;\\n```\\n\\n\u5982\u4e0a\u6240\u793a\uff0c\u6211\u4eec\u8fde\u7eed\u8c03\u7528\u4e86\u4e24\u6b21 `then`\uff0c\u5728\u6267\u884c\u65f6\uff0c`fn3` \u662f\u5728 `fn2` \u4e4b\u540e\u6267\u884c\u7684\uff0c\u5e76\u4e14 `fn3` \u4e2d\u7684\u53c2\u6570 `value` \u662f `fn2` \u7684\u8fd4\u56de\u503c\u3002\u5176\u5b9e `then` \u65b9\u6cd5\u4e5f\u53ef\u4ee5\u4e0d\u4f20\u9012\u4efb\u4f55\u7684\u53c2\u6570\\n\\n```javascript\\nlet p = new Promise((resolve) => {\\n  // fn1\\n  resolve(1);\\n});\\n\\np.then((value) => {\\n  // fn2\\n  console.log(value);\\n  return 2;\\n}).then() // \u6ca1\u6709\u4f20\u9012\u4efb\u4f55\u7684\u53c2\u6570\\n  .then((value) => {\\n    // fn3\\n    console.log(value);\\n  });\\n```\\n\\n\u5728\u4e0a\u9762\u6211\u4eec\u8c03\u7528\u4e86\u6ca1\u6709\u4f20\u5165\u56de\u8c03\u51fd\u6570 `then` \u4e4b\u540e\u53c8\u7ee7\u7eed\u8c03\u7528\u4e86\u4e00\u4e2a `then`\uff0c\u6839\u636e\u6211\u4eec\u4e0a\u9762\u6240\u8bb2\u7684\uff0c`fn3` \u63a5\u53d7\u7684\u53c2\u6570 `value` \u662f\u7b2c\u4e8c\u4e2a `then` \u56de\u8c03\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u4f46\u662f\u7531\u4e8e\u7b2c\u4e8c\u4e2a `then` \u6ca1\u6709\u56de\u8c03\u51fd\u6570\uff0c\u610f\u5473\u7740\u6839\u672c\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u8fd9\u4e2a\u65f6\u5019\u4f1a\u628a\u4e0a\u4e00\u5c42\u7684\u8fd4\u56de\u503c\u5373 `fn2` \u8fd4\u56de\u503c\u4f20\u5230 `fn3`\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/202204212013242022-04-21-20-13-25.png\\" style={{ zoom: \'50%\'}}/>\\n\\n\u6240\u4ee5\u4e0a\u9762\u7684\u8f93\u51fa\u662f\\n\\n```javascript\\n1\\n2\\n```\\n\\n`then` \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u9664\u4e86\u53ef\u4ee5\u8fd4\u56de\u666e\u901a\u7684\u503c\u4ee5\u5916\uff0c\u8fd8\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a `Promise` \u5bf9\u8c61\uff0c\u5f53\u8fd4\u56de `Promise` \u5bf9\u8c61\u65f6\uff0c\u4e0b\u9762\u5982\u679c\u7ee7\u7eed\u8c03\u7528 `then`\uff0c\u90a3\u4e48 `then` \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u8981\u7b49\u5230\u8fd9\u4e2a `Promise` \u5bf9\u8c61\u4e2d\u7684 `resolve` \u65b9\u6cd5\u6267\u884c\u540e\u624d\u4f1a\u88ab\u6267\u884c\uff0c\u5373\u8fdb\u5165\u4e86 `fulfilled` \u72b6\u6001 \uff0c\u5e76\u4e14\u8fd9\u4e2a `then` \u4e2d\u56de\u8c03\u51fd\u6570\u6240\u9700\u7684\u53c2\u6570\u662f\u8fd4\u56de\u7684 `Promise` \u5bf9\u8c61 `resolve` \u4f20\u5165\u7684\u503c\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet p = new Promise((resolve) => {\\n  resolve(1);\\n});\\n\\np.then((value) => {\\n  // fn1\\n  console.log(value);\\n  return new Promise((resolve) => {\\n    setTimeout(() => {\\n      console.log(\\"then \u8fd4\u56de\u7684Promise\\");\\n      resolve(2);\\n    }, 1000);\\n  });\\n}).then((value) => {\\n  // fn2\\n  console.log(value);\\n});\\n```\\n\\n`fn2` \u5728 `fn1` \u8fd4\u56de\u7684 `Promise` \u8fdb\u5165\u4e86 `fulfilled` \u72b6\u6001\u4e4b\u540e\u624d\u4f1a\u88ab\u6267\u884c\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/202204212014492022-04-21-20-14-50.png\\" style={{ zoom: \'50%\'}}/>\\n\\n\u4e0a\u9762\u7684\u6267\u884c\u7ed3\u679c\u4e3a\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/2020062717352022-04-21-20-16-02.gif\\" style={{ zoom: \'50%\'}}/>\\n\\n### \u539f\u578b\u65b9\u6cd5\\n\\n\u4e0a\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86 `resolve` \u548c `then` \u65b9\u6cd5\uff0c\u5f53\u6211\u4eec\u6267\u884c `resolve` \u65b9\u6cd5\u4e4b\u540e\uff0c`then` \u63a5\u6536\u7684\u56de\u8c03\u51fd\u6570\u624d\u4f1a\u6267\u884c\u3002\u5176\u5b9e\u4f20\u5165 `Promise` \u7684\u56de\u8c03\u51fd\u6570\u6709\u4e24\u4e2a\u53c2\u6570\uff0c\u4e00\u4e2a\u662f `resolve`\uff0c\u53e6\u4e00\u4e2a\u662f `reject`\uff0c\u5f53\u51fd\u6570\u4ea7\u751f\u9519\u8bef\u65f6\uff0c\u90a3\u4e48\u6211\u4eec\u4f1a\u8c03\u7528 `reject` \u65b9\u6cd5\uff0c\u8fd9\u65f6\u6211\u4eec\u8bf4 `Promise` \u5bf9\u8c61\u8fdb\u5165\u4e86 `rejetced` \u72b6\u6001\uff0c\u8fd9\u65f6\u540e\u9762\u7684 `then` \u65b9\u6cd5\u4e0d\u4f1a\u6267\u884c\uff0c\u4e0e `then` \u65b9\u6cd5\u76f8\u5bf9\u7684\u662f\u4e00\u4e2a `catch` \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4e5f\u662f\u63a5\u6536\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u8be5\u56de\u8c03\u51fd\u6570\u65f6\u7528\u6765\u5904\u7406\u9519\u8bef\u7684\uff0c\u5f53\u8be5 `Promise` \u5bf9\u8c61\u8fdb\u5165\u4e86 `rejected` \u72b6\u6001\uff0c`catch` \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u624d\u4f1a\u88ab\u6267\u884c\uff0c\u4e0e `then` \u76f8\u4f3c\uff0c`catch` \u4e2d\u56de\u8c03\u51fd\u6570\u63a5\u6536\u7684\u53c2\u6570\u662f `reject` \u8c03\u7528\u65f6\u4f20\u5165\u7684\u53c2\u6570\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet p = new Promise((resolve, reject) => {\\n  reject(\\"error\\");\\n}).then(() => {\\n    console.log(\\"then\u65b9\u6cd5\u6267\u884c\u4e86\\");\\n  })\\n  .catch((error) => {\\n    console.log(\\"catch\u65b9\u6cd5\u6267\u884c\\");\\n    console.log(\\"message: \\" + error);\\n  });\\n```\\n\\n\u7ed3\u679c\u4e3a\\n\\n```javascript\\ncatch\u65b9\u6cd5\u6267\u884c;\\nmessage: error;\\n```\\n\\n\u4e0a\u9762\u6211\u4eec\u8c03\u7528\u4e86 `reject`\uff0c\u8fd9\u65f6\u540e\u9762\u7684 `then` \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u662f\u4e0d\u4f1a\u6267\u884c\u7684\uff0c\u800c\u662f\u4f1a\u6267\u884c `catch` \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u3002\\n\\n:::note note\\n\\n\u5176\u5b9e `then` \u65b9\u6cd5\u53ef\u4ee5\u63a5\u53d7\u4e24\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u7b2c\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u7528\u6765\u5904\u7406 `resolve` \u4e4b\u540e\u7684\u7ed3\u679c\uff0c\u800c\u7b2c\u4e8c\u4e2a\u56de\u8c03\u51fd\u6570\u5219\u662f\u7528\u6765\u5904\u7406 `reject` \u4e4b\u540e\u7684\u7ed3\u679c\uff0c\u6bd4\u5982\u4e0a\u9762\u7684\u7a0b\u5e8f\u53ef\u4ee5\u5199\u4e3a\\n\\n```javascript\\nlet p = new Promise((resolve, reject) => {\\n  reject(\\"error\\");\\n}).then(\\n  () => {\\n    console.log(\\"then\u65b9\u6cd5\u6267\u884c\u4e86\\");\\n  },\\n  (error) => {\\n    console.log(\\"catch\u65b9\u6cd5\u6267\u884c\\");\\n    console.log(\\"message:\\" + error);\\n  }\\n);\\n```\\n:::\\n\\n\u6267\u884c\u7684\u7ed3\u679c\u4e0e\u4e0a\u9762\u7684\u76f8\u540c\uff0c**\u5176\u5b9e `catch(onError)` \u51fd\u6570\u672c\u8d28\u4e0a\u5c31\u662f `then(null, onError)`**\u3002\\n\\n\u6709\u7684\u65f6\u5019\u65e0\u8bba\u662f\u6210\u529f\u4ee5\u5426\uff0c\u6211\u4eec\u90fd\u5e0c\u671b\u6267\u884c\u4e00\u4e2a\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u7684\u4f5c\u7528\u4e00\u822c\u662f\u7528\u6765\u8d44\u6e90\u7684\u56de\u6536\uff0c\u7528\u6765\u5b8c\u6210\u8fd9\u4e2a\u529f\u80fd\u7684\u662f `finally` \u51fd\u6570\uff0c\u8be5\u51fd\u6570\u4e5f\u662f\u63a5\u6536\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u8be5\u56de\u8c03\u51fd\u6570\u65e0\u8bba\u662f\u5728 `fulfilled` \u72b6\u6001\u8fd8\u662f `rejected` \u72b6\u6001\u90fd\u662f\u4f1a\u88ab\u6267\u884c\u7684\\n\\n```javascript\\nlet p = new Promise((resolve, reject) => {\\n  // rejected\u72b6\u6001\\n  reject();\\n})\\n  .then(\\n    () => {\\n      console.log(\\"then\u65b9\u6cd5\u6267\u884c\u4e86\\");\\n    },\\n    () => {\\n      console.log(\\"catch\u65b9\u6cd5\u6267\u884c\\");\\n    }\\n  )\\n  .finally(() => {\\n    console.log(\\"finally\u6267\u884c\u4e86\\");\\n  });\\n```\\n\\n\u6700\u540e\u7684\u6267\u884c\u7ed3\u679c\u4e3a\\n\\n```javascript\\ncatch\u65b9\u6cd5\u6267\u884c;\\nfinally\u6267\u884c\u4e86;\\n```\\n\\n\u73b0\u5728\u6211\u4eec\u5c06 `reject()` \u6539\u4e3a `resolve()`\\n\\n```javascript\\nlet p = new Promise((resolve, reject) => {\\n  // fulfilled \u72b6\u6001\\n  resolve();\\n}).then(\\n    () => {\\n      console.log(\\"then\u65b9\u6cd5\u6267\u884c\u4e86\\");\\n    },\\n    () => {\\n      console.log(\\"catch\u65b9\u6cd5\u6267\u884c\\");\\n    }\\n  )\\n  .finally(() => {\\n    console.log(\\"finally\u6267\u884c\u4e86\\");\\n  });\\n```\\n\\n\u8fd9\u65f6\u6267\u884c\u7684\u7ed3\u679c\u4e3a\\n\\n```\\nthen\u65b9\u6cd5\u6267\u884c\u4e86\\nfinally\u6267\u884c\u4e86\\n```\\n\\n\u6240\u4ee5\u4e0d\u8bba\u51fa\u4e8e\u54ea\u4e2a\u72b6\u6001\uff0c`finally` \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u90fd\u4f1a\u88ab\u6267\u884c\u3002\\n\\n### \u9759\u6001\u65b9\u6cd5\\n\\n\u9759\u6001\u65b9\u6cd5\u6307\u7684\u5c31\u662f\u901a\u8fc7 `Promise` \u76f4\u63a5\u8c03\u7528\u7684\u65b9\u6cd5\u3002\\n\\n#### resolve\\n\\n\u6211\u4eec\u9996\u5148\u6765\u4ecb\u7ecd `resolve` \u65b9\u6cd5\uff0c\u8be5\u51fd\u6570\u63a5\u6536\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd4\u56de\u4e00\u4e2a `Promise` \u5bf9\u8c61\uff0c\u6839\u636e\u53c2\u6570\u7684\u4e0d\u540c\u60c5\u51b5\uff0c\u8fd4\u56de\u503c\u4e5f\u4e0d\u76f8\u540c\\n\\n1. \u53c2\u6570\u662f\u4e00\u4e2a `Promise` \u5bf9\u8c61\uff0c\u76f4\u63a5\u8fd4\u56de\\n\\n   ```javascript\\n   let p1 = new Promise((resolve, reject) => {\\n     resolve(123);\\n   });\\n\\n   let p2 = Promise.resolve(p1);\\n\\n   console.log(p1 === p2); // true\\n   ```\\n\\n2. \u53c2\u6570\u662f\u4e00\u4e2a\u542b\u6709 `then` \u65b9\u6cd5\u7684\u5bf9\u8c61(\u6211\u4eec\u4e5f\u79f0\u4e4b\u4e3a `thenable` \u5bf9\u8c61)\uff0c\u90a3\u4e48\u4f1a\u7acb\u5373\u6267\u884c\u8be5 `then` \u65b9\u6cd5\uff0c\u8be5 `then` \u65b9\u6cd5\u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff0c\u8fd9\u4e24\u4e2a\u53c2\u6570\u5206\u522b\u4e3a\u8fd4\u56de\u7684 `Promise` \u7684 `resolve, reject` \u65b9\u6cd5\\n\\n   ```javascript\\n   let p = Promise.resolve({\\n     then(resolve, reject) {\\n       resolve(123);\\n     },\\n   });\\n\\n   p.then((value) => {\\n     console.log(value); // 123\\n   });\\n   ```\\n\\n3. \u53c2\u6570\u4e0d\u662f\u4e0a\u9762\u4e24\u79cd\u60c5\u51b5\uff0c\u90a3\u4e48\u4f1a\u8fd4\u56de\u7684\u4e00\u4e2a `fulfilled` \u72b6\u6001\u7684 `Promise`\uff0c\u8be5 `Promise` \u4f1a\u5c06\u53c2\u6570\u4f20\u7ed9\u540e\u9762\u7684 `then`\\n\\n   ```javascript\\n   let p = Promise.resolve(\\"123\\");\\n\\n   p.then((value) => {\\n     console.log(value); // 123\\n   });\\n   ```\\n\\n#### all\\n\\n\u8be5\u65b9\u6cd5\u4e5f\u4f1a\u8fd4\u56de\u4e00\u4e2a `Promise` \u5bf9\u8c61\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a\u7531 `Promise` \u5bf9\u8c61\u7ec4\u6210\u7684\u6570\u7ec4\uff0c\u53ea\u6709\u5f53\u8be5\u6570\u7ec4\u4e2d\u7684\u6240\u6709 `Promise` \u5bf9\u8c61\u90fd\u53d8\u4e3a `fulfilled` \u72b6\u6001\u4e4b\u540e\uff0c\u8fd4\u56de\u7684 `Promise` \u5bf9\u8c61\u624d\u4f1a\u53d8\u4e3a `fulfilled` \u72b6\u6001\\n\\n```javascript\\nlet p1 = new Promise((resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"p1\\");\\n    resolve(1);\\n  }, 1000);\\n});\\n\\nlet p2 = new Promise((resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"p2\\");\\n    resolve(2);\\n  }, 2000);\\n});\\n\\nlet p3 = new Promise((resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"p3\\");\\n    resolve(3);\\n  }, 3000);\\n});\\n\\nPromise.all([p1, p2, p3]).then((results) => {\\n  console.log(results); // [ 1, 2, 3 ]\\n});\\n```\\n\\n\u5728\u4e0a\u9762\u6211\u4eec\u5b9a\u4e49\u4e09\u4e2a `Promise` \u5bf9\u8c61\uff0c\u8fd9\u4e2a\u4e09\u4e2a\u5bf9\u8c61\u5206\u522b\u5728 `1s, 2s, 3s` \u540e\u53d8\u4e3a `fulfilled`\uff0c\u6240\u4ee5\u8fd4\u56de\u7684 `Promise` \u5bf9\u8c61\u5728 `3s` \u540e\u53d8\u4e3a `fulfilled` \u72b6\u6001\uff0c\u5e76\u4e14\u4f1a\u5c06\u8fd9\u4e09\u4e2a `Promise` \u5bf9\u8c61\u5411 `resolve` \u4f20\u5165\u7684\u503c\u5f62\u6210\u6570\u7ec4\u4f20\u5165\u5230\u8fd4\u56de\u7684 `Promise` \u7684 `resolve` \u4e2d\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/202204212018472022-04-21-20-18-48.png\\" style={{ zoom: \'50%\'}}/>\\n\\n\u4e0a\u9762\u4ee3\u7801\u7684\u6267\u884c\u7ed3\u679c\u4e3a\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/202006272055gif2022-04-21-20-19-28.gif\\" style={{ zoom: \'50%\'}}/>\\n\\n#### race\\n\\n`race` \u65b9\u6cd5\u5b83\u4e5f\u4f1a\u8fd4\u56de\u4e00\u4e2a `Promise` \u5bf9\u8c61\uff0c\u540c `all` \u65b9\u6cd5\u4e00\u6837\uff0c\u5b83\u4e5f\u63a5\u53d7\u4e00\u4e2a\u7531 `Promise` \u5bf9\u8c61\u7ec4\u6210\u7684\u6570\u7ec4\uff0c\u4f46\u662f\u4e0d\u662f\u5f53\u6240\u6709\u7684 `Promise` \u5bf9\u8c61\u53d8\u4e3a `fulfilled` \u540e\uff0c\u8fd4\u56de\u7684 `Promise` \u5bf9\u8c61\u624d\u4f1a\u53d8\u4e3a `fulfilled`\uff0c\u800c\u662f\u8fd9\u4e9b `Promise` \u5bf9\u8c61\u8fdb\u884c\u7ade\u8d5b\uff0c\u5f53\u6700\u5feb\u7684\u4e00\u4e2a `Promise` \u5bf9\u8c61\u53d8\u4e3a `fulfilled` \u72b6\u6001\u65f6\uff0c\u8fd4\u56de\u7684 `Promise` \u5bf9\u8c61\u5c31\u4f1a\u53d8\u4e3a `fulfilled`\\n\\n```javascript\\nlet p1 = new Promise((resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"p1\\");\\n    resolve(1);\\n  }, 1000);\\n});\\n\\nlet p2 = new Promise((resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"p2\\");\\n    resolve(2);\\n  }, 2000);\\n});\\n\\nlet p3 = new Promise((resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"p3\\");\\n    resolve(3);\\n  }, 3000);\\n});\\n\\nPromise.race([p1, p2, p3]).then((result) => {\\n  console.log(result);\\n});\\n```\\n\\n\u5e76\u4e14\u4f1a\u5c06\u5411\u6700\u5feb\u53d8\u4e3a `fulfilled` \u72b6\u6001\u7684 `Promise` \u5bf9\u8c61\u7684 `resolve` \u4f20\u5165\u7684\u503c\u4f20\u5165\u5230\u8fd4\u56de\u7684 `Promise` \u5bf9\u8c61\u7684 `resolve` \u65b9\u6cd5\u4e2d\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/202204212020082022-04-21-20-20-09.png\\" style={{ zoom: \'50%\'}}/>\\n\\n\u6240\u4ee5\u4e0a\u9762\u7a0b\u5e8f\u7684\u6267\u884c\u7ed3\u679c\u4e3a\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/2020062721142022-04-21-20-20-53.gif\\" style={{ zoom: \'50%\'}}/>\\n\\n\u53ef\u89c1\u5f53 `p1` \u53d8\u4e3a `fulfilled` \u4e4b\u540e\uff0c\u8fd4\u56de\u7684 `Promise` \u4e5f\u53d8\u4e3a\u4e86 `fulfilled` \u72b6\u6001\uff0c\u5e76\u4e14\u62ff\u5230\u4e86\u5411 `p1` \u7684 `resolve` \u4e2d\u4f20\u5165\u7684\u503c\u3002\\n\\n## \u5b9e\u73b0 Promise\\n\\n### \u7b80\u5355\u5b9e\u73b0\\n\\n\u4e0b\u9762\u5c31\u5c06\u7b80\u5355\u5b9e\u73b0\u4e00\u4e2a `Promise`\u3002\u9996\u5148\u6211\u4eec\u8981\u660e\u786e\uff0c`Promise` \u6709\u4e09\u4e2a\u72b6\u6001\uff0c\u5206\u522b\u4e3a `pending, fulfilled, rejected` \u4e09\u4e2a\u72b6\u6001\uff0c\u521d\u59cb\u65f6\u7684 `Promise` \u662f `pending` \u72b6\u6001\uff0c\u5f53\u8c03\u7528 `resolve` \u65b9\u6cd5\u540e\u5c31\u4f1a\u53d8\u4e3a `fulfilled` \u72b6\u6001\uff0c\u5f53\u5904\u4e8e `fulfilled` \u72b6\u6001\u65f6\uff0c`then` \u4e2d\u7684\u7b2c\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u624d\u4f1a\u88ab\u6267\u884c\uff1b\u8c03\u7528 `reject` \u65b9\u6cd5\u5c31\u4f1a\u53d8\u4e3a `rejected` \u72b6\u6001\uff0c\u5f53\u5904\u4e8e `rejected` \u72b6\u6001\u65f6\uff0c`then` \u4e2d\u7684\u7b2c\u4e8c\u4e2a\u56de\u8c03\u51fd\u6570\u624d\u4f1a\u88ab\u6267\u884c\u6216\u8005 `catch` \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u624d\u4f1a\u88ab\u6267\u884c\u3002\u5e76\u4e14 `fulfilled` \u548c `rejected` \u72b6\u6001\u53ea\u80fd\u7531 `pending` \u72b6\u6001\u8f6c\u53d8\u800c\u6765\uff0c\u5e76\u4e14\u4e00\u822c\u8f6c\u53d8\u4e3a `fulfilled` \u72b6\u6001\u6216\u8005 `rejected` \u72b6\u6001\uff0c\u90a3\u4e48\u72b6\u6001\u5c31\u4e0d\u80fd\u518d\u6b21\u8fdb\u884c\u8f6c\u53d8\\n\\n```javascript\\nclass Promise {\\n  // Promise\u7684\u4e09\u4e2a\u72b6\u6001\\n  PENDING = \\"pending\\";\\n  FULFILLED = \\"fulfilled\\";\\n  REJECTED = \\"rejected\\";\\n\\n  // \u5f53\u524d\u72b6\u6001\\n  state = this.PENDING;\\n  // \u4f20\u7ed9 then \u4e2d\u56de\u8c03\u51fd\u6570\u7684\u503c\\n  value = null;\\n\\n  // \u6784\u9020\u51fd\u6570\uff0c\u63a5\u6536\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u7acb\u5373\u6267\u884c\u8be5\u51fd\u6570\u5e76\u5c06 _resolve \u548c _reject \u4f20\u5165\\n  constructor(fn) {\\n    fn(this._resolve.bind(this), this._reject.bind(this));\\n  }\\n\\n  // \u5f53\u6267\u884c\u5230 then \u65b9\u6cd5\u4f46\u8fd8\u672a\u53d8\u4e3a fulfilled \u72b6\u6001\u65f6\uff0c\u90a3\u4e48\u5c06\u5411 then \u4e2d\u4f20\u5165\u7684\u56de\u8c03\u51fd\u6570\u5148\u4fdd\u5b58\u8d77\u6765\\n  callbacks = [];\\n\\n  _resolve(value) {\\n    // \u5982\u679c\u72b6\u6001\u4e0d\u4e3a pending\uff0c\u8bf4\u660e\u72b6\u6001\u5df2\u53d1\u751f\u6539\u53d8\uff0c\u4e0d\u518d\u6267\u884c\\n    if (this.state !== this.PENDING) {\\n      return;\\n    }\\n\\n    // \u5c06\u8981\u4f20\u7ed9 then \u4e2d\u56de\u8c03\u51fd\u6570\u7684\u503c\u4fdd\u5b58\u8d77\u6765\\n    this.value = value;\\n    // \u6539\u53d8\u72b6\u6001\\n    this.state = this.FULFILLED;\\n    // \u6267\u884c\u5411 then \u4e2d\u4f20\u5165\u7684 onFulfilled \u51fd\u6570\\n    this.callbacks.forEach((callback) => callback.onFulfilled(this.value));\\n  }\\n\\n  _reject(error) {\\n    // \u8fc7\u7a0b\u540c reject\\n    if (!this.PENDING) {\\n      return;\\n    }\\n    this.value = error;\\n    this.state = this.REJECTED;\\n    this.callbacks.forEach((callback) => callback.onRejected(this.value));\\n  }\\n\\n  then(onFulfilled, onRejected) {\\n    // \u5982\u679c\u5f53\u524d\u7684\u72b6\u6001\u4e3a pending\uff0c\u90a3\u4e48\u5c06\u56de\u8c03\u51fd\u6570\u4fdd\u5b58\u5230 callbacks \u51fd\u6570\u4e2d\uff0c\u7b49\u5230\u72b6\u6001\u6539\u53d8\u65f6\u6267\u884c\\n    if (this.state === this.PENDING) {\\n      this.callbacks.push({\\n        onFulfilled,\\n        onRejected,\\n      });\\n      return;\\n    }\\n\\n    // \u5982\u679c\u72b6\u6001\u4e3a fulfilled \u72b6\u6001\uff0c\u5219\u6267\u884c onFulfilled \u65b9\u6cd5\\n    if (this.state === this.FULFILLED) {\\n      onFulfilled(this.value);\\n      return;\\n    }\\n\\n    // \u540c\u4e0a\\n    if (this.state === this.REJECTED) {\\n      onRejected(this.value);\\n      return;\\n    }\\n  }\\n}\\n```\\n\\n\u4e0a\u9762\u7684\u7a0b\u5e8f\u7684\u6ce8\u91ca\u63cf\u8ff0\u4e86\u7a0b\u5e8f\u7684\u529f\u80fd\uff0c\u76f8\u6bd4\u8fd8\u662f\u4e0d\u96be\u7406\u89e3\u7684\uff0c\u73b0\u5728\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\u662f\u5426\u6709\u6548\\n\\n```javascript\\nlet p = new Promise((resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"1s\u540e\\");\\n    resolve(1);\\n  }, 1000);\\n});\\n\\np.then((value) => {\\n  console.log(value);\\n});\\n```\\n\\n\u7ed3\u679c\u5982\u4e0b\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/2020062721452022-04-21-20-21-44.gif\\" style={{ zoom: \'50%\'}}/>\\n\\n### \u94fe\u5f0f\u8c03\u7528\\n\\n\u73b0\u5728\u6211\u4eec\u6765\u5b9e\u73b0\u94fe\u5f0f\u8c03\u7528\uff0c\u8981\u5b9e\u73b0\u94fe\u5f0f\u8c03\u7528\u5c31\u9700\u8981\u8fd4\u56de\u4e00\u4e2a `Promise`\uff0c\u6bcf\u6b21\u8c03\u7528 `then` \u65b9\u6cd5\u6211\u4eec\u90fd\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684 `Promise`\uff0c\u4fee\u6539\u5982\u4e0b\\n\\n```javascript\\n_resolve(value) {\\n  if (this.state !== this.PENDING) {\\n      return;\\n  }\\n  this.value = value;\\n  this.state = this.FULFILLED;\\n  // \u4fee\u6539\u4e86\u8fd9\u91cc\uff0c\u7531\u4e8e\u9700\u8981\u5c06 then \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u7684\u8fd4\u56de\u503c\u8fd4\u56de\uff0c\u6240\u4ee5\u4e0d\u80fd\u7b80\u5355\u7684\u8c03\u7528\\n  this.callbacks.forEach(callback => this._handle(callback));\\n}\\n\\n_reject(error) {\\n  if (!this.PENDING) {\\n      return;\\n  }\\n  this.value = error;\\n  this.state = this.REJECTED;\\n  // \u540c resolve\\n  this.callbacks.forEach(callback => this._handle(callback));\\n}\\n\\nthen(onFulfilled, onRejected) {\\n  // \u8fd4\u56de\u65b0\u7684 Promise\\n  return new Promise((resolve, reject) => {\\n    this._handle({\\n      onFulfilled,\\n      onRejected,\\n      resolve,\\n      reject\\n    })\\n  })\\n}\\n\\n_handle(callback) {\\n  // \u5982\u679c\u662f pending \u72b6\u6001\uff0c\u5c06 callback \u5ef6\u8fdf\u6267\u884c\\n  if (this.state === this.PENDING) {\\n    this.callbacks.push(callback);\\n  }\\n  if (this.state === this.FULFILLED) {\\n    // \u5982\u679c then \u65b9\u6cd5\u6ca1\u6709\u4f20\u5165 onFulFilled \u56de\u8c03\u51fd\u6570\uff0c\u90a3\u4e48\u5c06\u4e0a\u4e00\u5c42\u8fd4\u56de\u7684\u503c\u4f20\u5165\\n    if (!callback.onFulfilled) {\\n      callback.resolve(this.value);\\n      return;\\n    }\\n    // \u5982\u679c\u6709 onFulFilled \u51fd\u6570\uff0c\u90a3\u4e48\u5c06 onFulFilled \u51fd\u6570\u7684\u8fd4\u56de\u503c\u4f20\u5165\u5230\u8fd4\u56de\u7684 Promise \u5bf9\u8c61\u7684 resolve \u4e2d\\n    try {\\n      // \u7528\u6237\u4f20\u5165\u7684\u56de\u8c03\u51fd\u6570\u53ef\u80fd\u4f1a\u51fa\u9519\uff0c\u6240\u4ee5\u4f7f\u7528 try...catch \u5305\u88f9\u8d77\u6765\\n      let ret = callback.onFulfilled(this.value);\\n      callback.resolve(ret);\\n    } catch (e) {\\n      // \u5f53\u4f20\u5165\u7684\u56de\u8c03\u51fd\u6570\u51fa\u9519\u65f6\uff0cPromise \u53d8\u4e3a rejected\u72b6\u6001\\n      callback.reject(e);\\n    }\\n  }\\n  if (this.state === this.REJECTED) {\\n    if (!callback.onRejected) {\\n      callback.reject(this.value);\\n      return;\\n    }\\n    let ret = callback.onRejected(this.value);\\n    callback.reject(ret);\\n  }\\n}\\n```\\n\\n\u73b0\u5728\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\u662f\u5426\u80fd\u591f\u8fdb\u884c\u94fe\u5f0f\u8c03\u7528\\n\\n```javascript\\nlet p = new Promise((resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"1s\u540e\\");\\n    resolve(1);\\n  }, 1000);\\n});\\n\\np.then((value) => {\\n  console.log(value);\\n  return 2;\\n}).then() // \u4ec0\u4e48\u56de\u8c03\u51fd\u6570\u90fd\u6ca1\u6709\u4f20\u5165\uff0c\u4f1a\u5c06\u4e0a\u4e00\u4e2a then \u8fd4\u56de\u7684\u503c\u4f20\u5165\\n  .then((value) => {\\n    console.log(value);\\n  });\\n```\\n\\n\u4e0a\u9762\u7684\u6267\u884c\u7ed3\u679c\u4e3a\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/2020062722232022-04-21-20-22-52.gif\\" style={{ zoom: \'50%\'}}/>\\n\\n\u4e0a\u9762\u6211\u4eec\u8fd8\u8981\u6700\u540e\u4e00\u4e2a\u95ee\u9898\u6ca1\u6709\u89e3\u51b3\uff0c\u5c31\u662f\u5982\u679c `then` \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7684\u662f `Promise` \u5bf9\u8c61\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8981\u5728 `_resolve` \u5bf9\u503c\u8fdb\u884c\u5224\u65ad\uff0c\u5982\u679c\u503c\u662f `Promise` \u5bf9\u8c61\uff0c\u8bb0\u4f5c `p1`\uff0c\u90a3\u4e48 `then` \u8fd4\u56de\u7684 `Promise` \u5bf9\u8c61 `p2` \u7684 `resolve` \u65b9\u6cd5\u5e94\u5f53\u5728 `p1` \u5bf9\u8c61\u7684 `resolve` \u6267\u884c\u4e4b\u540e\u6267\u884c\u3002\u4fee\u6539 `_resolve` \u5982\u4e0b\\n\\n```javascript\\n_resolve(value) {\\n  if (this.state !== this.PENDING) {\\n      return;\\n  }\\n\\n  // \u53ea\u589e\u52a0\u4e86\u4e0b\u9762\u7684\u4ee3\u7801\\n  if (value instanceof Promise) {\\n    // \u5f53\u524d resolve \u7684\u6267\u884c\u5e94\u5f53\u5728 value \u7684 resolve \u6267\u884c\u4e4b\u540e\\n    value.then(this._resolve.bind(this), this._reject.bind(this));\\n    return;\\n  }\\n\\n  this.value = value;\\n  this.state = this.FULFILLED;\\n  this.callbacks.forEach(callback => this._handle(callback));\\n}\\n```\\n\\n\u73b0\u5728\u6211\u4eec\u6765\u9a8c\u8bc1\u4e00\u756a\\n\\n```javascript\\nlet p = new Promise((resolve) => {\\n  setTimeout(() => {\\n    console.log(\\"1s\u540e\\");\\n    resolve(1);\\n  }, 1000);\\n});\\n\\np.then((value) => {\\n  console.log(value);\\n  return new Promise((resolve) => {\\n    setTimeout(() => {\\n      console.log(\\"\u53c81s\u540e\\");\\n      resolve(2);\\n    }, 1000);\\n  });\\n}).then((value) => {\\n  console.log(value);\\n});\\n```\\n\\n\u6267\u884c\u7ed3\u679c\u4e3a\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/2020062722392022-04-21-20-23-35.gif\\" style={{ zoom: \'50%\'}}/>\\n\\n### \u539f\u578b\u65b9\u6cd5\\n\\n\u63a5\u4e0b\u6765\u7ee7\u7eed\u5b9e\u73b0 `Promise` \u5bf9\u8c61\u7684\u51e0\u4e2a\u539f\u578b\u65b9\u6cd5\uff0c\u5206\u522b\u662f `catch` \u548c `finally`\u3002`catch` \u7684\u5b9e\u73b0\u5f88\u7b80\u5355\\n\\n```javascript\\ncatch(onRejected) {\\n  return this.then(null, onRejected);\\n}\\n```\\n\\n\u63a5\u4e0b\u6765\u662f\u5b9e\u73b0 `finally` \u65b9\u6cd5\uff0c\u6700\u5bb9\u6613\u60f3\u5230\u7684\u7248\u672c\u662f\\n\\n```javascript\\nfinally(onDone) {\\n  return this.then(onDone, onDone);\\n}\\n```\\n\\n\u4e0d\u7ba1\u662f\u5904\u4e8e `fulfilled` \u7684\u72b6\u6001\u8fd8\u662f `rejected` \u7684\u72b6\u6001\uff0c`onDone` \u65b9\u6cd5\u90fd\u4f1a\u5f97\u5230\u6267\u884c\uff0c\u4f46\u662f\u4f7f\u7528\u8fd9\u6837\u7684\u65b9\u5f0f\u6709\u7f3a\u70b9\\n\\n1. `onDone` \u65b9\u6cd5\u662f\u65e0\u8bba\u5931\u8d25\u8fd8\u662f\u6210\u529f\u65f6\u90fd\u4f1a\u6267\u884c\u7684\uff0c\u6240\u4ee5\u5b83\u5e94\u8be5\u6ca1\u6709\u53c2\u6570\uff0c\u4f46\u662f\u4f7f\u7528 `then(onDone, onDone)` \u7684\u65b9\u5f0f\u5c31\u4f1a\u4f20\u5165\u53c2\u6570\\n2. \u5982\u679c `onDone` \u8fd4\u56de\u4e00\u4e2a `Promise` \u5bf9\u8c61\u7684\u8bdd\uff0c\u90a3\u4e48\u4f1a\u6539\u53d8 `finally` \u8fd4\u56de\u7684 `Promise` \u7684\u72b6\u6001\\n\\n\u5904\u4e8e\u4e0a\u8ff0\u8003\u8651\uff0c\u6211\u4eec\u4f7f\u7528\u4e0b\u9762\u7684\u5b9e\u73b0\u65b9\u5f0f\\n\\n```javascript\\nfinally(onDone) {\\n  if (typeof onDone !== \'function\') {\\n    return this.then();\\n  }\\n  // \u65e0\u8bba\u6210\u529f\u4e0e\u5426\uff0conDone() \u90fd\u4f1a\u6267\u884c\uff0c\u4e14\u4e0d\u9700\u8981\u53c2\u6570\\n  // \u53e6\u5916\u6267\u884c finally \u4e0d\u4f1a\u5f71\u54cd\u4e4b\u524d\u7684 Promise \u72b6\u6001\\n  return this.then(\\n    value => Promise.resolve(onDone()).then(() => value),\\n    error => Promise.resolve(onDone()).then(() => {throw error})\\n  );\\n}\\n```\\n\\n### \u9759\u6001\u65b9\u6cd5\\n\\n\u6700\u540e\u6765\u5b9e\u73b0 `Promise` \u7684\u9759\u6001\u65b9\u6cd5\uff0c\u9996\u5148\u5b9e\u73b0 `resolve` \u65b9\u6cd5\uff0c\u5bf9\u4e8e\u8be5\u65b9\u6cd5\u7684\u4f7f\u7528\u6211\u4eec\u5728\u7528\u6cd5\u90a3\u91cc\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u4e86\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5\u8d34\u51fa\u5b9e\u73b0\u7684\u4ee3\u7801\\n\\n```javascript\\nstatic resolve(value) {\\n  // \u5982\u679c\u4f20\u5165\u7684\u662f Promise \u5bf9\u8c61\uff0c\u76f4\u63a5\u8fd4\u56de\\n  if (value instanceof Promise) {\\n    return value;\\n  }\\n\\n  // \u5982\u679c\u4f20\u5165\u7684\u662f thenable \u5bf9\u8c61\uff0c\u5219\u7acb\u5373\u6267\u884c\u5bf9\u8c61\u7684 then\uff0c\u5e76\u5c06 resolve \u548c reject \u4f20\u5165\\n  if (value && typeof value === \'object\' && typeof value.then === \'function\') {\\n    return new Promise((resolve, reject) => value.then(resolve, reject));\\n  }\\n\\n  if (value) {\\n    // \u5982\u679c\u4e0d\u662f\u4e0a\u9762\u4e24\u79cd\u60c5\u51b5\uff0c\u5e76\u4e14 value \u5b58\u5728\uff0c\u90a3\u4e48\u76f4\u63a5\u5c06 value \u4f20\u5165 resolve\\n    return new Promise(resolve => resolve(value));\\n  } else {\\n    return new Promise(resolve => resolve());\\n  }\\n}\\n```\\n\\n`all` \u65b9\u6cd5\u5728\u4e0a\u9762\u4e5f\u4ecb\u7ecd\u8fc7\u4e86\uff0c\u53ea\u6709\u5f53\u6240\u6709\u4f20\u5165\u7684 `Promise` \u5bf9\u8c61\u90fd\u53d8\u4e3a `fulfilled` \u72b6\u6001\uff0c\u8fd4\u56de\u7684 `Promise` \u5bf9\u8c61\u624d\u4f1a\u53d8\u4e3a `fulfilled` \u72b6\u6001\uff0c\u6240\u4ee5\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u53d8\u91cf\u6765\u7edf\u8ba1\u5df2\u7ecf\u53d8\u4e3a `fulfilled` \u72b6\u6001\u7684 `Promise` \u5bf9\u8c61\u7684\u4e2a\u6570\uff0c\u5f53\u6240\u6709 `Promise` \u5bf9\u8c61\u90fd\u53d8\u4e3a `fulfilled` \u72b6\u6001\u65f6\uff0c\u6267\u884c `resolve` \u65b9\u6cd5\uff0c\u5c06\u8fd4\u56de\u7684 `Promise` \u5bf9\u8c61\u53d8\u4e3a `fulfilled` \u72b6\u6001\uff0c\u5982\u4e0b\\n\\n```javascript\\nstatic all(promises) {\\n  return new Promise((resolve, reject) => {\\n    // Promise \u5bf9\u8c61\u7684\u4e2a\u6570\\n    let itemLength = promises.length;\\n    // \u7edf\u8ba1\u5df2\u53d8\u4e3a fulfilled \u72b6\u6001\u7684 Promise \u5bf9\u8c61\u4e2a\u6570\\n    let finishedPromise = 0;\\n    // \u8fd4\u56de\u7684\u6570\u7ec4\\n    let results = Array.from({length: itemLength});\\n\\n    promises.forEach(promise => {\\n      promise.then(result => {\\n        results[finishedPromise] = result;\\n        finishedPromise++;\\n        // \u5f53\u6240\u6709\u7684 Promise \u5bf9\u8c61\u53d8\u4e3a fulfilled \u65f6\uff0c\u8fd4\u56de\u7684 Promise \u5bf9\u8c61\u72b6\u6001\u53d8\u4e3a fulfilled\\n        if (finishedPromise == itemLength) {\\n          resolve(results);\\n        }\\n      }, error => {\\n        // \u53ea\u8981\u6709\u4e00\u4e2a\u53d8\u4e3a rejected\uff0c\u90a3\u4e48\u76f4\u63a5\u53d8\u4e3a rejected \u72b6\u6001\\n        reject(error);\\n      })\\n    })\\n  })\\n}\\n```\\n\\n`race` \u65b9\u6cd5\u7684\u7528\u6cd5\u4e5f\u4ecb\u7ecd\u8fc7\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5229\u7528 `resolve` \u65b9\u6cd5\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u7684\u7279\u6027\uff0c\u6211\u4eec\u5f88\u5feb\u53ef\u4ee5\u5199\u51fa\u8fd9\u6837\u7684\u4ee3\u7801\\n\\n```javascript\\nstatic race(promises) {\\n  return new Promise((resolve, reject) => {\\n    promises.forEach(promise => {\\n      promise.then(result => {\\n        resolve(result);\\n      }, error => {\\n        reject(error);\\n      })\\n    })\\n  })\\n}\\n```\\n\\n\u7531\u4e8e `resolve` \u53ea\u4f1a\u6267\u884c\u4e00\u6b21\uff0c\u53ea\u6709\u6700\u5148\u53d8\u4e3a `fulfilled` \u72b6\u6001\u7684 `Promise` \u5bf9\u8c61\u80fd\u5c06\u5b83 `resolve` \u7684\u503c\u4f20\u5165\u3002\\n\\n### \u5b8c\u6574\u4ee3\u7801\\n\\n```javascript\\nclass Promise {\\n  PENDING = \\"pending\\";\\n  FULFILLED = \\"fulfilled\\";\\n  REJECTED = \\"rejected\\";\\n\\n  state = this.PENDING;\\n  value = null;\\n\\n  constructor(fn) {\\n    fn(this._resolve.bind(this), this._reject.bind(this));\\n  }\\n\\n  callbacks = [];\\n\\n  _resolve(value) {\\n    if (this.state !== this.PENDING) {\\n      return;\\n    }\\n\\n    if (value instanceof Promise) {\\n      value.then(this._resolve.bind(this), this._reject.bind(this));\\n      return;\\n    }\\n\\n    this.value = value;\\n    this.state = this.FULFILLED;\\n    this.callbacks.forEach((callback) => this._handle(callback));\\n  }\\n\\n  _reject(error) {\\n    if (!this.PENDING) {\\n      return;\\n    }\\n    this.value = error;\\n    this.state = this.REJECTED;\\n    this.callbacks.forEach((callback) => this._handle(callback));\\n  }\\n\\n  then(onFulfilled, onRejected) {\\n    return new Promise((resolve, reject) => {\\n      this._handle({\\n        onFulfilled,\\n        onRejected,\\n        resolve,\\n        reject,\\n      });\\n    });\\n  }\\n\\n  catch(onRejected) {\\n    return this.then(null, onRejected);\\n  }\\n\\n  finally(onDone) {\\n    if (typeof onDone !== \\"function\\") {\\n      return this.then();\\n    }\\n\\n    return this.then(\\n      (value) => Promise.resolve(onDone()).then(() => value),\\n      (error) =>\\n        Promise.resolve(onDone()).then(() => {\\n          throw error;\\n        })\\n    );\\n  }\\n\\n  _handle(callback) {\\n    if (this.state === this.PENDING) {\\n      this.callbacks.push(callback);\\n    }\\n\\n    if (this.state === this.FULFILLED) {\\n      if (!callback.onFulfilled) {\\n        callback.resolve(this.value);\\n        return;\\n      }\\n\\n      try {\\n        let ret = callback.onFulfilled(this.value);\\n        callback.resolve(ret);\\n      } catch (e) {\\n        callback.reject(e);\\n      }\\n    }\\n\\n    if (this.state === this.REJECTED) {\\n      if (!callback.onRejected) {\\n        callback.reject(this.value);\\n        return;\\n      }\\n      let ret = callback.onRejected(this.value);\\n      callback.reject(ret);\\n    }\\n  }\\n\\n  static resolve(value) {\\n    if (value instanceof Promise) {\\n      return value;\\n    }\\n\\n    if (\\n      value &&\\n      typeof value === \\"object\\" &&\\n      typeof value.then === \\"function\\"\\n    ) {\\n      return new Promise((resolve, reject) => value.then(resolve, reject));\\n    }\\n\\n    if (value) {\\n      return new Promise((resolve) => resolve(value));\\n    } else {\\n      return new Promise((resolve) => resolve());\\n    }\\n  }\\n\\n  static all(promises) {\\n    return new Promise((resolve, reject) => {\\n      let itemLength = promises.length;\\n      let finishedPromise = 0;\\n      let results = Array.from({ length: itemLength });\\n\\n      promises.forEach((promise) => {\\n        promise.then(\\n          (result) => {\\n            results[finishedPromise] = result;\\n            finishedPromise++;\\n            if (finishedPromise == itemLength) {\\n              resolve(results);\\n            }\\n          },\\n          (error) => {\\n            reject(error);\\n          }\\n        );\\n      });\\n    });\\n  }\\n\\n  static race(promises) {\\n    return new Promise((resolve, reject) => {\\n      promises.forEach((promise) => {\\n        promise.then(\\n          (result) => {\\n            resolve(result);\\n          },\\n          (error) => {\\n            reject(error);\\n          }\\n        );\\n      });\\n    });\\n  }\\n}\\n```\\n\\n## \u53c2\u8003\u6587\u7ae0\\n\\n- [\u56fe\u89e3 Promise \u5b9e\u73b0\u539f\u7406\uff08\u4e00\uff09\uff1a\u5148\u5199\u4e00\u4e2a\u57fa\u7840\u7684 Promise](https://mp.weixin.qq.com/s?__biz=MzA5NTcxOTcyMg==&mid=2247486601&idx=1&sn=54429420b0c07d518cec0f25a335c41e&chksm=90ba54cca7cddddae70a7ed7c000f0b1bc0d7c2d1c3b24f57775dc5822fc86fd9ba0c5f3ed70&scene=126&sessionid=1592905857&key=82c238abbe3b82baf9881311d259c9d04b6825a9ccae7b2a4719b98d46065f568a0db4178266ff98feff0214486915cb1af9165162e328decbc0810fb56726ef47afce6aab7d437b05ee4b92e1e2edac&ascene=1&uin=MTc3NjQ2ODM3NQ%3D%3D&devicetype=Windows+10+x64&version=6209007b&lang=zh_CN&exportkey=AXzB1RasL6jiqp0WQ45qnf4%3D&pass_ticket=x774fARNYVyp1e9yDUlfRb7wSl0izcpF0j6DFaHf0fkEHDL6jv0ElWc1SzaZ6%2B%2B1)\\n- [\u56fe\u89e3 Promise \u5b9e\u73b0\u539f\u7406\uff08\u4e8c\uff09\uff1a Promise \u94fe\u5f0f\u8c03\u7528](https://mp.weixin.qq.com/s?__biz=MzA5NTcxOTcyMg==&mid=2247486680&idx=1&sn=94ad054b685f05fbb6e37059399c9cef&chksm=90ba549da7cddd8b5c802100f0d4752587c2781797d69bf33b7f3da241b754a0c28b4250b947&scene=126&sessionid=1592905847&key=e82ba7b3cce71606954236c4df9ca857aa88e193ff96f051fc026f71c1b1ca29273ee7acb983db16e8bbaf66b5fca09e484347169ba81d069693c0bd0e0575c68bdbe3d58d3f3215e65fbb45d745e79b&ascene=1&uin=MTc3NjQ2ODM3NQ%3D%3D&devicetype=Windows+10+x64&version=6209007b&lang=zh_CN&exportkey=Af0QDGTKJ0ZZ3MXT%2BURTN9M%3D&pass_ticket=x774fARNYVyp1e9yDUlfRb7wSl0izcpF0j6DFaHf0fkEHDL6jv0ElWc1SzaZ6%2B%2B1)\\n- [\u56fe\u89e3 Promise \u5b9e\u73b0\u539f\u7406\uff08\u4e09\uff09\uff1aPromise \u539f\u578b\u65b9\u6cd5\u5b9e\u73b0](https://mp.weixin.qq.com/s?__biz=MzA5NTcxOTcyMg==&mid=2247486762&idx=1&sn=278db1c95220579a8c1a2125a65d627a&chksm=90ba556fa7cddc7902cd186b057a989d0ca1a1357ba101feb9f871985385909e104aaafd4bda&scene=126&sessionid=1592905847&key=f6dee7b9ef4ba659a75dc0797593ee3ed7a2ec7d08fcb00f6cc346c81f86fc7a61cf5067c66192cee324e7aa9577fb5657def17927abdf0ce25d2e702f369d6a2ee3a3ac2bd2e3ae501aea18372ad528&ascene=1&uin=MTc3NjQ2ODM3NQ%3D%3D&devicetype=Windows+10+x64&version=6209007b&lang=zh_CN&exportkey=AY0%2FcOOAjibVmsT%2B%2B1tYPmI%3D&pass_ticket=x774fARNYVyp1e9yDUlfRb7wSl0izcpF0j6DFaHf0fkEHDL6jv0ElWc1SzaZ6%2B%2B1)\\n- [\u56fe\u89e3 Promise \u5b9e\u73b0\u539f\u7406\uff08\u56db\uff09\uff1aPromise \u9759\u6001\u65b9\u6cd5\u5b9e\u73b0](https://mp.weixin.qq.com/s?__biz=MzA5NTcxOTcyMg==&mid=2247486839&idx=1&sn=5e9d85a70e9f85c94250a8c1c86772ca&chksm=90ba5532a7cddc24535cfc80fe892ffa34ff3a9638fbc1e9810ebab3c35784402968f9a65d44&scene=126&sessionid=1593161282&key=e82ba7b3cce71606a4cce70ca930ac7d6b61a05729ee3144ff9c5ccd0f54be407ea3ba04542163e11032e315e329bcf1536ceaf16ef408d759adda51f9d1ed57c083e30ba375fa10862d7e6705e0942d&ascene=1&uin=MTc3NjQ2ODM3NQ%3D%3D&devicetype=Windows+10+x64&version=6209007b&lang=zh_CN&exportkey=AWZmv5R1eG3cSK0W44%2F8fyM%3D&pass_ticket=uTkleeK9zg7mTbWWYlCzmyU6cReKuc7iYYllvVI7AfOrz4Zh0w9gvqjsFpKY5qNq)\\n- [Promise.all \u548c Promise.race \u6e90\u7801\u5b9e\u73b0](https://juejin.im/post/5d3f0a38f265da03bb4a81ff)"},{"id":"\u6b63\u5219\u8868\u8fbe\u5f0f","metadata":{"permalink":"/blog/\u6b63\u5219\u8868\u8fbe\u5f0f","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2020-10-07-\u6b63\u5219\u8868\u8fbe\u5f0f.mdx","source":"@site/blog/2020-10-07-\u6b63\u5219\u8868\u8fbe\u5f0f.mdx","title":"\u6b63\u5219\u8868\u8fbe\u5f0f","description":"\u5728\u5b57\u7b26\u4e32\u7684\u5904\u7406\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u8981\u8fdb\u884c\u5b57\u7b26\u4e32\u7684\u5339\u914d\uff0c\u6821\u9a8c\u7b49\u7b49\u64cd\u4f5c\u3002\u6bd4\u5982\u6821\u9a8c\u5b57\u7b26\u4e32\u7684\u683c\u5f0f\u662f\u5426\u7b26\u5408\u90ae\u7bb1\uff0c\u7535\u8bdd\u53f7\u7801\u7684\u683c\u5f0f\uff0c\u6821\u9a8c\u5bc6\u7801\u662f\u5426\u7b26\u5408\u8981\u6c42\uff0c\u5bc6\u7801\u4e2d\u662f\u5426\u5305\u542b\u6570\u5b57\u548c\u5b57\u6bcd\u7b49\u7b49\uff1b\u53c8\u6216\u8005\u5339\u914d\u5f97\u5230\u67d0\u79cd\u89c4\u5219\u7684\u5b57\u7b26\u4e32\u3002\u8fd9\u4e00\u4e9b\u64cd\u4f5c\u5982\u679c\u4f7f\u7528\u5e38\u89c4\u7684\u65b9\u6cd5\u8fdb\u884c\u5b57\u7b26\u4e32\u64cd\u4f5c\uff0c\u4f1a\u82b1\u8d39\u8f83\u5927\u7684\u4ee3\u4ef7\uff0c\u5305\u62ec\u65f6\u95f4\u548c\u7cbe\u529b\u3002","date":"2020-10-07T00:00:00.000Z","formattedDate":"2020\u5e7410\u67087\u65e5","tags":[{"label":"JavaScript","permalink":"/blog/tags/java-script"},{"label":"\u6b63\u5219\u8868\u8fbe\u5f0f","permalink":"/blog/tags/\u6b63\u5219\u8868\u8fbe\u5f0f"}],"readingTime":27.77,"hasTruncateMarker":false,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"\u6b63\u5219\u8868\u8fbe\u5f0f","authors":"xiongtao","tags":["JavaScript","\u6b63\u5219\u8868\u8fbe\u5f0f"]},"prevItem":{"title":"\u624b\u5199Promise","permalink":"/blog/\u624b\u5199Promise"},"nextItem":{"title":"\u9632\u6296\u4e0e\u8282\u6d41","permalink":"/blog/\u9632\u6296\u4e0e\u8282\u6d41"}},"content":"\u5728\u5b57\u7b26\u4e32\u7684\u5904\u7406\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u8981\u8fdb\u884c\u5b57\u7b26\u4e32\u7684\u5339\u914d\uff0c\u6821\u9a8c\u7b49\u7b49\u64cd\u4f5c\u3002\u6bd4\u5982\u6821\u9a8c\u5b57\u7b26\u4e32\u7684\u683c\u5f0f\u662f\u5426\u7b26\u5408\u90ae\u7bb1\uff0c\u7535\u8bdd\u53f7\u7801\u7684\u683c\u5f0f\uff0c\u6821\u9a8c\u5bc6\u7801\u662f\u5426\u7b26\u5408\u8981\u6c42\uff0c\u5bc6\u7801\u4e2d\u662f\u5426\u5305\u542b\u6570\u5b57\u548c\u5b57\u6bcd\u7b49\u7b49\uff1b\u53c8\u6216\u8005\u5339\u914d\u5f97\u5230\u67d0\u79cd\u89c4\u5219\u7684\u5b57\u7b26\u4e32\u3002\u8fd9\u4e00\u4e9b\u64cd\u4f5c\u5982\u679c\u4f7f\u7528\u5e38\u89c4\u7684\u65b9\u6cd5\u8fdb\u884c\u5b57\u7b26\u4e32\u64cd\u4f5c\uff0c\u4f1a\u82b1\u8d39\u8f83\u5927\u7684\u4ee3\u4ef7\uff0c\u5305\u62ec\u65f6\u95f4\u548c\u7cbe\u529b\u3002\\n\\n\u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u7528\u6765\u8868\u8fbe\u5b57\u7b26\u4e32\u7684\u89c4\u5219\uff0c\u5b83\u53ef\u4ee5\u68c0\u9a8c\u5b57\u7b26\u4e32\u662f\u5426\u7b26\u5408\u67d0\u4e2a\u7279\u5b9a\u7684\u89c4\u5219\uff0c\u6216\u8005\u5339\u914d\u5b57\u7b26\u4e32\u4e2d\u7b26\u5408\u89c4\u5219\u7684\u5b57\u7b26\uff0c\u5728\u4e00\u822c\u7684\u4f7f\u7528\u4e2d\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u4e00\u822c\u7528\u6765\u5339\u914d\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u7b26\u6216\u8005\u5b57\u7b26\u4e32\u4e2d\u7279\u5b9a\u7684\u4f4d\u7f6e\u3002\\n\\n## \u6b63\u5219\u5bf9\u8c61\\n\\n`JavaScript` \u6b63\u5219\u5bf9\u8c61\u7684\u521b\u5efa\u6709\u4e24\u79cd\u5e38\u89c1\u7684\u65b9\u6cd5\uff0c\u4e00\u662f\u4f7f\u7528 `RegExp` \u6784\u9020\u51fd\u6570\u8fdb\u884c\u521b\u5efa\uff0c\u4e8c\u662f\u4f7f\u7528\u5b57\u9762\u91cf\u7684\u65b9\u6cd5\u8fdb\u884c\u521b\u5efa\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet regex1 = new RegExp(\'hello\', \'g\');\\nlet regex2 = /hello/g;\\n```\\n\\n\u5176\u4e2d `hello` \u8868\u793a\u5b57\u7b26\u4e32\u7684\u89c4\u5219\uff0c\u7528\u6765\u5339\u914d\u5b57\u7b26\u4e32\u4e2d\u7684`\\"hello\\"`\uff0c`g` \u8868\u793a\u8fdb\u884c\u5168\u5c40\u5339\u914d(`global`)\uff0c\u50cf\u8fd9\u6837\u7684\u6807\u5fd7\u8fd8\u6709\u4e24\u4e2a\uff0c`m` \u8868\u793a\u8fdb\u884c\u591a\u884c\u5339\u914d(`multiline`)\uff0c`i` \u8868\u793a\u5ffd\u7565\u5927\u5c0f\u5199(`ignoreCase`)\uff0c\u8fd9\u4e09\u4e2a\u6807\u5fd7\u4e92\u4e0d\u51b2\u7a81\uff0c\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\uff0c\u5982\\n\\n```javascript\\nlet regex = /hello/igm;\\n```\\n\\n\u5177\u4f53\u6807\u5fd7\u7684\u4f5c\u7528\u5728\u540e\u9762\u8bb2\u89e3\u3002\u5728\u5b9e\u9645\u7684\u4f7f\u7528\u4e2d\uff0c\u6211\u4eec\u4e00\u822c\u4f1a\u4f7f\u7528\u5b57\u9762\u91cf\u7684\u5f62\u5f0f\u521b\u5efa\u6b63\u5219\u5bf9\u8c61\uff0c\u76f8\u5bf9\u4e8e\u4f7f\u7528\u6784\u9020\u51fd\u6570\uff0c\u5b57\u9762\u91cf\u7684\u521b\u5efa\u6bd4\u8f83\u7b80\u4fbf\uff0c\u4e0d\u8fc7\u5982\u679c\u9700\u8981\u52a8\u6001\u7684\u521b\u5efa\u6b63\u5219\u5bf9\u8c61\uff0c\u6216\u8005\u6839\u636e\u5b57\u7b26\u4e32\u521b\u5efa\u6b63\u5219\u5bf9\u8c61\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u6784\u9020\u51fd\u6570\u7684\u65b9\u5f0f\u3002\\n\\n### \u6b63\u5219\u5bf9\u8c61\u4e2d\u7684\u5c5e\u6027\\n\\n- `global`\uff1a\u5e03\u5c14\u503c\uff0c\u662f\u5426\u8bbe\u7f6e\u4e86 `g` \u6807\u5fd7\\n- `ignoreCase`\uff1a\u5e03\u5c14\u503c\uff0c\u662f\u5426\u8bbe\u7f6e\u4e86 `i` \u6807\u5fd7\\n- `lastIndex`\uff1a\u6574\u6570\uff0c\u4ece\u5b57\u7b26\u4e32\u7684\u67d0\u4e2a\u4f4d\u7f6e\u5f00\u59cb\u5339\u914d\uff0c\u9ed8\u8ba4\u4e3a `0`\\n- `multiline`\uff1a\u5e03\u5c14\u503c\uff0c\u662f\u5426\u8bbe\u7f6e\u4e86 `m` \u6807\u5fd7\\n- `source`\uff1a\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5b57\u7b26\u4e32\u8868\u793a\\n\\n```javascript\\nlet regex = /\\\\d{3}hello$/ig;\\n\\nconsole.log(regex.global); // true\\nconsole.log(regex.ignoreCase); // true\\nconsole.log(regex.multiline); // false\\nconsole.log(regex.lastIndex); // 0\\nconsole.log(regex.source); // \\\\d{3}hello$\\n```\\n\\n### \u6b63\u5219\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\\n\\n#### test\\n\\n`test()`\uff0c\u8be5\u65b9\u6cd5\u63a5\u6536\u4e00\u4e2a\u5b57\u7b26\u4e32\u53c2\u6570\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u7528\u6765\u5224\u65ad\u8be5\u5b57\u7b26\u4e32\u662f\u5426\u7b26\u5408\u6b63\u5219\u5bf9\u8c61\u7684\u89c4\u5219\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet regex = /hello/g;\\nlet string1 = \\"hello world\\";\\nlet string2 = \\"Hello World\\";\\nconsole.log(regex.test(string1)); // true\\nconsole.log(regex.test(string2)); // false\\n```\\n\\n#### exec\\n\\n`exec()` \u65b9\u6cd5\u662f\u7528\u6765\u6355\u83b7\u5339\u914d\u5230\u7684\u5b57\u7b26\uff0c\u8be5\u65b9\u6cd5\u63a5\u6536\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u7684\u7b2c\u4e00\u9879\u8868\u793a\u4e0e\u6574\u4e2a\u6a21\u5f0f\u5339\u914d\u7684\u5b57\u7b26\u4e32\uff0c\u7b2c\u4e8c\u9879\u8868\u793a\u7b2c\u4e00\u4e2a\u6355\u83b7\u7ec4(\u6355\u83b7\u7ec4\u7684\u6982\u5ff5\u5982\u679c\u4e0d\u61c2\uff0c\u53ef\u4ee5\u770b\u4e86\u62ec\u53f7\u7684\u4f5c\u7528\u5728\u56de\u6765\u770b)\uff0c\u7b2c\u4e09\u9879\u8868\u793a\u7b2c\u4e8c\u4e2a\u6355\u83b7\u7ec4\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u8fd4\u56de\u7684\u6570\u7ec4\u4e0e\u666e\u901a\u6570\u7ec4\u4e0d\u540c\u7684\u662f\uff0c\u8be5\u6570\u7ec4\u8fd8\u6709\u4e09\u4e2a\u5c5e\u6027\uff0c`index` \u3001 `input` \u548c `groups`\uff0c`index` \u8868\u793a\u5339\u914d\u5230\u7684\u5b57\u7b26\u5728\u539f\u59cb\u5b57\u7b26\u4e32\u4e2d\u7684\u4f4d\u7f6e\uff0c\u4ece `0` \u5f00\u59cb\uff1b`input` \u8868\u793a\u8f93\u5165\u7684\u539f\u59cb\u5b57\u7b26\u4e32\uff0c`groups` \u8868\u793a\u6355\u83b7\u7ec4\u7684\u540d\u79f0\u3002\\n\\n```javascript\\nlet regex = /(he)(ll)(o)/g;\\n\\nlet string = \\"so hello\\";\\nlet result = regex.exec(string);\\nconsole.log(result);\\n```\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/202204181203342022-04-18-12-03-35.png\\" style={{ zoom: \\"50%\\"}} />\\n\\n\u8f93\u51fa\u4e3a\\n\\n```javascript\\n[\\n  \'hello\',\\n  \'he\',\\n  \'ll\',\\n  \'o\',\\n  index: 3,\\n  input: \'so hello\',\\n  groups: undefined\\n]\\n```\\n\\n\u5982\u679c\u6b63\u5219\u5bf9\u8c61\u7684\u6807\u5fd7\u6709 `g` \u7684\u8bdd\uff0c\u90a3\u4e48\u5728\u6267\u884c `exec()` \u65b9\u6cd5\u540e\u4f1a\u6539\u53d8 `lastIndex` \u4e3a\u5339\u914d\u5b57\u7b26\u4e32\u540e\u5b57\u7b26\u7684 `index`\uff0c\u63a5\u4e0b\u6765\u518d\u6b21\u6267\u884c `exec()` \u65b9\u6cd5\u65f6\u5c06\u4f1a\u4ece `lastIndex` \u5904\u5f00\u59cb\u5339\u914d\uff0c\u5982\\n\\n```javascript\\nlet string = \\"ab abc abc\\";\\nlet regex = /ab/g;\\n\\nconsole.log(regex.lastIndex); // 0\\nregex.exec(string);\\nconsole.log(regex.lastIndex); // 2\\n\\nregex.exec(string);\\nconsole.log(regex.lastIndex); // 5\\n\\nregex.exec(string);\\nconsole.log(regex.lastIndex); // 9\\n\\nregex.exec(string); // \u5339\u914d\u4e0d\u5230\u4f1a\u8fd4\u56de null\\nconsole.log(regex.lastIndex); // \u91cd\u65b0\u53d8\u4e3a 0\\n```\\n\\n### \u6784\u9020\u51fd\u6570RegExp\u7684\u5c5e\u6027\\n\\n\u6784\u9020\u51fd\u6570 `RegExp` \u4e2d\u6709\u4e00\u4e9b\u9759\u6001\u5c5e\u6027\uff0c\u8fd9\u4e9b\u5c5e\u6027\u4f1a\u4fdd\u5b58\u6700\u8fd1\u4e00\u6b21\u6b63\u5219\u5bf9\u8c61\u64cd\u4f5c\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u5e76\u4e14\u8fd9\u4e9b\u5c5e\u6027\u6709\u4e24\u79cd\u65b9\u6cd5\u8bbf\u95ee\uff0c\u4e00\u79cd\u662f\u5177\u6709\u8bed\u4e49\u7684\u957f\u5c5e\u6027\u540d\uff0c\u4e00\u79cd\u662f\u7b80\u77ed\u7684\u77ed\u5c5e\u6027\u540d\uff0c\u5177\u4f53\u5982\u4e0b\uff1a\\n\\n- `input`\uff1a\u77ed\u5c5e\u6027\u540d\u4e3a `$_`\uff0c\u6700\u8fd1\u4e00\u6b21\u8981\u5339\u914d\u7684\u5b57\u7b26\u4e32\\n- `lastMatch`\uff1a`$&`\uff0c\u6700\u8fd1\u4e00\u6b21\u7684\u5339\u914d\u9879\\n- `leftContext`\uff1a$\\\\`\uff0c `input` \u4e2d `lastMatch` \u7684\u5de6\u8fb9\u90e8\u5206\\n- `rightContext`\uff1a`$\'`\uff0c`input` \u4e2d `lastMatch` \u7684\u53f3\u8fb9\u90e8\u5206\\n- `$1, $2, ...`\uff1a\u540e\u9762\u4ecb\u7ecd\\n\\n```javascript\\nlet regex = /hello/g;\\nlet string = \\"he hello llo\\";\\nregex.exec(string);\\n\\nconsole.log(RegExp.input); // he hello llo\\nconsole.log(RegExp.lastMatch); // hello\\nconsole.log(RegExp.leftContext); // he_ (\u4ece_\u8868\u793a\u7a7a\u683c)\\nconsole.log(RegExp.rightContext); // _llo\\n```\\n\\n## \u5b57\u7b26\u4e32\u65b9\u6cd5\\n\\n\u5728\u5b57\u7b26\u4e32\u4e2d\uff0c\u6709\u8bb8\u591a\u7684\u65b9\u6cd5\u4e5f\u662f\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u6709\u5173\u7684\uff0c\u5982 `replace`\uff0c`match`\uff0c\u4e0b\u9762\u5c31\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u3002\\n\\n### replace\\n\\n`replace()` \u65b9\u6cd5\u7684\u4f5c\u7528\u662f\u4f7f\u7528\u65b0\u7684\u5b57\u7b26\u4e32\u66ff\u6362\u5b57\u7b26\u4e32\u4e2d\u7684\u67d0\u4e9b\u5185\u5bb9\uff0c\u8be5\u65b9\u6cd5\u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u8868\u793a\u5b57\u7b26\u4e32\u4e2d\u8981\u88ab\u66ff\u6362\u7684\u5185\u5bb9\uff0c\u5b83\u53ef\u4ee5\u662f\u4e00\u4e2a\u5177\u4f53\u7684\u5b57\u7b26\u4e32\u6216\u8005\u662f\u4e00\u4e2a\u6b63\u5219\u5bf9\u8c61\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u8fd9\u4e2a\u53c2\u6570\u662f\u7528\u6765\u66ff\u6362\u7b2c\u4e00\u4e2a\u53c2\u6570\u7684\uff0c\u5982\\n\\n```javascript\\nlet string = \\"gello\\";\\nstring = string.replace(\'g\', \'h\'); // \u5c06 string \u4e2d\u7684 g \u66ff\u6362\u4e3a h\\nconsole.log(string); // hello\\n```\\n\\n```javascript\\nlet string = \\"abc\\";\\nstring = string.replace(/[ab]/g, \'#\'); // \u5c06\u5b57\u7b26\u4e32\u4e2d\u7684 a \u6216 b \u66ff\u6362\u4e3a #\\nconsole.log(string); // ##c\\n```\\n\\n\u5728\u4e0a\u9762\u4e2d\u4f7f\u7528\u4e86 `[ab]`\uff0c\u8fd9\u4e2a\u8868\u793a `a` \u6216\u8005 `b`\uff0c\u5177\u4f53\u4f1a\u5728\u5143\u5b57\u7b26\u90a3\u91cc\u8bb2\u89e3\u3002\\n\\n### match\\n\\n`match` \u65b9\u6cd5\u7684\u4f5c\u7528\u4e0e `exec` \u7684\u4f5c\u7528\u5dee\u4e0d\u591a\uff0c\u4e0d\u8fc7\u4e00\u4e2a\u662f `RegExp` \u5bf9\u8c61\u7684\u65b9\u6cd5\uff0c\u4e00\u4e2a\u662f `String` \u5bf9\u8c61\u7684\u65b9\u6cd5\u3002`match` \u65b9\u6cd5\u63a5\u6536\u4e00\u4e2a\u6b63\u5219\u5bf9\u8c61\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\uff0c\u6839\u636e\u6b63\u5219\u5bf9\u8c61\u662f\u5426\u8bbe\u7f6e\u4e86 `g` \u6807\u5fd7\uff0c\u8fd4\u56de\u7684\u7ed3\u679c\u4e5f\u4e0d\u76f8\u540c\u3002\\n\\n\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e `g` \u6807\u5fd7\uff0c\u5373\u4e0d\u4f1a\u5168\u5c40\u5339\u914d\uff0c\u53ea\u4f1a\u5339\u914d\u4e00\u6b21\uff0c\u90a3\u4e48\u5b83\u8fd4\u56de\u7684\u7ed3\u679c\u4e0e `exec` \u8fd4\u56de\u7684\u7ed3\u679c\u76f8\u540c\uff0c\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u8868\u793a\u5339\u914d\u7684\u5b57\u7b26\u4e32\uff0c\u540e\u9762\u7684\u5143\u7d20\u8868\u793a\u6355\u83b7\u7ec4\uff0c\u5e76\u4e14\u4e5f\u6709 `input`\uff0c`index`\uff0c`groups`\u7b49\u5c5e\u6027\uff0c\u8868\u793a\u7684\u542b\u4e49\u4e5f\u75db `exec`\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet string = \\"hello\\";\\nlet result = string.match(/(?<h>he)(?<l>ll)(o)/);\\nconsole.log(result);\\n```\\n\\n\u8f93\u51fa\u4e3a\\n\\n```javascript\\n[\\n  \'hello\',\\n  \'he\',\\n  \'ll\',\\n  \'o\',\\n  index: 0,\\n  input: \'hello\',\\n  groups: [Object: null prototype] { h: \'he\', l: \'ll\' }\\n]\\n```\\n\\n\u8fd9\u6b21\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8ddf\u4ee5\u5f80\u7684\u4e0d\u540c\uff0c\u8fd9\u6b21\u6211\u8bbe\u7f6e\u4e86\u6355\u83b7\u7ec4\u7684\u540d\u79f0\uff0c\u5982\\n\\n```javascript\\n(?<h>he)\\n```\\n\\n\u5373\u5c06\u6355\u83b7\u7ec4 `(he)` \u7684\u540d\u79f0\u8bbe\u7f6e\u4e3a\u4e86 `h`\uff0c\u8bbe\u7f6e\u6355\u83b7\u7ec4\u540d\u79f0\u7684\u683c\u5f0f\u5982\u4e0b\\n\\n```javascript\\n(?<\u6355\u83b7\u7ec4\u540d\u79f0>\u6355\u83b7\u7ec4\u5185\u5bb9)\\n```\\n\\n\u4e3a\u6355\u83b7\u7ec4\u8bbe\u7f6e\u540d\u79f0\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5728\u540e\u9762\u8fdb\u884c\u5f15\u7528\u3002\\n\\n\u5982\u679c\u8bbe\u7f6e\u4e86 `g` \u6807\u5fd7\uff0c\u8fd9\u65f6\u8fd4\u56de\u503c\u4e0e `exec` \u65b9\u6cd5\u5c31\u4e0d\u540c\u4e86\uff0c\u5b83\u4f1a\u5c06\u5b57\u7b26\u4e32\u4e2d\u6240\u6709\u7b26\u5408\u6b63\u5219\u8868\u8fbe\u5f0f\u89c4\u5219\u7684\u5185\u5bb9\u90fd\u5339\u914d\u51fa\u6765\uff0c\u5e76\u653e\u5165\u6570\u7ec4\u4e2d\uff0c\u5982\\n\\n```javascript\\nlet string = \\"hello\\";\\nlet re = /(?<h>he)(?<l>ll)(o)/g;\\nlet result = string.match(re);\\nconsole.log(result); // [ \'hello\' ]\\n\\nstring = \\"hello helloworld\\";\\nresult = string.match(re);\\nconsole.log(result); // [ \'hello\', \'hello\' ]\\n```\\n\\n\u8fd9\u65f6\u8bbe\u7f6e\u7684\u6355\u83b7\u7ec4\u7684\u4fe1\u606f\u5c31\u63d0\u53d6\u4e0d\u5230\u4e86\uff0c\u6240\u4ee5\u4ece\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u8bf4\uff0c`exec` \u7684\u529f\u80fd\u6bd4 `match` \u66f4\u52a0\u7684\u5f3a\u5927\uff0c\u4e0d\u8fc7 `exec` \u5e76\u4e0d\u80fd\u4e00\u6b21\u63d0\u53d6\u51fa\u5b57\u7b26\u4e32\u4e2d\u6240\u6709\u7b26\u5408\u89c4\u5219\u7684\u5185\u5bb9\uff0c\u800c\u662f\u9700\u8981\u505a\u4e00\u4e2a\u5faa\u73af\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet string = \\"hello helloworld\\";\\nlet re = /(?<h>he)(?<l>ll)(o)/g;\\nlet result;\\nlet results = new Array();\\n// \u5f53 re.exec()\u4e0d\u4e3a null \u65f6\\nwhile (result = re.exec(string)) {\\n    results.push(result[0]); // result \u4e2d\u8fd8\u5305\u542b\u4e86\u6355\u83b7\u7ec4\u7684\u4fe1\u606f\\n}\\nconsole.log(results); // [ \'hello\', \'hello\' ]\\n```\\n\\n## \u5b57\u7b26\u5339\u914d\\n\\n\u4e0a\u9762\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\u5339\u914d\u90fd\u662f\u8fdb\u884c\u7cbe\u786e\u7684\u5339\u914d\uff0c\u5982 `/hello/`\uff0c\u5339\u914d\u5b57\u7b26\u4e32\u4e2d\u7684 `hello` \u5185\u5bb9\uff0c\u8fd9\u6837\u6211\u4eec\u6839\u672c\u65e0\u6cd5\u9886\u4f1a\u5230\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5f3a\u5927\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u6b63\u662f\u5f3a\u5927\u5728\u5b83\u6a21\u7cca\u5339\u914d\u7684\u80fd\u529b\uff0c\u6bd4\u5982\u6211\u4eec\u5728 `Windows` \u4e2d\u8fdb\u884c\u6587\u4ef6\u67e5\u627e\uff0c\u6709\u65f6\u6211\u4eec\u4e0d\u8bb0\u5f97\u6587\u4ef6\u7684\u5177\u4f53\u540d\u79f0\uff0c\u6bd4\u5982\u5fd8\u4e86\u67d0\u4e2a\u5b57\u6bcd\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u4f1a\u7528 `.` \u53bb\u8868\u793a\u4efb\u610f\u7684\u5b57\u6bcd\u53bb\u8fdb\u884c\u67e5\u627e\u3002\u73b0\u5728\u6211\u4eec\u5c31\u6765\u8bb2\u8bb2\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u7cca\u5339\u914d\u7684\u80fd\u529b\u3002\\n\\n### \u5b57\u7b26\u7ec4\\n\\n\u5728\u8fdb\u884c\u5339\u914d\u7684\u65f6\u5019\uff0c\u5982\u679c\u6211\u4eec\u4e0d\u786e\u5b9a\u67d0\u4e2a\u4f4d\u7f6e\u7684\u5b57\u7b26\u662f\u4ec0\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8868\u793a\u7279\u5b9a\u542b\u4e49\u7684\u5b57\u7b26\u6765\u5360\u636e\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u6bd4\u5982 `[abc]` \u8868\u793a\u8fd9\u4e2a\u4f4d\u7f6e\u662f `a`\uff0c`b`\uff0c`c` \u4e2d\u7684\u67d0\u4e2a\u5b57\u7b26\u3002\u5982\u679c\u6211\u4eec\u60f3\u8868\u793a\u8fd9\u4e2a\u5b57\u7b26\u662f\u5c0f\u5199\u5b57\u6bcd\uff0c\u6309\u7167\u4e0a\u9762\u7684\u5199\u6cd5\uff0c\u4f60\u53ef\u80fd\u4f1a\u8fd9\u4e48\u5199 `[abcdefghijklmnopqrstuvwxyz]`\uff0c\u8fd9\u6837\u7684\u5199\u6cd5\u6709\u70b9\u53cd\u4eba\u7c7b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8303\u56f4\u8868\u793a\u6cd5\u6765\u4ee3\u66ff\u4e0a\u9762\u7684\u5199\u6cd5\uff0c\u5982 `[a-z]` \u7684\u5199\u6cd5\u5c31\u8868\u793a\u6240\u6709\u7684\u5c0f\u5199\u5b57\u6bcd\uff0c\u540c\u7406 `[A-Z]` \u5c31\u8868\u793a\u6240\u6709\u7684\u5927\u5199\u5b57\u6bcd\uff0c`[0-9]` \u5c31\u8868\u793a\u6570\u5b57\uff0c`[0-9a-zA-Z]` \u8868\u793a\u8fd9\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u662f\u6570\u5b57\uff0c\u5c0f\u5199\u5b57\u6bcd\uff0c\u5927\u5199\u5b57\u6bcd\u3002\u5982\u4e0b\\n\\n```java\\nlet re = /[a-zA-Z0-9]/;\\nconsole.log(re.test(\'0\')); // true\\nconsole.log(re.test(\'s\')); // true\\nconsole.log(re.test(\'S\')); // true\\nconsole.log(re.test(\'?\')); // false\\n```\\n\\n\u6211\u4eec\u53ef\u4ee5\u5728 `[]` \u4e2d\u52a0\u5165 `^` \u8868\u793a\u53d6\u53cd\uff0c\u5982 `[^0-9]` \u8868\u793a\u975e\u6570\u5b57\uff0c\u5373\u5b83\u53ef\u4ee5\u5339\u914d\u6240\u6709\u7684\u975e\u6570\u5b57\\n\\n```javascript\\nlet re = /[^0-9]/;\\nconsole.log(re.test(\\"2\\")); // false\\nconsole.log(re.test(\\"a\\")); // true\\nconsole.log(re.test(\\"?\\")); // true\\n```\\n\\n\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528**\u5143\u5b57\u7b26**\u6765\u5360\u636e\u4f4d\u7f6e\uff0c\u6bd4\u5982 `\\\\d` \u5c31\u4ee3\u8868\u6570\u5b57\uff0c\u5b83\u7684\u4f5c\u7528\u4e0e `[0-9]` \u662f\u4e00\u6837\u7684\uff0c\u5e38\u89c1\u7684\u5143\u5b57\u7b26\u5982\u4e0b\u6240\u793a(\u4e0d\u5305\u542b\u8868\u793a\u4f4d\u7f6e\u7684\u5143\u5b57\u7b26\uff0c\u8868\u793a\u4f4d\u7f6e\u7684\u5143\u5b57\u7b26\u5728\u540e\u9762\u4ecb\u7ecd)\\n\\n| \u5143\u5b57\u7b26 | \u542b\u4e49                                                |\\n| ------ | --------------------------------------------------- |\\n| `\\\\d`   | \u8868\u793a\u6570\u5b57                                            |\\n| `\\\\s`   | \u8868\u793a\u7a7a\u767d\u5b57\u7b26\uff0c\u5305\u62ec\u7a7a\u683c\uff0c\u56de\u8f66\uff0c\u5236\u8868\u7b26\u7b49\u7b49            |\\n| `\\\\w`   | \u8868\u793a\u6570\u5b57\uff0c\u5927\u5c0f\u5199\u5b57\u6bcd\u548c\u4e0b\u5212\u7ebf\uff0c\u76f8\u5f53\u4e8e `[0-9a-zA-Z_]` |\\n| `.`    | \u8868\u793a\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26                                    |\\n\\n\u6765\u770b\u51e0\u4e2a\u4f8b\u5b50\\n\\n```javascript\\n// \u8868\u793a\u6570\u5b57\\nlet re1 = /\\\\d/;\\nconsole.log(re1.test(\\"2\\")); // true\\n\\n// \u7a7a\u767d\u5b57\u7b26\\nlet re2 = /\\\\s/;\\nconsole.log(re2.test(\\" \\")); // true\\nconsole.log(re2.test(\\"\\\\t\\")); // true\\nconsole.log(re2.test(\\"\\\\n\\")); // true\\n\\n// \u8868\u793a\u5927\u5c0f\u5199\u5b57\u6bcd\uff0c\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\\nlet re3 = /\\\\w/;\\nconsole.log(re3.test(\\"2\\")); // true\\nconsole.log(re3.test(\\"a\\")); // true\\nconsole.log(re3.test(\\"A\\")); // true\\nconsole.log(re3.test(\\"_\\")); // true\\n```\\n\\n\u4e0e\u5728 `[]` \u4e2d\u52a0\u5165 `^`\u8868\u793a\u53d6\u53cd\uff0c\u4e0a\u9762\u7684\u5143\u5b57\u7b26\u4e5f\u6709\u5bf9\u5e94\u7684\u5143\u5b57\u7b26\u8868\u793a\u53d6\u53cd\u7684\u6982\u5ff5\\n\\n| \u5143\u5b57\u7b26 | \u542b\u4e49                         |\\n| ------ | ---------------------------- |\\n| `\\\\D`   | \u4e0e `\\\\d` \u76f8\u53cd\uff0c\u8868\u793a\u975e\u6570\u5b57     |\\n| `\\\\S`   | \u4e0e `\\\\s` \u76f8\u53cd\uff0c\u8868\u793a\u975e\u7a7a\u767d\u5b57\u7b26 |\\n| `\\\\W`   | \u4e0e `\\\\w` \u76f8\u53cd\uff0c\u8868\u793a\u975e\u5355\u8bcd     |\\n\\n```javascript\\nlet re1 = /\\\\D/;\\nconsole.log(re1.test(\\"2\\")); // false\\nconsole.log(re1.test(\\"\\\\n\\")); // true\\n\\nlet re2 = /\\\\S/;\\nconsole.log(re2.test(\\" \\")); // false\\nconsole.log(re2.test(\\"9\\")); // true\\n\\nlet re3 = /\\\\W/;\\nconsole.log(re3.test(\\"0\\")); // false\\nconsole.log(re3.test(\\"\\\\t\\")); // true\\n```\\n\\n### \u91cf\u8bcd\\n\\n\u73b0\u5728\u6211\u4eec\u5047\u8bbe\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u53bb\u5339\u914d\u7535\u8bdd\u53f7\u7801\uff0c\u5047\u8bbe\u7535\u8bdd\u53f7\u7801\u5c31\u662f `11` \u4f4d\u6570\u5b57\uff0c\u6240\u4ee5\u5199\u51fa\u6765\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u8fd9\u6837\u7684 `\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d`\uff0c\u8fd9\u79cd\u5199\u6cd5\u4e5f\u76f8\u5f53\u7684\u53cd\u4eba\u7c7b\uff0c\u4e0d\u4ec5\u96be\u8bfb(\u9700\u8981\u4e00\u4e2a\u4e2a\u6570\u624d\u77e5\u9053\u6709\u591a\u5c11\u4e2a\u6570)\uff0c\u800c\u4e14\u5199\u8d77\u6765\u4e5f\u9ebb\u70e6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u91cf\u8bcd\u6765\u7b80\u5199\u4e0a\u9762\u7684\u8868\u8fbe\u5f0f\uff0c\u5982 `\\\\d{11}` \u5c31\u8868\u793a `\\\\d` \u8fde\u7eed\u51fa\u73b0 `11` \u6b21\uff0c\u5e38\u89c1\u7684\u91cf\u8bcd\u5199\u6cd5\u5982\u4e0b\\n\\n| \u91cf\u8bcd    | \u542b\u4e49                                              |\\n| ------- | ------------------------------------------------- |\\n| `{n}`   | \u8868\u793a\u8fde\u7eed\u51fa\u73b0 `n` \u6b21                               |\\n| `{m,n}` | \u8868\u793a\u8fde\u7eed\u51fa\u73b0 `m-n`\uff0c\u6700\u5c11\u51fa\u73b0 `m`\uff0c\u6700\u591a\u51fa\u73b0 `n` \u6b21 |\\n| `{n,}`  | \u8868\u793a\u8fde\u7eed\u51fa\u73b0\u6700\u5c11 `n` \u6b21(\u5305\u62ec `n` \u6b21)              |\\n| `*`     | \u8868\u793a\u8fde\u7eed\u51fa\u73b0**\u4efb\u610f**\u591a\u6b21                          |\\n| `+`     | \u8868\u793a\u8fde\u7eed\u51fa\u73b0 `1` \u6b21\u6216 `1` \u6b21\u4ee5\u4e0a                  |\\n| `?`     | \u8868\u793a\u51fa\u73b0 `0` \u6b21\u6216 `1` \u6b21                          |\\n\\n```javascript\\n// \u5339\u914d\u8fde\u7eed\u51fa\u73b0\u7684 5 \u4f4d\u6570\u5b57\\nlet re = /\\\\d{5}/g;\\nlet string = \\"123 1234 12345 654321\\";\\nconsole.log(string.match(re)); // [ \'12345\', \'65432\' ]\\n```\\n\\n```javascript\\n// \u5339\u914d\u8fde\u7eed\u51fa\u73b0\u7684 2-3 \u4f4d\u6570\u5b57\\nlet re = /\\\\d{2,3}/g;\\nlet string = \\"12 123 1234\\";\\nconsole.log(string.match(re)); // [ \'12\', \'123\', \'123\' ]\\n```\\n\\n```javascript\\n// \u5339\u914d\u8fde\u7eed\u51fa\u73b0 4 \u4f4d\u53ca 4 \u4f4d\u4ee5\u4e0a\u7684\u6570\u5b57\\nlet re = /\\\\d{4,}/g;\\nlet string = \\"12 123 1234 12345\\";\\nconsole.log(string.match(re)); // [ \'1234\', \'12345\' ]\\n```\\n\\n```javascript\\n// b \u53ef\u4ee5\u51fa\u73b0\u4efb\u610f\u6b21\\nlet re = /ab*c/g;\\nlet string = \\"ac abc abbc abbbc\\";\\nconsole.log(string.match(re)); // [ \'ac\', \'abc\', \'abbc\', \'abbbc\' ]\\n```\\n\\n```javascript\\n// b \u51fa\u73b0 1 \u6b21\u6216 1 \u6b21\u4ee5\u4e0a\\nlet re = /ab+c/g;\\nlet string = \\"ac abc abbc abbbc\\";\\nconsole.log(string.match(re)); // [ \'abc\', \'abbc\', \'abbbc\' ]\\n```\\n\\n```javascript\\n// b \u51fa\u73b0 0 \u6b21\u6216 1 \u6b21\\nlet re = /ab?c/g;\\nlet string = \\"ac abc abbc abbbc\\";\\nconsole.log(string.match(re));\\n```\\n\\n### \u8d2a\u5a6a\u5339\u914d\u4e0e\u60f0\u6027\u5339\u914d\\n\\n\u6240\u8c13\u7684\u8d2a\u5a6a\u5339\u914d\u5c31\u662f\u5c3d\u53ef\u80fd\u7684\u591a\u5339\u914d\uff0c\u5982\\n\\n```javascript\\nlet re = /ab+/g;\\nlet string = \\"abbbb\\";\\nconsole.log(string.match(re)); // [ \'abbbb\' ]\\n```\\n\\n\u660e\u660e\u5339\u914d `ab` \u4e5f\u53ef\u4ee5\uff0c\u4f46\u662f\u5b83\u4f1a\u5c3d\u53ef\u80fd\u591a\u7684\u5339\u914d\uff0c\u8fd9\u5c31\u662f\u8d2a\u5a6a\u6a21\u5f0f\uff0c\u4e0e\u6b64\u76f8\u5bf9\u7684\u662f\u60f0\u6027\u5339\u914d\uff0c\u60f0\u6027\u5339\u914d\u5c31\u662f\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u60c5\u51b5\u4e0b\u4f1a\u5c3d\u53ef\u80fd\u7684\u5c11\u5339\u914d\uff0c\u5982\u4e0a\u4f8b\u5c31\u4f1a\u5339\u914d `ab`\uff0c\u5728\u9ed8\u8ba4\u7684\u60c5\u51b5\u4e0b\u662f\u8d2a\u5a6a\u5339\u914d\uff0c\u8981\u4f7f\u7528\u60f0\u6027\u5339\u914d\u5c31\u8981\u4f7f\u7528\u60f0\u6027\u91cf\u8bcd\\n\\n| \u8d2a\u5a6a    | \u60f0\u6027     |\\n| ------- | -------- |\\n| `+`     | `+?`     |\\n| `*`     | `*?`     |\\n| `?`     | `??`     |\\n| `{n,m}` | `{n,m}?` |\\n| `{n,}`  | `{n,}?`  |\\n\\n```javascript\\nlet re = /ab+?/g;\\nlet string = \\"abbbb\\";\\nconsole.log(string.match(re)); // [ \'ab\' ]\\n```\\n\\n\u73b0\u5728\u8003\u8651\u6839\u636e `html` \u5b57\u7b26\u4e32\u83b7\u5f97\u67d0 `id` \u5c5e\u6027\uff0c\u5982 `<div id=\\"container\\" class=\\"active\\"></div>`\uff0c\u5982\u679c\u6211\u4eec\u4f7f\u7528\u8d2a\u5a6a\u5339\u914d\u7684\u8bdd\uff0c\u8003\u8651\u8fd9\u6837\u7684\u5339\u914d\u89c4\u5219 `/id=\\".*\\"/`\uff0c\u90a3\u4e48\u6355\u83b7\u5230\u7684\u5e76\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\\n\\n```javascript\\nlet re = /id=\\".*\\"/;\\nlet string = \\"<div id=\\\\\\"container\\\\\\" class=\\\\\\"active\\\\\\"></div>\\";\\nconsole.log(re.exec(string)[0]); // id=\\"container\\" class=\\"active\\"\\n```\\n\\n\u6211\u4eec\u53d1\u73b0\u5339\u914d\u5230\u7684\u662f `id=\\"container\\" class=\\"active\\"`\uff0c\u56e0\u4e3a\u5728\u8d2a\u5a6a\u6a21\u5f0f\u4e0b\u518d\u7b26\u5408\u6761\u4ef6\u7684\u60c5\u51b5\u4e0b\u4f1a\u5c3d\u53ef\u80fd\u591a\u7684\u5339\u914d\uff0c\u6240\u4ee5\u4f1a\u76f4\u63a5\u5339\u914d\u5230\u6700\u540e\u4e00\u4e2a\u53cc\u5f15\u53f7\uff0c\u89e3\u51b3\u529e\u6cd5\u6709\u4e24\u79cd\uff0c\u5176\u4e2d\u7b80\u5355\u7684\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u4f7f\u7528\u60f0\u6027\u5339\u914d\\n\\n```javascript\\nlet re = /id=\\".*?\\"/;\\nlet string = \\"<div id=\\\\\\"container\\\\\\" class=\\\\\\"active\\\\\\"></div>\\";\\nconsole.log(re.exec(string)[0]); // id=\\"container\\"\\n```\\n\\n\u53e6\u4e00\u79cd\u529e\u6cd5\u5c31\u6bd4\u8f83 `trick`\uff0c\u6211\u89c9\u5f97\u53ea\u53ef\u610f\u4f1a\uff0c\u96be\u4ee5\u8a00\u4f20\\n\\n```javascript\\nlet re = /id=\\"[^\\"]*\\"/;\\nlet string = \\"<div id=\\\\\\"container\\\\\\" class=\\\\\\"active\\\\\\"></div>\\";\\nconsole.log(re.exec(string)[0]); // id=\\"container\\"\\n```\\n\\n\u4ed4\u7ec6\u4f53\u4f1a\u4e0a\u9762\u7684\u5199\u6cd5\u5427\uff0c\u6211\u89c9\u5f97\u5f88\u597d\u7528\uff0c\u6bd4\u5982\u83b7\u5f97\u67d0\u6807\u7b7e\u7684\u6807\u7b7e\u540d\\n\\n```javascript\\nlet re = /<[^>]*>/;\\nlet string = \\"<div></div>\\";\\nconsole.log(re.exec(string)[0]); // <div>\\n```\\n\\n### \u5206\u652f\\n\\n\u6709\u65f6\u5019\u6211\u4eec\u9700\u8981\u5728\u591a\u4e2a\u5206\u652f\u4e4b\u95f4\u8fdb\u884c\u9009\u62e9\uff0c\u6bd4\u5982\u5339\u914d\u5341\u516d\u8fdb\u5236\u8868\u793a\u7684\u989c\u8272\uff0c\u6709\u4e24\u79cd\u8868\u793a\uff0c\u4e00\u79cd\u662f `#F4E242` \u516d\u4f4d\u7684\uff0c\u4e00\u79cd\u662f\u7b80\u5199\u7684 `#FFF` \u4e09\u4f4d\u8868\u793a\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 `|` \u6765\u8868\u793a\u6216\u7684\u5173\u7cfb\\n\\n```javascript\\nlet regex = /#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})/g;\\nlet string1 = \\"#FFF\\";\\nlet string2 = \\"#F34E23\\"\\nconsole.log(string1.match(regex)); // [ \'#FFF\' ]\\nconsole.log(string2.match(regex)); // [ \'#F34E23\' ]\\n```\\n\\n## \u62ec\u53f7\u7684\u4f5c\u7528\\n\\n### \u5206\u7ec4\u4e0e\u5206\u652f\\n\\n\u5047\u8bbe\u6211\u4eec\u8981\u5339\u914d `I love Java` \u548c `I love C` \u8fd9\u4e24\u53e5\u8bdd\uff0c\u4f60\u53ef\u80fd\u4f1a\u5199\u51fa\u8fd9\u6837\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\\n\\n```javascript\\n/I love Java|C/\\n```\\n\\n\u4f46\u662f\u8fd9\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u8868\u793a\u7684\u662f `I love Java` \u6216\u8005 `C` \u800c\u4e0d\u662f `I love C`\uff0c\u6b63\u786e\u7684\u5199\u6cd5\u5e94\u8be5\u662f\u8fd9\u6837\\n\\n```javascript\\n/I love (Java|C)/\\n```\\n\\n`Java` \u548c `C` \u9009\u5176\u4e00\u3002\\n\\n### \u6355\u83b7\u6570\u636e\\n\\n\u5047\u8bbe\u6211\u4eec\u8981\u5339\u914d\u4e00\u4e2a\u683c\u5f0f\u4e3a `yyyy-mm-dd` \u683c\u5f0f\u7684\u65e5\u671f\uff0c\u5e76\u4e14\u5e0c\u671b\u83b7\u5f97\u5e74\u6708\u65e5\uff0c\u90a3\u4e48\u53ef\u80fd\u4f1a\u8fd9\u4e48\u5199\\n\\n```javascript\\nlet re = /\\\\d{4}-\\\\d{2}-\\\\d{2}/;\\nlet string = \\"2020-05-27\\";\\nlet result = re.exec(string)[0]; // 2020-05-27\\nlet results = result.split(\\"-\\");\\nconsole.log(\\"year:\\" + results[0]); // year:2020\\nconsole.log(\\"month:\\" + results[1]); // month:05\\nconsole.log(\\"day:\\" + results[2]); // day:27\\n```\\n\\n\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u62ec\u53f7\u6765\u6355\u83b7\u6570\u636e\uff0c\u5bf9\u4e8e\u88ab\u62ec\u53f7\u5305\u8d77\u6765\u7684\u6570\u636e\uff0c\u5176\u5339\u914d\u7684\u5185\u5bb9\u4f1a\u88ab\u63d0\u53d6\u51fa\u6765\uff0c\u6dfb\u52a0\u5230\u8fd4\u56de\u7684\u6570\u7ec4\u4e2d\uff0c\u5982\\n\\n```javascript\\nlet re = /(\\\\d{4})-(\\\\d{2})-(\\\\d{2})/;\\n\\nlet string = \\"2020-05-27\\";\\nlet result = re.exec(string);\\n\\nconsole.log(\\"year:\\" + result[1]); // \u7b2c\u4e00\u4e2a\u6355\u83b7\u7ec4 \\\\d{4} \u5339\u914d\u7684\u5185\u5bb9\\nconsole.log(\\"month:\\" + result[2]); // \u7b2c\u4e8c\u4e2a\u6355\u83b7\u7ec4 \\\\d{2} \u5339\u914d\u7684\u5185\u5bb9\\nconsole.log(\\"day:\\" + result[3]); // \u7b2c\u4e09\u4e2a\u6355\u83b7\u7ec4 \\\\d{2} \u5339\u914d\u7684\u5185\u5bb9\\n```\\n\\n\u4e0a\u9762\u6211\u4eec\u5bf9\u5e74\u6708\u65e5\u7684\u89c4\u5219\u4f7f\u7528\u62ec\u53f7\u5305\u4e86\u8d77\u6765\uff0c\u5728\u8fdb\u884c\u5339\u914d\u65f6\uff0c\u5bf9\u5e94\u88ab\u5339\u914d\u5230\u7684\u6570\u636e\u4f1a\u6dfb\u52a0\u5230\u6570\u7ec4\u4e2d\uff0c\u5728\u4ecb\u7ecd `exec` \u65b9\u6cd5\u65f6\uff0c\u5176\u8fd4\u56de\u7684\u6570\u7ec4\uff0c\u7b2c\u4e00\u4e2a\u5143\u7d20\u8868\u793a\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\uff0c\u540e\u9762\u7684\u5143\u7d20\u8868\u793a\u6355\u83b7\u7ec4(\u62ec\u53f7\u5305\u8d77\u6765)\u4e2d\u6355\u83b7\u7684\u5185\u5bb9\u3002\\n\\n#### RegExp\u7684\u5c5e\u6027$1...\\n\\n\u9664\u4e86\u53ef\u4ee5\u6839\u636e\u8fd4\u56de\u7684\u6570\u7ec4 `result` \u6765\u5f97\u5230\u6355\u83b7\u7684\u6570\u636e\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5728\u4e0a\u9762\u63d0\u8fc7\u4e00\u5634\u7684 `RegExp` \u6784\u9020\u51fd\u6570\u7684\u5c5e\u6027 `$1, $2, $3 ...` \u7b49\u7b49\u6765\u83b7\u5f97\u6240\u6355\u83b7\u7684\u5185\u5bb9\uff0c\u5176\u4e2d `$1` \u8868\u793a\u7b2c\u4e00\u4e2a\u6355\u83b7\u7ec4\u6240\u5339\u914d\u7684\u5185\u5bb9\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet re = /(\\\\d{4})-(\\\\d{2})-(\\\\d{2})/;\\n\\nlet string = \\"2020-05-27\\";\\nlet result = re.exec(string);\\n\\nconsole.log(\\"year:\\" + RegExp.$1); // year:2020\\nconsole.log(\\"month:\\" + RegExp.$2); // month:05\\nconsole.log(\\"day:\\" + RegExp.$3); // day:27\\n```\\n\\n\u6bcf\u6b21\u5728\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\u5339\u914d\u65f6\uff0c`RegExp` \u4e2d\u7684 `$1, $2, $3 ...` \u4e5f\u4f1a\u76f8\u5e94\u7684\u66f4\u65b0\u3002\\n\\n#### \u62ec\u53f7\u5d4c\u5957\\n\\n\u73b0\u5728\u8003\u8651\u5982\u679c\u62ec\u53f7\u6709\u5d4c\u5957\u7684\u60c5\u51b5\uff0c\u6bd4\u5982\u4e0a\u9762\u65e5\u671f\u683c\u5f0f\u6355\u83b7\u66f4\u7cbe\u51c6\u7684\u8868\u8fbe\u5f0f\\n\\n```javascript\\n/(\\\\d{4})-((0[1-9])|(1[0-2]))-((0[1-9])|([1-2]\\\\d)|(3[0-1]))/\\n```\\n\\n\u4e0a\u9762\u62ec\u53f7\u5d4c\u5957\u7684\u5f88\u590d\u6742\uff0c\u5728\u539f\u7406\u4e0a\uff0c\u88ab\u62ec\u53f7\u5305\u8d77\u6765\u7684\u89c4\u5219\u6240\u5339\u914d\u7684\u5185\u5bb9\u90fd\u4f1a\u88ab\u6355\u83b7\uff0c\u90a3\u4e48\u5d4c\u5957\u5e26\u6765\u7684\u95ee\u9898\u5c31\u662f\uff0c\u6355\u83b7\u7684\u987a\u5e8f\u54ea\u4e2a\u5728\u524d\uff0c\u54ea\u4e2a\u5728\u540e\uff0c\u5176\u5b9e\u4e5f\u5f88\u7b80\u5355\uff0c\u6839\u636e\u5de6\u62ec\u53f7\u6765\uff0c\u6bd4\u5982\u4e0a\u5f0f\u4e2d\u7684\u6355\u83b7\u987a\u5e8f\u4e3a\\n\\n1. `(\\\\d{4})`\\n2. `((0\\\\d)|(1[0-2]))`\\n3. `(0\\\\d)`\\n4. `(1[0-2])`\\n5. `((0[1-9])|([1-2]\\\\d)|(3[0-1]))`\\n6. `(0[1-9])`\\n7. `([1-2]\\\\d)`\\n8. `(3[0-1])`\\n\\n\u6240\u4ee5\u5982\u679c\u4f7f\u7528\u4e0a\u9762\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\u6355\u83b7\u5f97\u5230\u5e74\u6708\u65e5\u7684\u4fe1\u606f\uff0c\u6839\u636e\u5206\u6790\u5e74\u662f\u7b2c\u4e00\u6355\u83b7\u7ec4\uff0c\u6708\u662f\u7b2c\u4e8c\u6355\u83b7\u7ec4\uff0c\u65e5\u662f\u7b2c\u4e94\u6355\u83b7\u7ec4\\n\\n```javascript\\nlet re = /(\\\\d{4})-((0[1-9])|(1[0-2]))-((0[1-9])|([1-2]\\\\d)|(3[0-1]))/;\\nlet date = \\"2020-05-27\\";\\n\\nlet result = re.exec(date);\\n\\nconsole.log(result[1], result[2], result[5]); // 2020 05 27\\n```\\n\\n\u7531\u4e8e\u65e0\u7528\u7684\u6355\u83b7\u7ec4\u592a\u591a\uff0c\u5bfc\u81f4\u60f3\u8981\u63d0\u53d6\u5305\u542b\u4fe1\u606f\u7684\u6355\u83b7\u7ec4\u83b7\u53d6\u56f0\u96be\uff0c\u5176\u5b9e\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u91cc\u9762\u7684\u5927\u591a\u6570\u62ec\u53f7\u4e3b\u8981\u662f\u4e3a\u5206\u652f\u505a\u51c6\u5907\u7684\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u6355\u83b7\u7ec4\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e0d\u6355\u83b7\uff0c\u4ec5\u4ec5\u4f5c\u4e3a\u5206\u652f\u4f7f\u7528\uff0c\u6211\u4eec\u5728\u62ec\u53f7\u91cc\u9762\u7684\u524d\u65b9\u52a0\u5165 `?:` \u8868\u793a\u8be5\u62ec\u53f7\u5339\u914d\u7684\u5185\u5bb9\u4e0d\u8fdb\u884c\u6355\u83b7\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet re = /(\\\\d{4})-((?:0[1-9])|(?:1[0-2]))-((?:0[1-9])|(?:[1-2]\\\\d)|(?:3[0-1]))/;\\nlet date = \\"2020-05-27\\";\\n\\nlet result = re.exec(date);\\n\\nconsole.log(result[1], result[2], result[3]); // 2020 05 27\\n```\\n\\n\u5982\u679c\u4f5c\u4e3a\u5206\u652f\u7684\u62ec\u53f7\u592a\u591a\uff0c\u4e3a\u6bcf\u4e00\u4e2a\u5206\u652f\u6dfb\u52a0 `?:` \u4e5f\u6bd4\u8f83\u8d39\u529b\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u7ed9\u5305\u542b\u4fe1\u606f\u7684\u6355\u83b7\u7ec4\u547d\u540d\uff0c\u547d\u540d\u7684\u65b9\u6cd5\u5728\u4e0a\u9762\u6709\u63d0\u5230\u8fc7\\n\\n```javascript\\nlet re = /(?<year>\\\\d{4})-(?<month>(0[1-9])|(1[0-2]))-(?<day>(0[1-9])|([1-2]\\\\d)|(3[0-1]))/;\\nlet date = \\"2020-05-27\\";\\n\\nlet result = re.exec(date);\\nlet groups = result.groups;\\n\\nconsole.log(groups.year, groups.month, groups.day); // 2020 05 27\\n```\\n\\n\u901a\u8fc7\u7ed9\u6355\u83b7\u7ec4\u547d\u540d\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7684\u901a\u8fc7 `groups` \u5bf9\u8c61\u5f97\u5230\u60f3\u8981\u7684\u6570\u636e\u3002\\n\\n### \u53cd\u5411\u5f15\u7528\\n\\n\u73b0\u5728\u518d\u6b21\u8003\u8651\u5339\u914d\u65e5\u671f\uff0c\u5df2\u77e5\u4e0b\u9762\u8fd9\u4e09\u79cd\u65e5\u671f\u683c\u5f0f\u90fd\u53ef\u4ee5\\n\\n```javascript\\n2017-02-12\\n2017 02 12\\n2017/02/12\\n```\\n\\n\u6240\u4ee5\u4f60\u53ef\u80fd\u4f1a\u5199\u51fa\u8fd9\u6837\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\\n\\n```javascript\\n/\\\\d{4}(-| |\\\\/)\\\\d{2}(-| |\\\\/)\\\\d{2}/\\n```\\n\\n\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u53d1\u73b0\u80fd\u7b26\u5408\u8981\u6c42\\n\\n```javascript\\nconsole.log(re.test(\\"2017-02-17\\")); // true\\nconsole.log(re.test(\\"2017 02 17\\")); // true\\nconsole.log(re.test(\\"2017/02/17\\")); // true\\n```\\n\\n\u4f46\u662f\u4f60\u4f1a\u53d1\u73b0\u4e00\u4e9b\u610f\u5916\u7684\u60c5\u51b5\\n\\n```javascript\\nconsole.log(re.test(\\"2017-02/17\\")); // true\\nconsole.log(re.test(\\"2017-02 17\\")); // true\\nconsole.log(re.test(\\"2017 02-17\\")); // true\\n```\\n\\n\u524d\u540e\u7684\u5206\u9694\u7b26\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\u4e5f\u80fd\u591f\u5339\u914d\uff0c\u800c\u6211\u4eec\u8981\u6c42\u7684\u662f\u524d\u540e\u7684\u5206\u9694\u7b26\u662f\u4e00\u6837\u7684\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5f15\u7528\u5206\u7ec4\uff0c\u4f7f\u5f97\u524d\u9762\u548c\u540e\u9762\u7684\u5206\u9694\u7b26\u662f\u4e00\u6837\u7684\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet re = /\\\\d{4}(-| |\\\\/)\\\\d{2}\\\\1\\\\d{2}/;\\n\\nconsole.log(re.test(\\"2017-02-17\\")); // true\\nconsole.log(re.test(\\"2017 02 17\\")); // true\\nconsole.log(re.test(\\"2017/02/17\\")); // true\\n\\nconsole.log(re.test(\\"2017-02/17\\")); // false\\nconsole.log(re.test(\\"2017-02 17\\")); // false\\nconsole.log(re.test(\\"2017 02-17\\")); // false\\n```\\n\\n\u6ce8\u610f\u5230\u6211\u4eec\u5bf9\u4e8e\u540e\u9762\u7684\u5206\u7ec4\uff0c\u6211\u4eec\u4f7f\u7528\u4e86 `\\\\1` \u53bb\u8fdb\u884c\u66ff\u4ee3\uff0c`\\\\1` \u7684\u610f\u601d\u5c31\u662f\u4ee3\u8868\u5f15\u7528\u7b2c\u4e00\u4e2a\u5206\u7ec4\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u505a\u5230\u8fd9\u4e2a\u5730\u65b9\u4e0e\u524d\u9762\u7684\u5206\u7ec4\u76f8\u540c\u3002\u540c\u7406\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528 `\\\\2` \u8868\u793a\u5f15\u7528\u7b2c\u4e8c\u4e2a\u5206\u7ec4(\u5982\u679c\u6709\u7684\u8bdd\uff0c\u5982\u679c\u6ca1\u6709\u5c31\u5355\u7eaf\u7684\u8868\u793a\u5339\u914d\u5b57\u7b26\u4e32 `\\"\\\\2\\"`)\u3002\\n\\n## \u4f4d\u7f6e\u5339\u914d\\n\\n### \u76f8\u5173\u5143\u5b57\u7b26\\n\\n\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5185\u5bb9\u5c31\u662f\u5173\u4e8e\u4f4d\u7f6e\u7684\u5339\u914d\uff0c\u4e0e\u5b57\u7b26\u5339\u914d\u4e0d\u540c\uff0c\u4f4d\u7f6e\u5339\u914d\u65f6\u5339\u914d\u5b57\u7b26\u95f4\u7684\u4f4d\u7f6e\uff0c\u5e38\u89c1\u6709\u5173\u4f4d\u7f6e\u7684\u5143\u5b57\u7b26\u5982\u4e0b\\n\\n| \u5143\u5b57\u7b26   | \u542b\u4e49                                 |\\n| -------- | ------------------------------------ |\\n| `^`      | \u5f00\u5934\u4f4d\u7f6e                             |\\n| `$`      | \u7ed3\u5c3e\u4f4d\u7f6e                             |\\n| `\\\\b`     | \u5355\u8bcd\u8fb9\u754c\uff0c\u5373 `\\\\w` \u4e0e `\\\\W` \u4e4b\u95f4\u7684\u4f4d\u7f6e |\\n| `(?=p)`  | \u5339\u914d `p` \u6a21\u5f0f\u524d\u9762\u7684\u4f4d\u7f6e\uff0c\u5177\u4f53\u89c1\u4f8b\u5b50  |\\n| `(?<=p)` | \u5339\u914d `p` \u6a21\u5f0f\u540e\u9762\u7684\u4f4d\u7f6e              |\\n\\n```javascript\\nlet string = \\"[JS] hello\\";\\nlet result = string.replace(/^/,\\"#\\");\\nconsole.log(result); // #[JS] hello\\n\\nresult = string.replace(/$/, \\"#\\");\\nconsole.log(result); // [JS] hello#\\n\\nresult = string.replace(/\\\\b/g, \\"#\\"); // \\\\b \u662f \\\\w \u4e0e \\\\W \u4e4b\u95f4\u7684\u4f4d\u7f6e\uff0c\u8868\u793a\u5355\u8bcd\u7684\u8fb9\u754c\\nconsole.log(result); // [#JS#] #hello#\\n\\nresult = string.replace(/(?=hello)/, \\"#\\"); // hello \u524d\u9762\u7684\u4f4d\u7f6e\\nconsole.log(result); // [JS] #hello\\n\\nresult = string.replace(/(?<=hello)/, \\"#\\"); // hello \u540e\u9762\u7684\u4f4d\u7f6e\\nconsole.log(result); // [JS] hello#\\n```\\n\\n\u540c\u7406\uff0c\u4e5f\u6709\u5143\u5b57\u7b26\u8868\u793a\u4e0e\u4e0a\u9762\u76f8\u53cd\u7684\u610f\u4e49\\n\\n| \u5143\u5b57\u7b26   | \u542b\u4e49                                              |\\n| -------- | ------------------------------------------------- |\\n| `\\\\B`     | \u4e0e `\\\\b` \u76f8\u53cd\uff0c\u8868\u793a\u975e\u5355\u8bcd\u8fb9\u754c                      |\\n| `(?!p)`  | \u4e0e `(?=p)` \u76f8\u53cd\uff0c\u8868\u793a\u4e0d\u662f `p` \u524d\u9762\u4f4d\u7f6e\u7684\u6240\u6709\u4f4d\u7f6e  |\\n| `(?<!p)` | \u4e0e `(?<=p)` \u76f8\u53cd\uff0c\u8868\u793a\u4e0d\u662f `p` \u540e\u9762\u4f4d\u7f6e\u7684\u6240\u6709\u4f4d\u7f6e |\\n\\n```javascript\\nlet string = \\"[JS] hello\\";\\nlet result = string.replace(/\\\\B/g,\\"#\\");\\nconsole.log(result); // #[J#S]# h#e#l#l#o\\n\\nresult = string.replace(/(?!hello)/g, \\"#\\"); // \u4e0d\u662f hello \u524d\u9762\u4f4d\u7f6e\u7684\u6240\u6709\u4f4d\u7f6e\\nconsole.log(result); // #[#J#S#]# h#e#l#l#o#\\n\\nresult = string.replace(/(?<!hello)/g, \\"#\\"); // \u4e0d\u662f hello \u540e\u9762\u4f4d\u7f6e\u7684\u6240\u6709\u4f4d\u7f6e\\nconsole.log(result); // #[#J#S#]# #h#e#l#l#o\\n```\\n\\n### \u5343\u4f4d\u5206\u9694\u7b26\u6848\u4f8b\\n\\n\u73b0\u5728\u6765\u505a\u4e00\u4e2a\u6848\u4f8b\uff0c\u5c06\u6570\u5b57\u8f6c\u5316\u4e3a\u5343\u4f4d\u5206\u9694\u7b26\u8868\u793a\u6cd5\uff0c\u5982 `12345678` \u8f6c\u5316\u4e3a `12,345,678`\uff0c\u6211\u4eec\u9996\u5148\u627e\u5230\u540e\u4e09\u4f4d\u6570\u5b57\u7684\u524d\u9762\u4f4d\u7f6e\uff0c\u7136\u540e\u6dfb\u52a0\u9017\u53f7\uff0c\u5982\u4e0b\\n\\n```javascript\\nlet string = \\"12345678\\";\\nresult = string.replace(/(?=(\\\\d{3})$)/g,\\",\\");\\nconsole.log(result); // 12345,678\\n```\\n\\n\u8fdb\u4e00\u6b65\u5f04\u51fa\u6240\u6709\u7684\u9017\u53f7\\n\\n```javascript\\nresult = string.replace(/(?=(\\\\d{3})+$)/g,\\",\\"); // 12,345,678\\n```\\n\\n\u4f46\u662f\u8fd8\u662f\u6709\u4e00\u4e2a\u5c0f\u5c0f\u95ee\u9898\uff0c\u6d4b\u8bd5\u7684\u6570\u5b57\u4e2a\u6570\u662f\u4e09\u7684\u500d\u6570\u7684\u65f6\u5019\uff0c\u5728\u5f00\u5934\u4e5f\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u9017\u53f7\\n\\n```javascript\\nlet string = \\"123456789\\";\\nresult = string.replace(/(?=(\\\\d{3})+$)/g,\\",\\");\\nconsole.log(result); // ,123,456,789\\n```\\n\\n\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u6b63\u5219\u8868\u8fbe\u5f0f\u5982\u4e0b\\n\\n```javascript\\nresult = string.replace(/(?=(?!^)(\\\\d{3})+$)/g,\\",\\");\\n```\\n\\n\u5176\u4e2d `(?!^)` \u8868\u793a\u4e0d\u662f\u5f00\u5934\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u5e0c\u671b\u652f\u6301\u66f4\u591a\u7684\u683c\u5f0f\uff0c\u6bd4\u5982 `1234567 12345678` \u8f6c\u6362\u4e3a `1,234,567 12,345,678`\uff0c\u53ea\u8981\u5c06\u4e0a\u9762\u7684\u8868\u8fbe\u5f0f\u4e2d\u7684\u5f00\u5934\uff0c\u7ed3\u5c3e\u66ff\u6362\u4e3a `\\\\b` \u5373\u53ef\\n\\n```javascript\\nlet string = \\"1234567 12345678\\";\\nresult = string.replace(/(?=(?!\\\\b)(\\\\d{3})+\\\\b)/g,\\",\\");\\nconsole.log(result); // 1,234,567 12,345,678\\n```\\n\\n\u8003\u8651\u5230 `(?!\\\\b)` \u5c31\u76f8\u5f53\u4e8e `\\\\B`\uff0c\u6240\u4ee5\u4e0a\u9762\u7684\u8868\u8fbe\u5f0f\u4e5f\u53ef\u7b80\u5199\u5982\u4e0b\\n\\n```javascript\\n/(?=\\\\B(\\\\d{3})+\\\\b)/g\\n```\\n\\n### \u591a\u884c\u6a21\u5f0f\\n\\n\u6b63\u5219\u8868\u8fbe\u5f0f\u6709\u4e09\u4e2a\u5e38\u89c1\u7684\u6807\u5fd7\uff0c\u5206\u522b\u4e3a\u5168\u5c40\u6a21\u5f0f `g`\uff0c\u8868\u793a\u8fdb\u884c\u5168\u5c40\u5339\u914d\uff0c\u5982\u679c\u4e0d\u8bbe\u7f6e\u8be5\u6807\u5fd7\uff0c\u90a3\u4e48\u53ea\u4f1a\u5339\u914d\u4e00\u6b21\uff0c\u5982\u679c\u5b57\u7b26\u4e32\u540e\u9762\u8fd8\u8981\u7b26\u5408\u89c4\u5219\u7684\u5b57\u7b26\u4e32\uff0c\u662f\u4e0d\u4f1a\u88ab\u5339\u914d\u7684\uff0c\u5bf9\u4e8e `exec()` \u65b9\u6cd5\uff0c\u975e\u5168\u5c40\u6a21\u5f0f\u4e0b\u4e0d\u4f1a\u66f4\u6539 `lastIndex`\uff0c\u5373 `lastIndex` \u59cb\u7ec8\u662f `0`\u3002\\n\\n```javascript\\nlet string = \\"hello hello\\";\\n\\nlet re1 = /hello/;\\nlet re2 = /hello/g;\\n\\n// \u975e\u5168\u5c40\u66ff\u6362 \u53ea\u4f1a\u66ff\u6362\u5339\u914d\u5230\u7684\u7b2c\u4e00\u4e2a hello\\nconsole.log(string.replace(re1, \\"#\\")); // # hello\\n// \u5168\u5c40\u66ff\u6362 \u5b57\u7b26\u4e32\u4e2d\u6240\u4ee5\u7684 hello \u90fd\u4f1a\u88ab\u66ff\u6362\\nconsole.log(string.replace(re2, \\"#\\")); // # #\\n```\\n\\n\u7b2c\u4e8c\u6807\u5fd7 `i` \u5f88\u597d\u7406\u89e3\uff0c\u5373\u5ffd\u7565\u5927\u5c0f\u5199\\n\\n```javascript\\nlet re1 = /hello/;\\nlet re2 = /hello/i;\\n\\nlet string = \\"Hello\\";\\n\\n// \u4e0d\u5ffd\u7565\u5927\u5c0f\u5199\\nconsole.log(re1.test(string)); // false\\n// \u5ffd\u7565\u5927\u5c0f\u5199\\nconsole.log(re2.test(string)); // true\\n```\\n\\n\u7b2c\u4e09\u4e2a\u6807\u5fd7 `m` \u8868\u793a\u591a\u884c\u6a21\u5f0f\uff0c\u5b83\u53ea\u4f1a\u5f71\u54cd `^,$`\uff0c\u5982\u679c\u4e0d\u662f\u591a\u884c\u6a21\u5f0f\uff0c\u90a3\u4e48 `^, $` \u5c31\u8868\u793a\u5b57\u7b26\u4e32\u7684\u5f00\u5934\u548c\u7ed3\u5c3e\uff0c\u5982\u679c\u662f\u591a\u884c\u6a21\u5f0f\uff0c\u90a3\u4e48 `^,$` \u5c31\u8868\u793a\u6bcf\u4e00\u884c\u7684\u5f00\u5934\u548c\u7ed3\u5c3e\u3002\\n\\n\u975e\u591a\u884c\u6a21\u5f0f\\n\\n```javascript\\nlet string = \\"I \\\\nlove \\\\njava\\";\\n// \u975e\u591a\u884c ^,$ \u8868\u793a\u5b57\u7b26\u4e32\u7684\u5f00\u5934\u548c\u7ed3\u5c3e\\nconsole.log(string.replace(/^|$/g, \\"#\\"));\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b\\n\\n```\\n#I \\nlove \\njava#\\n```\\n\\n\u591a\u884c\u6a21\u5f0f\\n\\n```javascript\\nlet string = \\"I \\\\nlove \\\\njava\\";\\n// \u591a\u884c\u6a21\u5f0f ^,$ \u8868\u793a\u6bcf\u4e00\u884c\u7684\u5f00\u5934\u548c\u7ed3\u5c3e\\nconsole.log(string.replace(/^|$/gm, \\"#\\"));\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b\\n\\n```\\n#I #\\n#love #\\n#java#\\n```"},{"id":"\u9632\u6296\u4e0e\u8282\u6d41","metadata":{"permalink":"/blog/\u9632\u6296\u4e0e\u8282\u6d41","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2020-04-30-\u9632\u6296\u4e0e\u8282\u6d41.mdx","source":"@site/blog/2020-04-30-\u9632\u6296\u4e0e\u8282\u6d41.mdx","title":"\u9632\u6296\u4e0e\u8282\u6d41","description":"\u9632\u6296\u4e0e\u8282\u6d41\u662f\u4e24\u4e2a\u51fa\u4e8e\u6027\u80fd\u8003\u8651\u63d0\u51fa\u7684\u6982\u5ff5\uff0c\u5982\u679c\u5728\u77ed\u65f6\u95f4\u5185\u591a\u6b21\u89e6\u53d1\u540c\u4e00\u51fd\u6570\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u9875\u9762\u7684\u5361\u987f\uff0c\u4ee5\u53ca\u6027\u80fd\u7684\u964d\u4f4e\uff0c\u9488\u5bf9\u8fd9\u79cd\u60c5\u51b5\uff0c\u63d0\u51fa\u4e86\u9632\u6296\u4e0e\u8282\u6d41\u4e24\u4e2a\u89e3\u51b3\u65b9\u6848\u3002","date":"2020-04-30T00:00:00.000Z","formattedDate":"2020\u5e744\u670830\u65e5","tags":[{"label":"\u9632\u6296","permalink":"/blog/tags/\u9632\u6296"},{"label":"\u8282\u6d41","permalink":"/blog/tags/\u8282\u6d41"}],"readingTime":4.01,"hasTruncateMarker":false,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"\u9632\u6296\u4e0e\u8282\u6d41","authors":"xiongtao","tags":["\u9632\u6296","\u8282\u6d41"]},"prevItem":{"title":"\u6b63\u5219\u8868\u8fbe\u5f0f","permalink":"/blog/\u6b63\u5219\u8868\u8fbe\u5f0f"},"nextItem":{"title":"Ajax\u8de8\u57df","permalink":"/blog/Ajax\u8de8\u57df"}},"content":"\u9632\u6296\u4e0e\u8282\u6d41\u662f\u4e24\u4e2a\u51fa\u4e8e\u6027\u80fd\u8003\u8651\u63d0\u51fa\u7684\u6982\u5ff5\uff0c\u5982\u679c\u5728\u77ed\u65f6\u95f4\u5185\u591a\u6b21\u89e6\u53d1\u540c\u4e00\u51fd\u6570\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u9875\u9762\u7684\u5361\u987f\uff0c\u4ee5\u53ca\u6027\u80fd\u7684\u964d\u4f4e\uff0c\u9488\u5bf9\u8fd9\u79cd\u60c5\u51b5\uff0c\u63d0\u51fa\u4e86\u9632\u6296\u4e0e\u8282\u6d41\u4e24\u4e2a\u89e3\u51b3\u65b9\u6848\u3002\\n\\n## \u9632\u6296\u4e0e\u8282\u6d41\u7684\u6982\u5ff5\\n\\n\u4e3a\u4e86\u89e3\u91ca\u5982\u4e0a\u7684\u4e24\u4e2a\u6982\u5ff5\uff0c\u6211\u4eec\u4ee5\u4e00\u4e2a\u4f8b\u5b50\u5f00\u59cb\u3002\u6709\u4e00\u4e2a\u641c\u7d22\u6846\uff0c\u5f53\u7528\u6237\u8f93\u5165\u641c\u7d22\u5185\u5bb9\u65f6\uff0c\u4f1a\u540c\u65f6\u5411\u540e\u7aef\u53d1\u8d77\u8bf7\u6c42\uff0c\u7ed9\u51fa\u76f8\u8fd1\u7684\u8bcd\u6761\u4ee5\u7ed9\u7528\u6237\u63d0\u793a\\n\\n<image src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting2@master/20210430214859.png\\" style={{ zoom: \'50%\'}} />\\n\\n\u5982\u679c\u5f53\u6bcf\u6b21\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u5b57\u7b26\u90fd\u5411\u90fd\u7aef\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\uff0c\u90a3\u4e48\u53d1\u8d77\u8bf7\u6c42\u7684\u6b21\u6570\u5c31\u592a\u9891\u7e41\u4e86\uff0c\u8fd9\u65f6\u6709\u4e24\u79cd\u7b56\u7565\uff1a\\n\\n1. \u5f53\u7528\u6237\u505c\u6b62\u8f93\u5165\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u4f8b\u5982 500ms\uff0c\u6211\u4eec\u5411\u540e\u7aef\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\\n2. \u6bcf\u9694\u56fa\u5b9a\u7684\u65f6\u95f4\u5411\u540e\u7aef\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\\n\\n\u7b2c\u4e00\u79cd\u7b56\u7565\u6211\u4eec\u53eb\u505a\u9632\u6296\uff0c\u7b2c\u4e8c\u79cd\u7b56\u7565\u6211\u4eec\u79f0\u4e3a\u8282\u6d41\u3002\\n\\n\u6709\u4e00\u4e2a\u5f62\u8c61\u7684\u6bd4\u55bb\uff0c\u4ee5\u516c\u4ea4\u8f66\u53d1\u8f66\u4e3a\u4f8b\uff0c\u6709\u4e24\u79cd\u53d1\u8f66\u65b9\u6848\uff1a\\n\\n1. \u5f53\u4e58\u5ba2\u4e0a\u8f66\u540e\uff0c\u5982\u679c\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u6ca1\u6709\u4e58\u5ba2\u4e0a\u8f66\u4e86\uff0c\u5c31\u53d1\u8f66\\n2. \u53d1\u8f66\u65f6\u95f4\u56fa\u5b9a\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53d1\u4e00\u6b21\u8f66\\n\\n\u6211\u4eec\u5c06\u53d1\u8f66\u6bd4\u55bb\u4e3a\u5411\u540e\u7aef\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\uff0c\u90a3\u4e48\u8fd9\u4e24\u79cd\u53d1\u8f66\u7684\u7b56\u7565\u5c31\u5206\u522b\u5bf9\u5e94\u4e3a\u9632\u6296\u548c\u8282\u6d41\u3002\\n\\n## \u9632\u6296\u5b9e\u73b0\\n\\n\u6211\u4eec\u8981\u5b9e\u73b0\u4e00\u4e2a `debounce` \u51fd\u6570\uff0c\u8be5\u51fd\u6570\u63a5\u6536\u4e00\u4e2a\u51fd\u6570\u4ee5\u53ca\u65f6\u95f4\uff0c\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\uff0c`debounce` \u51fd\u6570\u7684\u4f5c\u7528\u5c31\u662f\u5c06\u4e00\u4e2a\u666e\u901a\u7684\u51fd\u6570\u53d8\u4e3a\u9632\u6296\u7684\u51fd\u6570\uff0c\u5373\u591a\u6b21\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u53ea\u6709\u7ecf\u8fc7\u6307\u5b9a\u65f6\u95f4\u540e\uff0c\u51fd\u6570\u624d\u4f1a\u89e6\u53d1**\u4e00\u6b21**\\n\\n```javascript\\nconst debounce = (fn, time) => {\\n    let timerId\\n\\n    return function(...args) {\\n        clearTimeout(timerId)\\n        timerId = setTimeout(() => {\\n            fn.apply(this, args)\\n        }, time)\\n    }\\n}\\n```\\n\\n\u4e0a\u9762\u6709\u51e0\u4e2a\u6ce8\u610f\u4e8b\u9879\uff1a\\n\\n- `timerId` \u8981\u653e\u5728\u8fd4\u56de\u7684\u51fd\u6570\u4e4b\u5916\uff0c\u5f62\u6210\u95ed\u5305\uff0c\u4ee5\u786e\u4fdd\u6bcf\u6b21\u8c03\u7528\u51fd\u6570\u65f6\u8bbf\u95ee\u7684\u662f\u540c\u4e00\u4e2a `timerId`\\n\\n- \u8fd4\u56de\u7684\u51fd\u6570\u4e0d\u8981\u5199\u6210\u7bad\u5934\u51fd\u6570\u7684\u5f62\u5f0f\\n\\n  ```javascript\\n  // \u4e0d\u8981\u5199\u6210\u8fd9\u6837\\n  return (...args) => {\\n      \\n  }\\n  ```\\n\\n  \u56e0\u4e3a\u8fd9\u6837\u4f1a\u4e22\u5931 `this`\\n\\n- \u6700\u540e\u8981\u901a\u8fc7 `apply` \u65b9\u6cd5\u5c06 `this` \u4f20\u5165\\n\\n## \u8282\u6d41\u5b9e\u73b0\\n\\n\u6211\u4eec\u8981\u5b9e\u73b0\u4e00\u4e2a `throttle` \u51fd\u6570\uff0c\u8be5\u51fd\u6570\u7684\u4f5c\u7528\u662f\u5c06\u4e00\u4e2a\u666e\u901a\u51fd\u6570\u8f6c\u5316\u4e3a\u8282\u6d41\u51fd\u6570\uff0c\u4e5f\u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u51fd\u6570\uff0c\u7b2c\u4e8c\u4e2a\u51fd\u6570\u4e3a\u65f6\u95f4\uff0c\u5f53\u591a\u6b21\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u53ea\u80fd\u89e6\u53d1\u4e00\u6b21\\n\\n```javascript\\nconst throttle = (fn, time) => {\\n    let pre = 0;\\n\\n    return function(...args) {\\n        let now = Date.now();\\n        if (now - pre > time) {\\n            fn.apply(this, args);\\n            pre = now;\\n        }\\n    }\\n}\\n```\\n\\n`pre` \u8868\u793a\u4e0a\u4e00\u6b21\u6267\u884c\u7684\u65f6\u95f4\uff0c\u9ed8\u8ba4\u503c\u4e3a `0`\uff0c\u8fd9\u6837\u7b2c\u4e00\u6b21\u8c03\u7528\u8be5\u51fd\u6570\u65f6\u4f1a\u7acb\u5373\u6267\u884c\u8be5\u51fd\u6570\u3002\u6bcf\u6b21\u6267\u884c\u51fd\u6570\u65f6\uff0c\u5224\u65ad\u8ddd\u4e0a\u6b21\u6267\u884c\u5df2\u7ecf\u7ecf\u8fc7\u7684\u65f6\u95f4 `Date.now() - start` \u662f\u5426\u5927\u4e8e\u8bbe\u5b9a\u7684\u65f6\u95f4\uff0c\u5927\u4e8e\u5219\u6267\u884c\uff0c\u5c0f\u4e8e\u5219\u4e0d\u6267\u884c\uff0c\u4ee5\u8fbe\u5230\u8282\u6d41\u7684\u76ee\u7684\uff0c\u6267\u884c\u51fd\u6570\u540e\uff0c\u8bbe\u7f6e `pre` \u4e3a\u5f53\u524d\u51fd\u6570\u6267\u884c\u65f6\u7684\u65f6\u523b\u3002\\n\\n:::note note\\n\\n\u8fd4\u56de\u7684\u51fd\u6570\u4e0d\u80fd\u5199\u4e3a\u7bad\u5934\u51fd\u6570\uff0c\u540c\u6837\u662f\u56e0\u4e3a\u4f1a\u4e22\u5931 `this`\u3002\\n\\n:::"},{"id":"Ajax\u8de8\u57df","metadata":{"permalink":"/blog/Ajax\u8de8\u57df","editUrl":"https://github.com/LastKnightCoder/lastknightcoder/tree/master/blog/2020-04-20-Ajax\u8de8\u57df.mdx","source":"@site/blog/2020-04-20-Ajax\u8de8\u57df.mdx","title":"Ajax\u8de8\u57df","description":"\u540c\u6e90\u7b56\u7565","date":"2020-04-20T00:00:00.000Z","formattedDate":"2020\u5e744\u670820\u65e5","tags":[{"label":"Ajax","permalink":"/blog/tags/ajax"},{"label":"CROS","permalink":"/blog/tags/cros"},{"label":"JSONP","permalink":"/blog/tags/jsonp"}],"readingTime":12.07,"hasTruncateMarker":true,"authors":[{"name":"\u718a\u6ed4","title":"\u524d\u7aef\u5de5\u7a0b\u5e08 @ \u963f\u91cc\u5df4\u5df4","url":"https://github.com/LastKnightCoder","imageURL":"https://cdn.staticaly.com/gh/LastKnightCoder/ImgHosting3@master/wallhaven-8opwwy.3cbn7rc981c0.webp","key":"xiongtao"}],"frontMatter":{"slug":"Ajax\u8de8\u57df","tags":["Ajax","CROS","JSONP"],"authors":"xiongtao"},"prevItem":{"title":"\u9632\u6296\u4e0e\u8282\u6d41","permalink":"/blog/\u9632\u6296\u4e0e\u8282\u6d41"}},"content":"## \u540c\u6e90\u7b56\u7565\\n\\n\u4ec0\u4e48\u662f\u540c\u6e90\u7b56\u7565\uff1a\u540c `domain`(\u6216`IP`)\uff0c\u540c\u7aef\u53e3\uff0c\u540c\u534f\u8bae\u89c6\u4e3a\u540c\u4e00\u4e2a\u57df\uff0c\u4e00\u4e2a\u57df\u5185\u7684\u811a\u672c\u4ec5\u4ec5\u5177\u6709\u672c\u57df\u5185\u7684\u6743\u9650\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u672c\u57df\u811a\u672c\u53ea\u80fd\u8bfb\u5199\u672c\u57df\u5185\u7684\u8d44\u6e90\uff0c\u800c\u65e0\u6cd5\u8bbf\u95ee\u5176\u5b83\u57df\u7684\u8d44\u6e90\uff0c\u8fd9\u79cd\u5b89\u5168\u9650\u5236\u79f0\u4e3a\u540c\u6e90\u7b56\u7565\u3002\u6211\u4eec\u770b\u51e0\u4e2a\u4f8b\u5b50\u5224\u65ad\u4e24\u4e2a\u94fe\u63a5\u662f\u5426\u662f\u540c\u6e90\\n\\n| `url1`                       | `url2`                       | \u662f\u5426\u540c\u6e90 | \u539f\u56e0                             |\\n| ---------------------------- | ---------------------------- | -------- | -------------------------------- |\\n| http://example.com:8080      | http://example.com:80        | \u5426       | \u7aef\u53e3\u4e0d\u540c                         |\\n| http://example.com:8080      | https://example.com:8080     | \u5426       | \u534f\u8bae\u4e0d\u540c                         |\\n| http://www.baidu.com         | http://www.taobao.com        | \u5426       | \u57df\u540d\u4e0d\u540c                         |\\n| http://127.0.0.1:8080        | http://localhost:8080        | \u5426       | \u57df\u540d\u4e0e\u57df\u540d\u5bf9\u5e94\u7684IP\u5730\u5740\u4e0d\u540c\u6e90     |\\n| http://example.com:8000/a.js | http://example.com:8000/b.js | \u662f       | \u534f\u8bae\uff0c\u57df\u540d\uff0c\u7aef\u53e3\u76f8\u540c\uff0c\u5b50\u57df\u540d\u4e0d\u540c |\\n\\n\x3c!--truncate--\x3e\\n\\n\u6211\u4eec\u9996\u5148\u542f\u52a8\u4e00\u4e2a `Node` \u7a0b\u5e8f\u4f5c\u4e3a\u670d\u52a1\u7aef\uff0c\u542f\u52a8\u5728\u672c\u5730\u7684 `4000` \u7aef\u53e3\uff0c\u5982\u4e0b\\n\\n```javascript\\nconst http = require(\'http\');\\n\\nconst server = http.createServer();\\n\\nserver.on(\'request\', function(req, res) {\\n    res.end(\'hello world\');\\n})\\n\\nserver.listen(4000, function() {\\n    console.log(\'\u670d\u52a1\u542f\u52a8\u57284000\u7aef\u53e3...\');\\n})\\n```\\n\\n\u73b0\u5728\u6211\u4eec\u540c\u65f6\u5728\u672c\u5730\u7684 `5501` \u7aef\u53e3\u542f\u52a8\u4e00\u4e2a\u9759\u6001\u670d\u52a1\u5668\u663e\u793a\u7f51\u9875\uff0c\u5728\u7f51\u9875\u4e2d\u6211\u4eec\u53d1\u8d77\u4e00\u4e2a `ajax` \u8bf7\u6c42\uff0c\u5411\u672c\u5730\u7684 `4000` \u7aef\u53e3\u8bf7\u6c42\u6570\u636e\uff0c\u5373\u6211\u4eec\u521a\u521a\u642d\u7684 Node \u7a0b\u5e8f\\n\\n```javascript\\nconst xhr = new XMLHttpRequest();\\nxhr.onreadystatechange = function () { \\n    if (xhr.readyState == 4 && xhr.status == 200) {\\n        console.log(xhr.responseText);\\n    } \\n }\\n xhr.onerror = function() {\\n     console.error(\'\u51fa\u9519\u4e86\')\\n }\\nxhr.open(\'get\', \'http://127.0.0.1:4000\');\\nxhr.send(null);\\n```\\n\\n\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u6253\u5f00\u63a7\u5236\u53f0\uff0c\u53d1\u73b0\u7ed9\u51fa\u8fd9\u6837\u7684\u9519\u8bef\u4fe1\u606f\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/202204211942172022-04-21-19-42-19.png\\" style={{ zoom: \'50%\'}}/>\\n\\n\\n\u56e0\u4e3a\u7f51\u9875\u7684\u5730\u5740 `http://127.0.0.1:5501` \u4e0e\u670d\u52a1\u5668\u7684\u5730\u5740 `http://127.0.0.1:4000` \u5b83\u4eec\u7684\u57df\u540d\u662f\u4e0d\u540c\u7684\uff0c\u6240\u4ee5\u5b83\u4eec\u662f\u4e0d\u540c\u6e90\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u8bf7\u6c42\u662f\u8de8\u57df\u7684\u8bf7\u6c42\uff0c\u800c\u6d4f\u89c8\u5668\u662f\u4e0d\u5141\u8bb8\u8de8\u57df\u8bf7\u6c42\u7684\u3002\u90a3\u4e48\u6d4f\u89c8\u5668\u4e3a\u4ec0\u4e48\u4f1a\u63d0\u51fa\u540c\u6e90\u7b56\u7565\uff0c\u8fd9\u662f\u51fa\u4e8e\u5b89\u5168\u7684\u8003\u8651\u3002\u540c\u6e90\u7b56\u7565\u5305\u62ec\u4e24\u79cd\uff1a\\n\\n1. `DOM` \u540c\u6e90\u7b56\u7565\uff1a\u7981\u6b62\u5bf9\u4e0d\u540c\u6e90\u9875\u9762 `DOM` \u8fdb\u884c\u64cd\u4f5c\uff0c\u8fd9\u91cc\u4e3b\u8981\u573a\u666f\u662f `iframe` \u8de8\u57df\u7684\u60c5\u51b5\uff0c\u4e0d\u540c\u57df\u540d\u7684 `iframe` \u662f\u9650\u5236\u4e92\u76f8\u8bbf\u95ee\u7684\\n2. `XMLHttpRequest` \u540c\u6e90\u7b56\u7565\uff1a\u7981\u6b62\u4f7f\u7528 `xhr` \u5bf9\u8c61\u5411\u4e0d\u540c\u6e90\u7684\u670d\u52a1\u5668\u5730\u5740\u53d1\u8d77 `HTTP` \u8bf7\u6c42\\n\\n\u5728\u8fd9\u91cc\u6211\u4eec\u53ea\u5173\u6ce8 `ajax` \u8de8\u57df\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u5982\u679c\u6ca1\u6709\u540c\u6e90\u7b56\u7565\u4f1a\u6709\u4ec0\u4e48\u5371\u5bb3\uff1a\\n\\n1. \u7528\u6237\u767b\u5f55\u4e86\u81ea\u5df1\u7684\u94f6\u884c\u9875\u9762 http://mybank.com\uff0chttp://mybank.com \u5411\u7528\u6237\u7684 `cookie` \u4e2d\u6dfb\u52a0\u7528\u6237\u6807\u8bc6\\n2. \u7528\u6237\u6d4f\u89c8\u4e86\u6076\u610f\u9875\u9762 http://evil.com\uff0c\u6267\u884c\u4e86\u9875\u9762\u4e2d\u7684\u6076\u610f `AJAX` \u8bf7\u6c42\u4ee3\u7801\\n3. http://evil.com \u5411 http://mybank.com \u53d1\u8d77 `AJAX HTTP` \u8bf7\u6c42\uff0c\u8bf7\u6c42\u4f1a\u9ed8\u8ba4\u628a http://mybank.com \u5bf9\u5e94 `cookie` \u4e5f\u540c\u65f6\u53d1\u9001\u8fc7\u53bb\\n4. \u94f6\u884c\u9875\u9762\u4ece\u53d1\u9001\u7684 `cookie` \u4e2d\u63d0\u53d6\u7528\u6237\u6807\u8bc6\uff0c\u9a8c\u8bc1\u7528\u6237\u65e0\u8bef\uff0c`response` \u4e2d\u8fd4\u56de\u8bf7\u6c42\u6570\u636e\uff0c\u6b64\u65f6\u6570\u636e\u5c31\u6cc4\u9732\u4e86\\n5. \u800c\u4e14\u7531\u4e8e `Ajax` \u5728\u540e\u53f0\u6267\u884c\uff0c\u7528\u6237\u65e0\u6cd5\u611f\u77e5\u8fd9\u4e00\u8fc7\u7a0b\\n\\n\u6240\u4ee5\u6709\u4e86\u540c\u6e90\u7b56\u7565\u6211\u4eec\u624d\u80fd\u591f\u5b89\u5168\u7684\u4e0a\u7f51\uff0c\u4f46\u662f\u5f88\u591a\u65f6\u5019\u6211\u4eec\u8fd8\u662f\u6709\u8de8\u57df\u7684\u9700\u6c42\u7684\uff0c\u5e76\u4e14\u73b0\u5728\u968f\u7740\u524d\u540e\u7aef\u5206\u79bb\u7684\u6d41\u884c\uff0c\u524d\u7aef\u4e0e\u540e\u7aef\u7684\u4e0d\u540c\u6e90\u662f\u5f88\u6709\u53ef\u80fd\uff0c\u6240\u4ee5\u8feb\u5207\u9700\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e0b\u9762\u5c31\u4ecb\u7ecd\u4e24\u79cd\u8de8\u57df\u7684\u65b9\u6cd5\u3002\\n\\n## JSONP\\n\\n\u540c\u6e90\u7b56\u7565\u63d0\u5347\u4e86 `Web` \u524d\u7aef\u7684\u5b89\u5168\u6027\uff0c\u4f46\u727a\u7272\u4e86 `Web` \u62d3\u5c55\u4e0a\u7684\u7075\u6d3b\u6027\u3002\u8bbe\u60f3\u82e5\u628a `html`\u3001`js`\u3001`css`\u3001`flash`\u3001`image` \u7b49\u6587\u4ef6\u5168\u90e8\u5e03\u7f6e\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff0c\u5c0f\u7f51\u7ad9\u8fd9\u6837\u51d1\u6d3b\u8fd8\u884c\uff0c\u5927\u4e2d\u7f51\u7ad9\u5982\u679c\u8fd9\u6837\u505a\u670d\u52a1\u5668\u6839\u672c\u53d7\u4e0d\u4e86\u7684\u3002\u6240\u4ee5\uff0c**\u73b0\u4ee3\u6d4f\u89c8\u5668\u5728\u5b89\u5168\u6027\u548c\u53ef\u7528\u6027\u4e4b\u95f4\u9009\u62e9\u4e86\u4e00\u4e2a\u5e73\u8861\u70b9\u3002\u5728\u9075\u5faa\u540c\u6e90\u7b56\u7565\u7684\u57fa\u7840\u4e0a\uff0c\u9009\u62e9\u6027\u5730\u4e3a\u540c\u6e90\u7b56\u7565\u5f00\u653e\u4e86\u540e\u95e8\uff0c** \u4f8b\u5982 `img` `script` `style` \u7b49\u6807\u7b7e\uff0c\u90fd\u5141\u8bb8\u57ae\u57df\u5f15\u7528\u8d44\u6e90\uff0c\u4e25\u683c\u8bf4\u8fd9\u90fd\u662f\u4e0d\u7b26\u5408\u540c\u6e90\u8981\u6c42\u7684\u3002\\n\\n\u6b63\u662f\u5229\u7528 `script` \u7b49\u6807\u7b7e\u5f15\u7528\u7684\u8d44\u6e90\u6ca1\u6709\u540c\u6e90\u7b56\u7565\u7684\u9650\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 `script` \u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\uff0c\u800c\u670d\u52a1\u5668\u8fd4\u56de\u4e00\u4e2a\u56de\u8c03\uff0c\u5c06\u6570\u636e\u4f5c\u4e3a\u53c2\u6570\u8fd4\u56de\uff0c\u53ef\u80fd\u4f60\u73b0\u5728\u4e0d\u80fd\u660e\u767d\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u5728\u9875\u9762\u4e2d\u6dfb\u52a0\u4e0b\u9762\u7684\u5185\u5bb9\\n\\n```html\\n<script>\\n    function getData(data) {\\n        console.log(data);\\n    }\\n    // \u521b\u5efa\u4e00\u4e2a script \u6807\u7b7e\u7528\u4ee5\u8bf7\u6c42\u6570\u636e\\n    let scriptElement = document.createElement(\'script\');\\n    // \u8bbe\u7f6e\u8bf7\u6c42\u7684\u5730\u5740 \u5e76\u4e14\u8bbe\u7f6e\u4e86\u56de\u8c03\u51fd\u6570\\n    scriptElement.src = \'http://127.0.0.1:4000?callback=getData\';\\n    // \u8fd9\u4e00\u6b65\u5f88\u91cd\u8981\uff0c\u4e0d\u8bbe\u7f6e\u7684\u8bdd\u6d4f\u89c8\u5668\u4f1a\u62a5\u9519 Uncaught SyntaxError: Unexpected identifier\\n    scriptElement.setAttribute(\'type\', \'text/javascript\');\\n    // \u5c06\u8fd9\u4e2a script \u6807\u7b7e\u6dfb\u52a0\u5230 body \u4e2d\\n    document.getElementsByTagName(\'body\')[0].appendChild(scriptElement);\\n<\/script>\\n```\\n\\nNode \u670d\u52a1\u7aef\u7684\u4ee3\u7801\\n\\n```javascript\\nconst http = require(\'http\');\\nconst querystring = require(\'querystring\');\\n\\nconst server = http.createServer();\\n\\nserver.on(\'request\', function(req, res) {\\n    let qs = querystring.parse(req.url.split(\'?\')[1]); // \u89e3\u6790\u8bf7\u6c42\u53c2\u6570\\n    \\n    let data = \\"Hello World\\"; // \u8fd4\u56de\u7684\u6570\u636e\\n    \\n    // \u4e00\u5b9a\u8981\u5728 ${data} \u4e24\u7aef\u52a0\u4e0a\u53cc\u5f15\u53f7\uff0c\u5426\u5219\u6d4f\u89c8\u5668\u5f97\u5230\u7684\u662f getData(Hello World)\u4f1a\u62a5\u9519\\n    res.end(`${qs.callback}(\\"${data}\\")`); // \u5373getData(data)\\n})\\n\\nserver.listen(4000, function() {\\n    console.log(\'\u670d\u52a1\u542f\u52a8\u57284000\u7aef\u53e3...\');\\n})\\n```\\n\\n\u7ed3\u679c\u5982\u4e0b\\n\\n\\n<img src=\\"https://cdn.jsdelivr.net/gh/LastKnightCoder/ImgHosting3@master/202204211943002022-04-21-19-43-01.png\\" style={{ zoom: \'50%\'}}/>\\n\\n\u6211\u6765\u7406\u4e00\u4e0b\u4e0a\u9762\u7684\u6b65\u9aa4\\n\\n1. \u9996\u5148\u521b\u5efa\u4e86\u4e00\u4e2a\u51fd\u6570 `getData`\uff0c\u8be5\u51fd\u6570\u7684\u4f5c\u7528\u662f\u7528\u6765\u5904\u7406\u6570\u636e\u7684\uff0c\u63a5\u6536\u7684\u90a3\u4e2a\u53c2\u6570\u5c31\u662f\u6570\u636e\\n\\n   ```javascript\\n   function getData(data) {\\n       console.log(data);\\n   }\\n   ```\\n\\n2. \u521b\u5efa\u4e00\u4e2a `script` \u6807\u7b7e\uff0c\u5e76\u4e14\u8bbe\u7f6e\u4e86\u8bf7\u6c42\u7684\u5730\u5740\uff0c\u4ee5\u53ca\u5c06\u5904\u7406\u6570\u636e\u51fd\u6570\u7684\u540d\u79f0\u5373 `getData` \u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\\n\\n   ```javascript\\n   script.src = \'http://127.0.0.1:4000?callback=getData\';\\n   ```\\n\\n3. \u670d\u52a1\u5668\u63a5\u5230\u8bf7\u6c42\uff0c\u5c06\u8981\u8fd4\u56de\u7684\u6570\u636e\u4f5c\u4e3a\u4f20\u5165\u7684\u56de\u8c03\u51fd\u6570\u7684\u53c2\u6570\u4f20\u5165\\n\\n   ```javascript\\n   res.end(`${qs.callback}(\\"${data}\\")`); // \u5373getData(data)\\n   ```\\n\\n4. `script` \u6807\u7b7e\u5f97\u5230\u670d\u52a1\u5668\u8fd4\u56de\u7684\u6570\u636e\uff0c\u5373 `getData(\\"Hello World\\")`\uff0c\u7136\u540e\u6267\u884c\uff0c\u8fd9\u6837\u6570\u636e `Hello World` \u5c31\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u4e86 `getData()`\\n\\n:::note note\\n\\n\u4f18\u70b9\uff1a\\n\\n- \u4f7f\u7528\u7b80\u4fbf\uff0c\u6ca1\u6709\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u662f\u76ee\u524d\u6700\u6d41\u884c\u7684\u8de8\u57df\u65b9\u6cd5\\n\\n\u7f3a\u70b9\uff1a\\n\\n- \u53ea\u652f\u6301 `GET` \u8bf7\u6c42\uff0c\u5e76\u4e14\u4ee3\u7801\u662f\u4ece\u5176\u4ed6\u57df\u5f97\u5230\u7684\uff0c\u4e0d\u6392\u9664\u53ef\u80fd\u6709\u6076\u610f\u4ee3\u7801\uff0c\u6240\u4ee5\u4f7f\u7528\u8be5\u65b9\u6cd5\uff0c\u670d\u52a1\u7aef\u5fc5\u987b\u786e\u4fdd\u503c\u5f97\u4fe1\u4efb\\n- \u8981\u786e\u5b9a `JSONP` \u8bf7\u6c42\u5931\u8d25\u5e76\u4e0d\u5bb9\u6613\\n\\n:::\\n\\n## CORS\\n\\n`CORS`(`Cross-origin resource sharing`\uff0c\u8de8\u57df\u8d44\u6e90\u5171\u4eab) \u662f\u4e00\u4e2a `W3C` \u6807\u51c6\uff0c\u5b9a\u4e49\u4e86\u5728\u5fc5\u987b\u8bbf\u95ee\u8de8\u57df\u8d44\u6e90\u65f6\uff0c\u6d4f\u89c8\u5668\u4e0e\u670d\u52a1\u5668\u5e94\u8be5\u5982\u4f55\u6c9f\u901a\u3002`CORS` \u80cc\u540e\u7684\u57fa\u672c\u601d\u60f3\uff0c\u5c31\u662f\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684 `HTTP` \u5934\u90e8\u8ba9\u6d4f\u89c8\u5668\u4e0e\u670d\u52a1\u5668\u8fdb\u884c\u6c9f\u901a\uff0c\u4ece\u800c\u51b3\u5b9a\u8bf7\u6c42\u6216\u54cd\u5e94\u662f\u5e94\u8be5\u6210\u529f\uff0c\u8fd8\u662f\u5e94\u8be5\u5931\u8d25\u3002`CORS` \u9700\u8981\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u540c\u65f6\u652f\u6301\u3002\u76ee\u524d\uff0c\u6240\u6709\u6d4f\u89c8\u5668\u90fd\u652f\u6301\u8be5\u529f\u80fd\uff0c`IE` \u6d4f\u89c8\u5668\u4e0d\u80fd\u4f4e\u4e8e `IE10`\u3002\\n\\n\u5bf9\u4e8e\u5f00\u53d1\u8005\u6765\u8bf4\uff0c\u6211\u4eec\u53ea\u8981\u6b63\u5e38\u7684\u53d1\u51fa `ajax` \u8bf7\u6c42\u5373\u53ef\uff0c\u4e0e\u4e4b\u524d\u6ca1\u6709\u4efb\u4f55\u533a\u522b\uff0c\u5982\\n\\n```javascript\\nconst xhr = new XMLHttpRequest();\\nxhr.onreadystatechange = function () { \\n    if (xhr.readyState == 4 && xhr.status == 200) {\\n        console.log(xhr.responseText);\\n    } \\n }\\n xhr.onerror = function() {\\n     console.error(\'\u51fa\u9519\u4e86\')\\n }\\nxhr.open(\'get\', \'http://127.0.0.1:4000\');\\nxhr.send(null);\\n```\\n\\n\u4f46\u662f\u5728\u670d\u52a1\u7aef\uff0c\u6211\u4eec\u8981\u8bbe\u7f6e\u4e00\u4e0b\u4fe1\u8d56\u7684\u8bf7\u6c42\u6765\u6e90\uff0c\u5982\u4e0b\\n\\n```javascript\\nconst http = require(\'http\');\\n\\nconst server = http.createServer();\\n\\nserver.on(\'request\', function(req, res) {\\n    // \u8868\u793a\u6765\u81ea http://127.0.0.1:5501 \u7684\u8bf7\u6c42\u53ef\u4ee5\u62ff\u5230\u6570\u636e\\n    res.setHeader(\'Access-Control-Allow-Origin\', \'http://127.0.0.1:5501\')\\n    res.end(\'hello world\');\\n})\\n\\nserver.listen(4000, function() {\\n    console.log(\'\u670d\u52a1\u542f\u52a8\u57284000\u7aef\u53e3...\');\\n})\\n```\\n\\n\u9664\u4e86\u53ef\u4ee5\u8bbe\u7f6e\u8bf7\u6c42\u6765\u6e90\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u5141\u8bb8\u7684\u65b9\u6cd5\uff0c\u5141\u8bb8\u7684\u5934\u90e8\u7b49\u7b49\\n\\n| \u54cd\u5e94\u5934                       | \u4f5c\u7528                                                 |\\n| ---------------------------- | ---------------------------------------------------- |\\n| Access-Control-Allow-Origin  | \u8bbe\u7f6e\u5141\u8bb8\u7684\u8bf7\u6c42\u6765\u6e90\uff0c\u5982\u679c\u5141\u8bb8\u4efb\u610f\u6765\u6e90\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a `*` |\\n| Access-Control-Allow-Methods | \u5141\u8bb8\u7684\u65b9\u6cd5\uff0c\u591a\u4e2a\u4ee5\u9017\u53f7\u5206\u9694\uff0c\u5982 `GET`, `POST`         |\\n| Access-Control-Allow-Headers | \u5141\u8bb8\u7684\u8bf7\u6c42\u5934\uff0c\u591a\u4e2a\u4ee5\u9017\u53f7\u5206\u9694                         |\\n\\n\u6d4f\u89c8\u5668\u5c06 `CORS` \u8bf7\u6c42\u5206\u4e3a\u4e24\u7c7b\uff0c\u5206\u522b\u4e3a\u7b80\u5355\u8bf7\u6c42\u548c\u975e\u7b80\u5355\u8bf7\u6c42\u3002\u5982\u679c\u6ee1\u8db3\u4ee5\u4e0b\u4e24\u7c7b\u8bf7\u6c42\uff0c\u5c31\u662f\u7b80\u5355\u8bf7\u6c42\\n\\n1. \u8bf7\u6c42\u65b9\u6cd5\u662f\u4ee5\u4e0b\u4e09\u79cd\u65b9\u6cd5\u4e4b\u4e00\uff1a\\n   - `GET`\\n   - `POST`\\n   - `HEAD`\\n2. HTTP\u7684\u5934\u4fe1\u606f\u4e0d\u8d85\u51fa\u4ee5\u4e0b\u51e0\u79cd\u5b57\u6bb5\uff1a\\n   - `Accept`\\n   - `Accept-Language`\\n   - `Content-Language`\\n   - `Last-Event-ID`\\n   - `Content-Type`\uff1a\u53ea\u9650\u4e8e\u4e09\u4e2a\u503c `application/x-www-form-urlencoded`\u3001`multipart/form-data`\u3001`text/plain`\\n\\n\u5982\u679c\u4e0d\u6ee1\u8db3\u4ee5\u4e0a\u7684\u4e24\u5927\u6761\u4ef6\uff0c\u90a3\u4e48\u5c31\u662f\u975e\u7b80\u5355\u8bf7\u6c42\uff0c\u800c\u6d4f\u89c8\u5668\u5bf9\u4e8e\u7b80\u5355\u8bf7\u6c42\u548c\u975e\u7b80\u5355\u8bf7\u6c42\u7684\u5904\u7406\u662f\u4e0d\u4e00\u6837\u7684\u3002\\n\\n**\u7b80\u5355\u8bf7\u6c42**\\n\\n1. \u5728\u8bf7\u6c42\u4e2d\u9700\u8981\u9644\u52a0\u4e00\u4e2a\u989d\u5916\u7684 `Origin` \u5934\u90e8\uff0c\u5176\u4e2d\u5305\u542b\u8bf7\u6c42\u9875\u9762\u7684\u6e90\u4fe1\u606f\uff08\u534f\u8bae\u3001\u57df\u540d\u548c\u7aef\u53e3\uff09\uff0c\u4ee5\u4fbf\u670d\u52a1\u5668\u6839\u636e\u8fd9\u4e2a\u5934\u90e8\u4fe1\u606f\u6765\u51b3\u5b9a\u662f\u5426\u7ed9\u4e88\u54cd\u5e94\u3002\u4f8b\u5982\uff1a`Origin: http://127.0.0.1:5501`\\n\\n2. \u5982\u679c\u670d\u52a1\u5668\u8ba4\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u53ef\u4ee5\u63a5\u53d7\uff0c\u5c31\u5728 `Access-Control-Allow-Origin` \u5934\u90e8\u4e2d\u56de\u53d1\u76f8\u540c\u7684\u6e90\u4fe1\u606f(\u5982\u679c\u662f\u516c\u5171\u8d44\u6e90\uff0c\u53ef\u4ee5\u56de\u53d1 `*`)\uff0c\u4f8b\u5982\uff1a`Access-Control-Allow-Origin\uff1ahttp://127.0.0.1:5501`\\n\\n3. \u6ca1\u6709\u8fd9\u4e2a\u5934\u90e8\u6216\u8005\u6709\u8fd9\u4e2a\u5934\u90e8\u4f46\u6e90\u4fe1\u606f\u4e0d\u5339\u914d\uff0c\u6d4f\u89c8\u5668\u5c31\u4f1a\u9a73\u56de\u8bf7\u6c42\uff0c\u6ce8\u610f\uff0c\u8bf7\u6c42\u548c\u54cd\u5e94\u90fd\u4e0d\u5305\u542b `cookie` \u4fe1\u606f\\n\\n4. \u5982\u679c\u9700\u8981\u5305\u542b `cookie` \u4fe1\u606f\uff0c`ajax` \u8bf7\u6c42\u9700\u8981\u8bbe\u7f6e `xhr` \u7684\u5c5e\u6027 `withCredentials` \u4e3a `true`\uff0c\u670d\u52a1\u5668\u9700\u8981\u8bbe\u7f6e\u54cd\u5e94\u5934\u90e8 `Access-Control-Allow-Credentials: true`\\n\\n**\u975e\u7b80\u5355\u8bf7\u6c42**\\n\\n\u975e\u7b80\u5355\u8bf7\u6c42\u53ef\u80fd\u5bf9\u670d\u52a1\u5668\u6570\u636e\u4ea7\u751f\u526f\u4f5c\u7528\uff0c\u6d4f\u89c8\u5668\u5fc5\u987b\u9996\u5148\u4f7f\u7528 `OPTIONS` \u65b9\u6cd5\u53d1\u8d77\u4e00\u4e2a\u9884\u68c0\u8bf7\u6c42(`preflight request`)\uff0c\u4ece\u800c\u83b7\u77e5\u670d\u52a1\u7aef\u662f\u5426\u5141\u8bb8\u8be5\u8de8\u57df\u8bf7\u6c42\uff1a\\n\\n- `Origin`\uff1a\u4e0e\u7b80\u5355\u7684\u8bf7\u6c42\u76f8\u540c\\n- `Access-Control-Request-Method`: \u8bf7\u6c42\u81ea\u8eab\u4f7f\u7528\u7684\u65b9\u6cd5\\n- `Access-Control-Request-Headers`: (\u53ef\u9009)\u81ea\u5b9a\u4e49\u7684\u5934\u90e8\u4fe1\u606f\uff0c\u591a\u4e2a\u5934\u90e8\u4ee5\u9017\u53f7\u5206\u9694\\n\\n```http\\nOrigin: http://127.0.0.1:5501\\nAccess-Control-Request-Method: POST\\nAccess-Control-Request-Headers: NCZ\\n```\\n\\n\u53d1\u9001\u8fd9\u4e2a\u8bf7\u6c42\u540e\uff0c\u670d\u52a1\u5668\u53ef\u4ee5\u51b3\u5b9a\u662f\u5426\u5141\u8bb8\u8fd9\u79cd\u7c7b\u578b\u7684\u8bf7\u6c42\uff0c\u4e00\u65e6\u670d\u52a1\u5668\u901a\u8fc7 `Preflight` \u8bf7\u6c42\uff0c\u5141\u8bb8\u8be5\u8bf7\u6c42\u4e4b\u540e\uff0c\u4ee5\u540e\u6bcf\u6b21\u6d4f\u89c8\u5668\u6b63\u5e38\u7684 `CORS` \u8bf7\u6c42\uff0c\u5c31\u90fd\u8ddf\u7b80\u5355\u8bf7\u6c42\u4e00\u6837\u4e86\u3002\\n\\n:::note note\\n\u4f18\u70b9\uff1a\\n\\n- `CORS` \u901a\u4fe1\u4e0e\u540c\u6e90\u7684 `AJAX` \u901a\u4fe1\u6ca1\u6709\u5dee\u522b\uff0c\u4ee3\u7801\u5b8c\u5168\u4e00\u6837\uff0c\u5bb9\u6613\u7ef4\u62a4\\n- \u652f\u6301\u6240\u6709\u7c7b\u578b\u7684 `HTTP` \u8bf7\u6c42\\n\\n\u7f3a\u70b9\uff1a\\n\\n- \u5b58\u5728\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u7279\u522b\u662f `IE10` \u4ee5\u4e0b\u7684\u6d4f\u89c8\u5668\\n- \u7b2c\u4e00\u6b21\u53d1\u9001\u975e\u7b80\u5355\u8bf7\u6c42\u65f6\u4f1a\u591a\u4e00\u6b21\u8bf7\u6c42\\n\\n:::\\n\\n## \u53c2\u8003\u94fe\u63a5\\n\\n- [\u8de8\u57df\u7684\u90a3\u4e9b\u4e8b\u513f](https://zhuanlan.zhihu.com/p/28562290)\\n- [\u6d4f\u89c8\u5668\u540c\u6e90\u7b56\u7565\u53ca\u8de8\u57df\u7684\u89e3\u51b3\u65b9\u6cd5](https://juejin.im/post/5ba1d4fe6fb9a05ce873d4ad)"}]}')}}]);